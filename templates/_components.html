{# SPLUNKed Component Macros #}

{# Navigation Bar #}
{% macro navbar(current_endpoint) %}
<nav class="navbar">
    <div class="navbar-container">
        <a href="{{ url_for('index') }}" class="navbar-brand">
            <span class="brand-icon">></span>
            <span class="brand-text">SPLUNK<span class="brand-accent">ed</span></span>
        </a>

        <div class="navbar-links">
            <a href="{{ url_for('index') }}"
               class="nav-link {{ 'active' if current_endpoint == 'index' else '' }}">
                Home
            </a>
            <a href="{{ url_for('glossary') }}"
               class="nav-link {{ 'active' if current_endpoint == 'glossary' else '' }}">
                SPL
            </a>
            <a href="{{ url_for('references') }}"
               class="nav-link {{ 'active' if current_endpoint == 'references' else '' }}">
                Knowledge
            </a>
            <a href="{{ url_for('training') }}"
               class="nav-link {{ 'active' if current_endpoint == 'training' else '' }}">
                Training
            </a>
            <a href="{{ url_for('prompt_builder') }}"
               class="nav-link {{ 'active' if current_endpoint == 'prompt_builder' else '' }}">
                Builder
            </a>
            <a href="{{ url_for('query_library') }}"
               class="nav-link {{ 'active' if current_endpoint == 'query_library' else '' }}">
                Queries
            </a>
        </div>

        <div class="global-search-container">
            <input type="text"
                   id="globalSearch"
                   class="global-search-input"
                   placeholder="Search..."
                   autocomplete="off">
            <kbd class="global-search-hint">/</kbd>
            <div class="global-search-results" id="globalSearchResults">
                <!-- Populated by JavaScript -->
            </div>
        </div>

        <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
            <span class="toggle-icon"></span>
        </button>
    </div>
</nav>
{% endmacro %}

{# Sidebar #}
{% macro sidebar() %}
<aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <h3 class="sidebar-title">
            <span class="sidebar-brand-icon">></span>
            Navigation
        </h3>
        <button class="sidebar-close" id="sidebarClose" aria-label="Close sidebar">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
        </button>
    </div>

    <div class="sidebar-content">
        <!-- Mobile Navigation -->
        <nav class="sidebar-nav">
            <a href="{{ url_for('index') }}" class="sidebar-nav-link">
                <span class="nav-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                        <polyline points="9 22 9 12 15 12 15 22"/>
                    </svg>
                </span>
                <span class="nav-text">Home</span>
            </a>
            <a href="{{ url_for('glossary') }}" class="sidebar-nav-link">
                <span class="nav-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="16 18 22 12 16 6"/>
                        <polyline points="8 6 2 12 8 18"/>
                    </svg>
                </span>
                <span class="nav-text">SPL Reference</span>
            </a>
            <a href="{{ url_for('references') }}" class="sidebar-nav-link">
                <span class="nav-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 19.5A2.5 2.5 0 016.5 17H20"/>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"/>
                    </svg>
                </span>
                <span class="nav-text">Splunk Knowledge</span>
            </a>
            <a href="{{ url_for('training') }}" class="sidebar-nav-link">
                <span class="nav-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 10v6M2 10l10-5 10 5-10 5z"/>
                        <path d="M6 12v5c3 3 9 3 12 0v-5"/>
                    </svg>
                </span>
                <span class="nav-text">Training</span>
            </a>
            <a href="{{ url_for('prompt_builder') }}" class="sidebar-nav-link">
                <span class="nav-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="4 17 10 11 4 5"/>
                        <line x1="12" y1="19" x2="20" y2="19"/>
                    </svg>
                </span>
                <span class="nav-text">Prompt Builder</span>
            </a>
            <a href="{{ url_for('query_library') }}" class="sidebar-nav-link">
                <span class="nav-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 6h16M4 12h16M4 18h7"/>
                        <circle cx="17" cy="18" r="3"/>
                        <path d="M21 21l-1.5-1.5"/>
                    </svg>
                </span>
                <span class="nav-text">Query Library</span>
            </a>
        </nav>

        <div class="sidebar-section">
            <h4 class="sidebar-section-title">SPL Basics</h4>
            <div class="quick-ref-list">
                <div class="quick-ref-item">
                    <code>|</code> Pipe - chain commands
                </div>
                <div class="quick-ref-item">
                    <code>=</code> Exact match
                </div>
                <div class="quick-ref-item">
                    <code>!=</code> Not equal
                </div>
                <div class="quick-ref-item">
                    <code>*</code> Wildcard
                </div>
                <div class="quick-ref-item">
                    <code>AND OR NOT</code> Boolean operators
                </div>
            </div>
        </div>

        <div class="sidebar-section">
            <h4 class="sidebar-section-title">Common Time Modifiers</h4>
            <div class="quick-ref-list">
                <div class="quick-ref-item">
                    <code>earliest=-24h</code> Last 24 hours
                </div>
                <div class="quick-ref-item">
                    <code>earliest=-7d@d</code> Last 7 days (snap to day)
                </div>
                <div class="quick-ref-item">
                    <code>earliest=@w0</code> Since start of week
                </div>
                <div class="quick-ref-item">
                    <code>latest=now</code> Up to current time
                </div>
            </div>
        </div>

        <div class="sidebar-section">
            <h4 class="sidebar-section-title">Keyboard Shortcuts</h4>
            <div class="quick-ref-list">
                <div class="quick-ref-item">
                    <kbd>/</kbd> Focus search
                </div>
                <div class="quick-ref-item">
                    <kbd>Esc</kbd> Close modal/sidebar
                </div>
                <div class="quick-ref-item">
                    <kbd>?</kbd> Toggle help
                </div>
            </div>
        </div>
    </div>
</aside>
<div class="sidebar-overlay" id="sidebarOverlay"></div>
{% endmacro %}

{# Footer #}
{% macro footer() %}
<footer class="footer">
    <div class="footer-container">
        <div class="footer-brand">
            <span class="brand-icon">></span>
            <span class="brand-text">SPLUNK<span class="brand-accent">ed</span></span>
        </div>
        <div class="footer-tagline">
            Educational SPL reference for security analysts
        </div>
        <div class="footer-note">
            Not affiliated with Splunk Inc.
        </div>
    </div>
</footer>
{% endmacro %}

{# Feature Card #}
{% macro feature_card(title, description, icon, link, link_text="Explore") %}
<div class="feature-card">
    <div class="feature-icon">{{ icon }}</div>
    <h3 class="feature-title">{{ title }}</h3>
    <p class="feature-description">{{ description }}</p>
    <a href="{{ link }}" class="feature-link">
        {{ link_text }}
        <span class="link-arrow">&rarr;</span>
    </a>
</div>
{% endmacro %}

{# Skill Badge #}
{% macro skill_badge(level) %}
<span class="skill-badge {{ level }}">{{ level | capitalize }}</span>
{% endmacro %}

{# Search Input #}
{% macro search_input(placeholder="Search...", id="searchInput") %}
<div class="search-container">
    <span class="search-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
        </svg>
    </span>
    <input type="text"
           id="{{ id }}"
           class="search-input"
           placeholder="{{ placeholder }}"
           autocomplete="off">
    <button class="search-clear" id="{{ id }}Clear" aria-label="Clear search">&times;</button>
</div>
{% endmacro %}

{# View Toggle #}
{% macro view_toggle(id="viewToggle") %}
<div class="view-toggle" id="{{ id }}">
    <button class="view-btn active" data-view="categorized" aria-label="Categorized view">
        <svg viewBox="0 0 24 24" fill="currentColor">
            <rect x="3" y="3" width="7" height="7"/>
            <rect x="14" y="3" width="7" height="7"/>
            <rect x="3" y="14" width="7" height="7"/>
            <rect x="14" y="14" width="7" height="7"/>
        </svg>
    </button>
    <button class="view-btn" data-view="alphabetical" aria-label="Alphabetical view">
        <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/>
        </svg>
    </button>
</div>
{% endmacro %}

{# Modal Container #}
{% macro modal(id, title, content_id=none, show_actions=false, actions_html='', modal_class='', overlay_class='') %}
<div class="modal-overlay {{ overlay_class }}" id="{{ id }}Overlay">
    <div class="modal {{ modal_class }}" id="{{ id }}" role="dialog" aria-labelledby="{{ id }}Title">
        <div class="modal-header">
            <h2 class="modal-title" id="{{ id }}Title">{{ title }}</h2>
            {% if show_actions %}
            <div class="modal-header-actions">
                {{ actions_html | safe }}
            </div>
            {% else %}
            <button class="modal-close" aria-label="Close modal">&times;</button>
            {% endif %}
        </div>
        <div class="modal-content" {% if content_id %}id="{{ content_id }}"{% endif %}>
            {{ caller() }}
        </div>
    </div>
</div>
{% endmacro %}

{# Empty State #}
{% macro empty_state(title, message, icon="search", id=none, hidden=true, extra_class="") %}
<div class="empty-state {{ 'hidden' if hidden else '' }} {{ extra_class }}" {% if id %}id="{{ id }}"{% endif %}>
    <div class="empty-icon">
        {% if icon == "search" %}
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
        </svg>
        {% elif icon == "folder" %}
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
        </svg>
        {% elif icon == "stack" %}
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
        </svg>
        {% endif %}
    </div>
    <h3 class="empty-title">{{ title }}</h3>
    <p class="empty-message">{{ message }}</p>
</div>
{% endmacro %}

{# SPL Reference Sidebar - Global quick-access to SPL commands #}
{% macro spl_reference_sidebar() %}
<!-- SPL Reference Trigger Button -->
<button class="spl-sidebar-trigger" id="splSidebarTrigger" aria-label="Open SPL Reference" title="SPL Reference (S)">
    <span class="spl-trigger-icon">&lt;/&gt;</span>
    <span class="spl-trigger-label">SPL</span>
</button>

<!-- SPL Reference Sidebar Overlay -->
<div class="spl-sidebar-overlay" id="splSidebarOverlay"></div>

<!-- SPL Reference Sidebar Panel -->
<aside class="spl-sidebar" id="splSidebar" role="complementary" aria-label="SPL Reference">
    <div class="spl-sidebar-header">
        <div class="spl-sidebar-header-row">
            <button class="spl-sidebar-back hidden" id="splSidebarBack" aria-label="Back to list">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"/>
                </svg>
            </button>
            <h2 class="spl-sidebar-title">SPL Reference</h2>
            <button class="spl-sidebar-close" id="splSidebarClose" aria-label="Close sidebar">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
        <div class="spl-sidebar-search-container">
            <input type="text"
                   class="spl-sidebar-search"
                   id="splSidebarSearch"
                   placeholder="Search commands & functions..."
                   autocomplete="off">
            <kbd class="spl-sidebar-search-hint">S</kbd>
        </div>
        <div class="spl-sidebar-filters" id="splSidebarFilters">
            <button class="spl-sidebar-filter active" data-filter="all">
                <span class="filter-label">All</span>
                <span class="filter-count" id="filterCountAll">0</span>
            </button>
            <button class="spl-sidebar-filter filter-command" data-filter="command">
                <span class="filter-icon">|</span>
                <span class="filter-label">Commands</span>
                <span class="filter-count" id="filterCountCommands">0</span>
            </button>
            <button class="spl-sidebar-filter filter-function" data-filter="function">
                <span class="filter-icon">f(x)</span>
                <span class="filter-label">Eval</span>
                <span class="filter-count" id="filterCountFunctions">0</span>
            </button>
            <button class="spl-sidebar-filter filter-stats" data-filter="stats">
                <span class="filter-icon">&Sigma;</span>
                <span class="filter-label">Stats</span>
                <span class="filter-count" id="filterCountStats">0</span>
            </button>
        </div>
    </div>
    <div class="spl-sidebar-body">
        <div class="spl-sidebar-alpha-nav" id="splSidebarAlphaNav">
            <!-- Populated by JavaScript -->
        </div>
        <div class="spl-sidebar-list" id="splSidebarList">
            <!-- Populated by JavaScript -->
        </div>
        <div class="spl-sidebar-detail hidden" id="splSidebarDetail">
            <!-- Populated by JavaScript -->
        </div>
    </div>
</aside>
{% endmacro %}
