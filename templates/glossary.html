{% extends "_base.html" %}

{% block title %}SPL Reference - SPLUNKed{% endblock %}

{% block content %}
{% from "_components.html" import search_input, view_toggle, empty_state, modal %}

<div class="page-container">
    <!-- Page Header -->
    <header class="page-header">
        <h1 class="page-title">SPL Reference</h1>
        <p class="page-subtitle">
            Commands and functions for the Search Processing Language.
            Click any entry to explore syntax, examples, and tips.
        </p>
    </header>

    <!-- Tabs Navigation -->
    <div class="training-tabs" id="glossaryTabs">
        <button class="training-tab active" data-category="commands">Commands</button>
        <button class="training-tab" data-category="functions">Functions</button>
    </div>

    <!-- Controls Bar -->
    <div class="controls-bar">
        {{ search_input(placeholder='Search commands, functions...', id='glossarySearch') }}
        {{ view_toggle(id='glossaryView') }}
    </div>

    <!-- Tab Panels -->
    <div id="commandsPanel" class="tab-panel active" role="tabpanel">
        <div class="category-info" id="commandsInfo"></div>
        <div class="icon-filter" id="commandsFilter">
            <button class="icon-filter-btn active" data-filter="all">
                <span>All</span>
            </button>
            <button class="icon-filter-btn" data-filter="get">
                <span class="filter-icon">↓</span>
                <span>Get data</span>
            </button>
            <button class="icon-filter-btn" data-filter="filter">
                <span class="filter-icon">⧩</span>
                <span>Filter</span>
            </button>
            <button class="icon-filter-btn" data-filter="transform">
                <span class="filter-icon">⟳</span>
                <span>Transform</span>
            </button>
            <button class="icon-filter-btn" data-filter="aggregate">
                <span class="filter-icon">Σ</span>
                <span>Aggregate</span>
            </button>
            <button class="icon-filter-btn" data-filter="combine">
                <span class="filter-icon">⊕</span>
                <span>Combine</span>
            </button>
            <button class="icon-filter-btn" data-filter="output">
                <span class="filter-icon">▤</span>
                <span>Output</span>
            </button>
        </div>
        <div class="glossary-grid" id="commandsGrid">
            <!-- Populated by JavaScript -->
        </div>
    </div>

    <div id="functionsPanel" class="tab-panel" role="tabpanel" hidden>
        <div class="category-info" id="functionsInfo"></div>
        <div class="icon-filter" id="functionsFilter">
            <button class="icon-filter-btn active" data-filter="all">
                <span>All</span>
            </button>
            <button class="icon-filter-btn" data-filter="eval">
                <span class="filter-icon">ƒ</span>
                <span>Eval</span>
            </button>
            <button class="icon-filter-btn" data-filter="stats">
                <span class="filter-icon">∑</span>
                <span>Stats</span>
            </button>
        </div>
        <div class="glossary-grid" id="functionsGrid">
            <!-- Populated by JavaScript -->
        </div>
    </div>

    <!-- Empty State -->
    {{ empty_state(
        title='No matches found',
        message='Try adjusting your search or filter criteria.',
        id='emptyState',
        hidden=true
    ) }}
</div>

<!-- Detail Modal -->
{% set glossary_actions %}
<button class="modal-back" id="glossaryModalBack" aria-label="Go back" hidden>&larr;</button>
<button class="modal-close" aria-label="Close modal">&times;</button>
{% endset %}
{% call modal('glossaryModal', '', 'glossaryModalContent', true, glossary_actions) %}
    <!-- Populated by JavaScript -->
{% endcall %}
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='glossary.js') }}"></script>
{% endblock %}
