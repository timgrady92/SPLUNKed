{% extends "_base.html" %}

{% block title %}SPL Glossary - SPLUNKed{% endblock %}

{% block content %}
{% from "_components.html" import search_input, view_toggle, category_tab %}

<div class="page-container">
    <!-- Page Header -->
    <header class="page-header">
        <h1 class="page-title">SPL Glossary</h1>
        <p class="page-subtitle">
            Comprehensive reference for SPL commands, functions, and concepts.
            Click any entry to explore further.
        </p>
    </header>

    <!-- Tabs Navigation -->
    <div class="tabs-container" id="glossaryTabs">
        <div class="tabs-list" role="tablist">
            {{ category_tab('commands', 'Commands', active=true) }}
            {{ category_tab('functions', 'Functions') }}
            {{ category_tab('reference', 'Reference') }}
            {{ category_tab('enterpriseSecurity', 'Enterprise Security') }}
            {{ category_tab('antipatterns', 'Pitfalls') }}
        </div>
    </div>

    <!-- Controls Bar -->
    <div class="controls-bar">
        {{ search_input(placeholder='Search commands, functions...', id='glossarySearch') }}
        {{ view_toggle(id='glossaryView') }}
    </div>

    <!-- Tab Panels -->
    <div id="commandsPanel" class="tab-panel active" role="tabpanel">
        <div class="category-info" id="commandsInfo"></div>
        <div class="icon-filter" id="commandsFilter">
            <button class="icon-filter-btn active" data-filter="all">
                <span>All</span>
            </button>
            <button class="icon-filter-btn" data-filter="get">
                <span class="filter-icon">‚Üì</span>
                <span>Get data</span>
            </button>
            <button class="icon-filter-btn" data-filter="filter">
                <span class="filter-icon">‚ß©</span>
                <span>Filter</span>
            </button>
            <button class="icon-filter-btn" data-filter="transform">
                <span class="filter-icon">‚ü≥</span>
                <span>Transform</span>
            </button>
            <button class="icon-filter-btn" data-filter="aggregate">
                <span class="filter-icon">Œ£</span>
                <span>Aggregate</span>
            </button>
            <button class="icon-filter-btn" data-filter="combine">
                <span class="filter-icon">‚äï</span>
                <span>Combine</span>
            </button>
            <button class="icon-filter-btn" data-filter="output">
                <span class="filter-icon">‚ñ§</span>
                <span>Output</span>
            </button>
        </div>
        <div class="glossary-grid" id="commandsGrid">
            <!-- Populated by JavaScript -->
        </div>
    </div>

    <div id="functionsPanel" class="tab-panel" role="tabpanel" hidden>
        <div class="category-info" id="functionsInfo"></div>
        <div class="icon-filter" id="functionsFilter">
            <button class="icon-filter-btn active" data-filter="all">
                <span>All</span>
            </button>
            <button class="icon-filter-btn" data-filter="eval">
                <span class="filter-icon">∆í</span>
                <span>Eval</span>
            </button>
            <button class="icon-filter-btn" data-filter="stats">
                <span class="filter-icon">‚àë</span>
                <span>Stats</span>
            </button>
        </div>
        <div class="glossary-grid" id="functionsGrid">
            <!-- Populated by JavaScript -->
        </div>
    </div>

    <div id="referencePanel" class="tab-panel" role="tabpanel" hidden>
        <div class="category-info" id="referenceInfo"></div>
        <div class="icon-filter" id="referenceFilter">
            <button class="icon-filter-btn active" data-filter="all">
                <span>All</span>
            </button>
            <button class="icon-filter-btn" data-filter="fields">
                <span class="filter-icon">‚¨ö</span>
                <span>Fields</span>
            </button>
            <button class="icon-filter-btn" data-filter="concepts">
                <span class="filter-icon">‚óÜ</span>
                <span>Concepts</span>
            </button>
            <button class="icon-filter-btn" data-filter="cim">
                <span class="filter-icon">‚ßâ</span>
                <span>CIM</span>
            </button>
            <button class="icon-filter-btn" data-filter="extractions">
                <span class="filter-icon">‚ãî</span>
                <span>Extractions</span>
            </button>
            <button class="icon-filter-btn" data-filter="macros">
                <span class="filter-icon">{ }</span>
                <span>Macros</span>
            </button>
            <button class="icon-filter-btn" data-filter="engineering">
                <span class="filter-icon">‚öô</span>
                <span>Engineering</span>
            </button>
        </div>
        <div class="glossary-grid" id="referenceGrid">
            <!-- Populated by JavaScript -->
        </div>
    </div>

    <div id="enterpriseSecurityPanel" class="tab-panel" role="tabpanel" hidden>
        <div class="category-info" id="enterpriseSecurityInfo"></div>
        <div class="icon-filter" id="enterpriseSecurityFilter">
            <button class="icon-filter-btn active" data-filter="all">
                <span>All</span>
            </button>
            <button class="icon-filter-btn" data-filter="rba">
                <span class="filter-icon">‚ö°</span>
                <span>RBA</span>
            </button>
            <button class="icon-filter-btn" data-filter="notable">
                <span class="filter-icon">üîî</span>
                <span>Notables</span>
            </button>
            <button class="icon-filter-btn" data-filter="assetIdentity">
                <span class="filter-icon">üë§</span>
                <span>Assets/Identity</span>
            </button>
            <button class="icon-filter-btn" data-filter="threatIntel">
                <span class="filter-icon">üéØ</span>
                <span>Threat Intel</span>
            </button>
            <button class="icon-filter-btn" data-filter="datamodels">
                <span class="filter-icon">‚óà</span>
                <span>Data Models</span>
            </button>
            <button class="icon-filter-btn" data-filter="investigation">
                <span class="filter-icon">üîç</span>
                <span>Investigation</span>
            </button>
            <button class="icon-filter-btn" data-filter="correlation">
                <span class="filter-icon">üîó</span>
                <span>Correlation</span>
            </button>
            <button class="icon-filter-btn" data-filter="macros">
                <span class="filter-icon">‚öô</span>
                <span>Macros</span>
            </button>
        </div>
        <div class="glossary-grid" id="enterpriseSecurityGrid">
            <!-- Populated by JavaScript -->
        </div>
    </div>

    <div id="antipatternsPanel" class="tab-panel" role="tabpanel" hidden>
        <div class="category-info" id="antipatternsInfo"></div>
        <div class="glossary-grid" id="antipatternsGrid">
            <!-- Populated by JavaScript -->
        </div>
    </div>

    <!-- Empty State -->
    <div class="empty-state hidden" id="emptyState">
        <div class="empty-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"/>
                <path d="M21 21l-4.35-4.35"/>
            </svg>
        </div>
        <h3 class="empty-title">No matches found</h3>
        <p class="empty-message">Try adjusting your search or filter criteria.</p>
    </div>
</div>

<!-- Detail Modal -->
<div class="modal-overlay" id="glossaryModalOverlay">
    <div class="modal" id="glossaryModal" role="dialog" aria-labelledby="glossaryModalTitle">
        <div class="modal-header">
            <h2 class="modal-title" id="glossaryModalTitle"></h2>
            <div class="modal-header-actions">
                <button class="modal-back" id="glossaryModalBack" aria-label="Go back" hidden>&larr;</button>
                <button class="modal-close" aria-label="Close modal">&times;</button>
            </div>
        </div>
        <div class="modal-content" id="glossaryModalContent">
            <!-- Populated by JavaScript -->
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='glossary.js') }}"></script>
{% endblock %}
